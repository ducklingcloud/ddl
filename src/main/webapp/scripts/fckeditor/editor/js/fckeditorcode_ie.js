/*
 * FCKeditor - The text editor for Internet - http://www.fckeditor.net
 * Copyright (C) 2003-2008 Frederico Caldeira Knabben
 *
 * == BEGIN LICENSE ==
 *
 * Licensed under the terms of any of the following licenses at your
 * choice:
 *
 *  - GNU General Public License Version 2 or later (the "GPL")
 *    http://www.gnu.org/licenses/gpl.html
 *
 *  - GNU Lesser General Public License Version 2.1 or later (the "LGPL")
 *    http://www.gnu.org/licenses/lgpl.html
 *
 *  - Mozilla Public License Version 1.1 or later (the "MPL")
 *    http://www.mozilla.org/MPL/MPL-1.1.html
 *
 * == END LICENSE ==
 *
 * This file has been compressed for better performance. The original source
 * can be found at "editor/_source".a
 */

var FCK_STATUS_NOTLOADED=window.parent.FCK_STATUS_NOTLOADED=0;var FCK_STATUS_ACTIVE=window.parent.FCK_STATUS_ACTIVE=1;var FCK_STATUS_COMPLETE=window.parent.FCK_STATUS_COMPLETE=2;var FCK_TRISTATE_OFF=window.parent.FCK_TRISTATE_OFF=0;var FCK_TRISTATE_ON=window.parent.FCK_TRISTATE_ON=1;var FCK_TRISTATE_DISABLED=window.parent.FCK_TRISTATE_DISABLED=-1;var FCK_UNKNOWN=window.parent.FCK_UNKNOWN=-9;var FCK_TOOLBARITEM_ONLYICON=window.parent.FCK_TOOLBARITEM_ONLYICON=0;var FCK_TOOLBARITEM_ONLYTEXT=window.parent.FCK_TOOLBARITEM_ONLYTEXT=1;var FCK_TOOLBARITEM_ICONTEXT=window.parent.FCK_TOOLBARITEM_ICONTEXT=2;var FCK_EDITMODE_WYSIWYG=window.parent.FCK_EDITMODE_WYSIWYG=0;var FCK_EDITMODE_SOURCE=window.parent.FCK_EDITMODE_SOURCE=1;var FCK_IMAGES_PATH='images/';var FCK_SPACER_PATH='images/spacer.gif';var CTRL=1000;var SHIFT=2000;var ALT=4000;var FCK_STYLE_BLOCK=0;var FCK_STYLE_INLINE=1;var FCK_STYLE_OBJECT=2;
String.prototype.Contains=function(A){return (this.indexOf(A)>-1);};String.prototype.Equals=function(){var A=arguments;if (A.length==1&&A[0].pop) A=A[0];for (var i=0;i<A.length;i++){if (this==A[i]) return true;};return false;};String.prototype.IEquals=function(){var A=this.toUpperCase();var B=arguments;if (B.length==1&&B[0].pop) B=B[0];for (var i=0;i<B.length;i++){if (A==B[i].toUpperCase()) return true;};return false;};String.prototype.ReplaceAll=function(A,B){var C=this;for (var i=0;i<A.length;i++){C=C.replace(A[i],B[i]);};return C;};String.prototype.StartsWith=function(A){return (this.substr(0,A.length)==A);};String.prototype.EndsWith=function(A,B){var C=this.length;var D=A.length;if (D>C) return false;if (B){var E=new RegExp(A+'$','i');return E.test(this);}else return (D==0||this.substr(C-D,D)==A);};String.prototype.Remove=function(A,B){var s='';if (A>0) s=this.substring(0,A);if (A+B<this.length) s+=this.substring(A+B,this.length);return s;};String.prototype.Trim=function(){return this.replace(/(^[ \t\n\r]*)|([ \t\n\r]*$)/g,'');};String.prototype.LTrim=function(){return this.replace(/^[ \t\n\r]*/g,'');};String.prototype.RTrim=function(){return this.replace(/[ \t\n\r]*$/g,'');};String.prototype.ReplaceNewLineChars=function(A){return this.replace(/\n/g,A);};String.prototype.Replace=function(A,B,C){if (typeof B=='function'){return this.replace(A,function(){return B.apply(C||this,arguments);});}else return this.replace(A,B);};Array.prototype.AddItem=function(A){var i=this.length;this[i]=A;return i;};Array.prototype.IndexOf=function(A){for (var i=0;i<this.length;i++){if (this[i]==A) return i;};return-1;};
var	FCKIECleanup=function(A){if (A._FCKCleanupObj) this.Items=A._FCKCleanupObj.Items;else{this.Items=[];A._FCKCleanupObj=this;FCKTools.AddEventListenerEx(A,'unload',FCKIECleanup_Cleanup);}};FCKIECleanup.prototype.AddItem=function(A,B){this.Items.push([A,B]);};function FCKIECleanup_Cleanup(){if (!this._FCKCleanupObj||(FCKConfig.MsWebBrowserControlCompat&&!window.FCKUnloadFlag)) return;var A=this._FCKCleanupObj.Items;while (A.length>0){var B=A.pop();if (B) B[1].call(B[0]);};this._FCKCleanupObj=null;if (CollectGarbage) CollectGarbage();};
var FCKURLParams={};(function(){var A=document.location.search.substr(1).split('&');for (var i=0;i<A.length;i++){var B=A[i].split('=');var C=decodeURIComponent(B[0]);var D=decodeURIComponent(B[1]);FCKURLParams[C]=D;}})();
var FCKEvents=function(a){this.Owner=a;this._RegisteredEvents={}};FCKEvents.prototype.AttachEvent=function(a,c){var b;if(!(b=this._RegisteredEvents[a])){this._RegisteredEvents[a]=[c]}else{if(b.IndexOf(c)==-1){b.push(c)}}};FCKEvents.prototype.FireEvent=function(b,g){var d=true;var a=this._RegisteredEvents[b];if(a){for(var c=0;c<a.length;c++){try{if(a[c]){d=(a[c](this.Owner,g)&&d)}}catch(f){if(f.number!=-2146823277){throw f}}}}return d};
var FCKBrowserInfo=(function(){var s=navigator.userAgent.toLowerCase();var browserInfo={IsIE:/* @cc_on!@ */false||s.indexOf("trident")!=-1,IsIE6:/* @cc_on!@ */false&&(parseInt(s.match(/msie (\d+)/)[1],10)>=6),IsIE7:!!s.match(/msie (\d+)/)&&(parseInt(s.match(/msie (\d+)/)[1],10)>=7)&&(parseInt(s.match(/msie (\d+)/)[1],10)<=8),IsIE9:!!s.match(/msie (\d+)/)&&(parseInt(s.match(/msie (\d+)/)[1],10)==9),IsIE10:!!s.match(/msie (\d+)/)&&(parseInt(s.match(/msie (\d+)/)[1],10)==10),IsIE11:s.indexOf("trident")!=-1&&(parseFloat(s.match(/trident\/(\d+)/)[1],10)>=7),IsSafari:s.Contains(" applewebkit/"),IsOpera:!!window.opera,IsAIR:s.Contains(" adobeair/"),IsMac:s.Contains("macintosh"),IsChrome:s.Contains("chrome")};browserInfo.IsGecko=(navigator.product=="Gecko")&&!browserInfo.IsSafari&&!browserInfo.IsOpera;browserInfo.IsGeckoLike=(browserInfo.IsGecko||browserInfo.IsSafari||browserInfo.IsOpera);if(browserInfo.IsGecko){var geckoMatch=s.match(/rv:(\d+\.\d+)/);var geckoVersion=geckoMatch&&parseFloat(geckoMatch[1]);if(geckoVersion){browserInfo.IsGecko10=(geckoVersion<1.8);browserInfo.IsGecko19=(geckoVersion>1.8)}}browserInfo.IsGeckoFamily=browserInfo.IsGecko||browserInfo.IsGeckoLike;return browserInfo})();
var FCKDataProcessor=function(){};FCKDataProcessor.prototype={ConvertToHtml:function(A){if (FCKConfig.FullPage){FCK.DocTypeDeclaration=A.match(FCKRegexLib.DocTypeTag);if (!FCKRegexLib.HasBodyTag.test(A)) A='<body>'+A+'</body>';if (!FCKRegexLib.HtmlOpener.test(A)) A='<html dir="'+FCKConfig.ContentLangDirection+'">'+A+'</html>';if (!FCKRegexLib.HeadOpener.test(A)) A=A.replace(FCKRegexLib.HtmlOpener,'$&<head><title></title></head>');return A;}else{var B=FCKConfig.DocType+'<html dir="'+FCKConfig.ContentLangDirection+'"';if (FCKBrowserInfo.IsIE&&FCKConfig.DocType.length>0&&!FCKRegexLib.Html4DocType.test(FCKConfig.DocType)) B+=' style="overflow-y: scroll"';B+='><head><title></title></head><body'+FCKConfig.GetBodyAttributes()+'>'+A+'</body></html>';return B;}},ConvertToDataFormat:function(A,B,C,D){var E=FCKXHtml.GetXHTML(A,!B,D);if (C&&FCKRegexLib.EmptyOutParagraph.test(E)) return '';return E;},FixHtml:function(A){return A;}};
var FCK={Name:FCKURLParams["InstanceName"],Status:FCK_STATUS_NOTLOADED,EditMode:FCK_EDITMODE_WYSIWYG,Toolbar:null,HasFocus:false,DataProcessor:new FCKDataProcessor(),GetInstanceObject:(function(){var a=window;return function(b){return a[b]}})(),AttachToOnSelectionChange:function(a){this.Events.AttachEvent("OnSelectionChange",a)},GetLinkedFieldValue:function(){return this.LinkedField.value},GetParentForm:function(){return this.LinkedField.form},StartupValue:"",IsDirty:function(){if(this.EditMode==FCK_EDITMODE_SOURCE){return(this.StartupValue!=this.EditingArea.Textarea.value)}else{if(!this.EditorDocument){return false}return(this.StartupValue!=this.EditorDocument.body.innerHTML)}},ResetIsDirty:function(){if(this.EditMode==FCK_EDITMODE_SOURCE){this.StartupValue=this.EditingArea.Textarea.value}else{if(this.EditorDocument.body){this.StartupValue=this.EditorDocument.body.innerHTML}}},StartEditor:function(){this.TempBaseTag=FCKConfig.BaseHref.length>0?'<base href="'+FCKConfig.BaseHref+'" _fcktemp="true"></base>':"";var a=FCK.KeystrokeHandler=new FCKKeystrokeHandler();a.OnKeystroke=_FCK_KeystrokeHandler_OnKeystroke;a.SetKeystrokes(FCKConfig.Keystrokes);if(FCKBrowserInfo.IsIE7){if((CTRL+86) in a.Keystrokes){a.SetKeystrokes([CTRL+86,true])}if((SHIFT+45) in a.Keystrokes){a.SetKeystrokes([SHIFT+45,true])}}a.SetKeystrokes([CTRL+8,true]);this.EditingArea=new FCKEditingArea(document.getElementById("xEditingArea"));this.EditingArea.FFSpellChecker=FCKConfig.FirefoxSpellChecker;this.SetData(this.GetLinkedFieldValue(),true);FCKTools.AddEventListener(document,"keydown",this._TabKeyHandler);this.AttachToOnSelectionChange(_FCK_PaddingNodeListener);if(FCKBrowserInfo.IsGecko){this.AttachToOnSelectionChange(this._ExecCheckEmptyBlock)}},Focus:function(){FCK.EditingArea.Focus()},SetStatus:function(a){this.Status=a;if(a==FCK_STATUS_ACTIVE){FCKFocusManager.AddWindow(window,true);if(FCKBrowserInfo.IsIE){FCKFocusManager.AddWindow(window.frameElement,true)}if(FCKConfig.StartupFocus){FCK.Focus()}}this.Events.FireEvent("OnStatusChange",a)},FixBody:function(){var g=FCKConfig.EnterMode;if(g!="p"&&g!="div"){return}var c=this.EditorDocument;if(!c){return}var b=c.body;if(!b){return}FCKDomTools.TrimNode(b);var f=b.firstChild;var a=null;while(f){var d=false;switch(f.nodeType){case 1:var h=f.nodeName.toLowerCase();if(!FCKListsLib.BlockElements[h]&&h!="li"&&!f.getAttribute("_fckfakelement")&&f.getAttribute("_moz_dirty")==null){d=true}break;case 3:if(a||f.nodeValue.Trim().length>0){d=true}break;case 8:if(a){d=true}break}if(d){var e=f.parentNode;if(!a){a=e.insertBefore(c.createElement(g),f)}a.appendChild(e.removeChild(f));f=a.nextSibling}else{if(a){FCKDomTools.TrimNode(a);a=null}f=f.nextSibling}}if(a){FCKDomTools.TrimNode(a)}},GetData:function(g){if(FCK.EditMode==FCK_EDITMODE_SOURCE){return FCK.EditingArea.Textarea.value}this.FixBody();var c=FCK.EditorDocument;if(!c){if(window.document.getElementById("xEditingArea").firstChild.contentWindow.document){c=window.document.getElementById("xEditingArea").firstChild.contentWindow.document}}if(!c){return null}var a=FCKConfig.FullPage;var f=FCK.DataProcessor.ConvertToDataFormat(a?c.documentElement:c.body,!a,FCKConfig.IgnoreEmptyParagraphValue,g);f=FCK.ProtectEventsRestore(f);if(FCKBrowserInfo.IsIE){f=f.replace(FCKRegexLib.ToReplace,"$1")}if(a){if(FCK.DocTypeDeclaration&&FCK.DocTypeDeclaration.length>0){f=FCK.DocTypeDeclaration+"\n"+f}if(FCK.XmlDeclaration&&FCK.XmlDeclaration.length>0){f=FCK.XmlDeclaration+"\n"+f}}if(g=="FixDom"){if(!FCK.EditorDocument){var e=FCKDomTools.FixDomTree(window.document.getElementById("xEditingArea").firstChild.contentWindow.document.body);var b=FCK.EditorDocument.createElement("body");b.innerHTML=e;var d=FCKXHtml.GetXHTML(b);return d}else{var e=FCKDomTools.FixDomTree(FCK.EditorDocument.body);var b=FCK.EditorDocument.createElement("body");b.innerHTML=e;var d=FCKXHtml.GetXHTML(b);return d}}return FCKConfig.ProtectedSource.Revert(f)},UpdateLinkedField:function(){var a=FCK.GetXHTML(FCKConfig.FormatOutput);if(FCKConfig.HtmlEncodeOutput){a=FCKTools.HTMLEncode(a)}FCK.LinkedField.value=a;FCK.Events.FireEvent("OnAfterLinkedFieldUpdate")},RegisteredDoubleClickHandlers:new Object(),OnDoubleClick:function(c){var a=FCK.RegisteredDoubleClickHandlers[c.tagName.toUpperCase()];if(a){for(var b=0;b<a.length;b++){a[b](c)}}a=FCK.RegisteredDoubleClickHandlers["*"];if(a){for(var b=0;b<a.length;b++){a[b](c)}}},RegisterDoubleClickHandler:function(c,a){var d=a||"*";d=d.toUpperCase();var b;if(!(b=FCK.RegisteredDoubleClickHandlers[d])){FCK.RegisteredDoubleClickHandlers[d]=[c]}else{if(b.IndexOf(c)==-1){b.push(c)}}},OnAfterSetHTML:function(){FCKDocumentProcessor.Process(FCK.EditorDocument);FCKUndo.SaveUndoStep();FCK.Events.FireEvent("OnSelectionChange");FCK.Events.FireEvent("OnAfterSetHTML")},ProtectUrls:function(a){a=a.replace(FCKRegexLib.ProtectUrlsA,"$& _fcksavedurl=$1");a=a.replace(FCKRegexLib.ProtectUrlsImg,"$& _fcksavedurl=$1");a=a.replace(FCKRegexLib.ProtectUrlsArea,"$& _fcksavedurl=$1");return a},ProtectEvents:function(a){return a.replace(FCKRegexLib.TagsWithEvent,_FCK_ProtectEvents_ReplaceTags)},ProtectEventsRestore:function(a){return a.replace(FCKRegexLib.ProtectedEvents,_FCK_ProtectEvents_RestoreEvents)},ProtectTags:function(b){var c=FCKConfig.ProtectedTags;if(FCKBrowserInfo.IsIE){c+=c.length>0?"|ABBR|XML|EMBED|OBJECT":"ABBR|XML|EMBED|OBJECT"}var a;if(c.length>0){a=new RegExp("<("+c+")(?!w|:)","gi");b=b.replace(a,"<FCK:$1");a=new RegExp("</("+c+")>","gi");b=b.replace(a,"</FCK:$1>")}c="META";if(FCKBrowserInfo.IsIE){c+="|HR"}a=new RegExp("<(("+c+")(?=\\s|>|/)[\\s\\S]*?)/?>","gi");b=b.replace(a,"<FCK:$1 />");return b},SetData:function(c,a){this.EditingArea.Mode=FCK.EditMode;if(FCKBrowserInfo.IsIE&&FCK.EditorDocument&&!FCKBrowserInfo.IsGeckoLike){FCKTools.RemoveEventListener(FCK.EditorDocument,"selectionchange",Doc_OnSelectionChange)}if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){this._ForceResetIsDirty=(a===true);c=FCKConfig.ProtectedSource.Protect(c);c=FCK.DataProcessor.ConvertToHtml(c);c=c.replace(FCKRegexLib.InvalidSelfCloseTags,"$1></$2>");c=FCK.ProtectEvents(c);c=FCK.ProtectUrls(c);c=FCK.ProtectTags(c);if(FCK.TempBaseTag.length>0&&!FCKRegexLib.HasBaseTag.test(c)){c=c.replace(FCKRegexLib.HeadOpener,"$&"+FCK.TempBaseTag)}var b="";if(!FCKConfig.FullPage){b+=_FCK_GetEditorAreaStyleTags()}if(FCKBrowserInfo.IsIE){b+=FCK._GetBehaviorsStyle()}else{if(FCKConfig.ShowBorders){b+=FCKTools.GetStyleHtml(FCK_ShowTableBordersCSS,true)}}b+=FCKTools.GetStyleHtml(FCK_InternalCSS,true);c=c.replace(FCKRegexLib.HeadCloser,b+"$&");if(FCKBrowserInfo.IsIE){if(!FCKBrowserInfo.IsGeckoLike){c=c.replace(new RegExp(">&nbsp;</td>","gm"),"></td>");c=c.replace(/>[\s]<\/td>/ig,"></td>")}}else{c=c.replace(new RegExp(">&nbsp;</td>","gm"),'><br type="_moz"></td>');c=c.replace(/>[\s]<\/td>/ig,'><br type="_moz"></td>')}this.EditingArea.OnLoad=_FCK_EditingArea_OnLoad;this.EditingArea.Start(c)}else{FCK.EditorWindow=null;FCK.EditorDocument=null;FCKDomTools.PaddingNode=null;this.EditingArea.OnLoad=null;this.EditingArea.Start(c);this.EditingArea.Textarea._FCKShowContextMenu=true;FCK.EnterKeyHandler=null;if(a){this.ResetIsDirty()}FCK.KeystrokeHandler.AttachToElement(this.EditingArea.Textarea);this.EditingArea.Textarea.focus();FCK.Events.FireEvent("OnAfterSetHTML")}if(FCKBrowserInfo.IsGecko){window.onresize()}},RedirectNamedCommands:{},ExecuteNamedCommand:function(b,c,a,d){if(!d){FCKUndo.SaveUndoStep()}if(!a&&FCK.RedirectNamedCommands[b]!=null){FCK.ExecuteRedirectedNamedCommand(b,c)}else{FCK.Focus();FCK.EditorDocument.execCommand(b,false,c);FCK.Events.FireEvent("OnSelectionChange")}if(!d){FCKUndo.SaveUndoStep()}},GetNamedCommandState:function(a){try{if(FCKBrowserInfo.IsSafari&&FCK.EditorWindow&&a.IEquals("Paste")){return FCK_TRISTATE_OFF}if(!FCK.EditorDocument.queryCommandEnabled(a)){return FCK_TRISTATE_DISABLED}else{return FCK.EditorDocument.queryCommandState(a)?FCK_TRISTATE_ON:FCK_TRISTATE_OFF}}catch(b){return FCK_TRISTATE_OFF}},GetNamedCommandValue:function(b){var d="";var a=FCK.GetNamedCommandState(b);if(a==FCK_TRISTATE_DISABLED){return null}try{d=this.EditorDocument.queryCommandValue(b)}catch(c){}return d?d:""},Paste:function(a){if(a==false){return}return FCK._ExecPaste()},PasteFromWord:function(){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteFromWord,"dialog/fck_paste.html",400,330,"Word")},Preview:function(){var c;if(FCKConfig.FullPage){if(FCK.TempBaseTag.length>0){c=FCK.TempBaseTag+FCK.GetXHTML()}else{c=FCK.GetXHTML()}}else{c=FCKConfig.DocType+'<html dir="'+FCKConfig.ContentLangDirection+'">'+"<head>"+FCK.TempBaseTag+"<title>"+FCKLang.Preview+"</title>"+_FCK_GetEditorAreaStyleTags()+"</head><body"+FCKConfig.GetBodyAttributes()+">"+FCK.GetXHTML()+"</body></html>"}var d=FCKConfig.ScreenWidth*0.8;var f=FCKConfig.ScreenHeight*0.7;var e=(FCKConfig.ScreenWidth-d)/2;var b="";if(FCK_IS_CUSTOM_DOMAIN&&FCKBrowserInfo.IsIE){window._FCKHtmlToLoad=c;b="javascript:void( (function(){"+"document.open() ;"+'document.domain="'+document.domain+'" ;'+"document.write( window.opener._FCKHtmlToLoad );"+"document.close() ;"+"window.opener._FCKHtmlToLoad = null ;"+"})() )"}var a=window.open(b,null,"toolbar=yes,location=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width="+d+",height="+f+",left="+e);if(!FCK_IS_CUSTOM_DOMAIN||!FCKBrowserInfo.IsIE){a.document.write(c);a.document.close()}},SwitchEditMode:function(b){var c=(FCK.EditMode==FCK_EDITMODE_WYSIWYG);var a=FCK.IsDirty();var d;if(c){FCKCommands.GetCommand("ShowBlocks").SaveState();if(!b&&FCKBrowserInfo.IsIE){FCKUndo.SaveUndoStep()}d=FCK.GetXHTML(FCKConfig.FormatSource);if(d==null){return false}}else{d=this.EditingArea.Textarea.value}FCK.EditMode=c?FCK_EDITMODE_SOURCE:FCK_EDITMODE_WYSIWYG;FCK.SetData(d,!a);FCK.Focus();FCKTools.RunFunction(FCK.ToolbarSet.RefreshModeState,FCK.ToolbarSet);return true},InsertElement:function(c){if(typeof c=="string"){c=this.EditorDocument.createElement(c)}var a=c.nodeName.toLowerCase();FCKSelection.Restore();var b=new FCKDomRange(this.EditorWindow);b.MoveToSelection();b.DeleteContents();if(FCKListsLib.BlockElements[a]!=null){if(b.StartBlock){if(b.CheckStartOfBlock()){b.MoveToPosition(b.StartBlock,3)}else{if(b.CheckEndOfBlock()){b.MoveToPosition(b.StartBlock,4)}else{b.SplitBlock()}}}b.InsertNode(c);var d=FCKDomTools.GetNextSourceElement(c,false,null,["hr","br","param","img","area","input"],true);if(!d&&FCKConfig.EnterMode!="br"){d=this.EditorDocument.body.appendChild(this.EditorDocument.createElement(FCKConfig.EnterMode));if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(d)}}if(FCKListsLib.EmptyElements[a]==null){b.MoveToElementEditStart(c)}else{if(d){b.MoveToElementEditStart(d)}else{b.MoveToPosition(c,4)}}if(FCKBrowserInfo.IsGecko){if(d){d.scrollIntoView(false)}c.scrollIntoView(false)}}else{b.InsertNode(c);b.SetStart(c,4);b.SetEnd(c,4)}b.Select();b.Release();this.Focus();return c},_InsertBlockElement:function(a){},_IsFunctionKey:function(a){if(a>=16&&a<=20){return true}if(a==27||(a>=33&&a<=40)){return true}if(a==45){return true}return false},_KeyDownListener:function(a){if(!a){a=FCK.EditorWindow.event}if(FCK.EditorWindow){if(!FCK._IsFunctionKey(a.keyCode)&&!(a.ctrlKey||a.metaKey)&&!(a.keyCode==46)){FCK._KeyDownUndo()}}return true},_KeyDownUndo:function(){if(!FCKUndo.Typing){FCKUndo.SaveUndoStep();FCKUndo.Typing=true;FCK.Events.FireEvent("OnSelectionChange")}FCKUndo.TypesCount++;FCKUndo.Changed=1;if(FCKUndo.TypesCount>FCKUndo.MaxTypes){FCKUndo.TypesCount=0;FCKUndo.SaveUndoStep()}},_TabKeyHandler:function(d){if(!d){d=window.event}var g=d.keyCode;if(g==9&&FCK.EditMode!=FCK_EDITMODE_WYSIWYG){if(FCKBrowserInfo.IsIE){var e=document.selection.createRange();if(e.parentElement()!=FCK.EditingArea.Textarea){return true}e.text="\t";e.select()}else{var c=[];var f=FCK.EditingArea.Textarea;var h=f.selectionStart;var b=f.selectionEnd;c.push(f.value.substr(0,h));c.push("\t");c.push(f.value.substr(b));f.value=c.join("");f.setSelectionRange(h+1,h+1)}if(d.preventDefault){return d.preventDefault()}return d.returnValue=false}return true},ReDrawTable:function(d,g){if(g){d.className=g}var e=d.style.cssText.replace(new RegExp("background","gm"),"");e=e.replace(new RegExp("BACKGROUND","gm"),"");e=e.replace(new RegExp("border","gm"),"");e=e.replace(new RegExp("BORDER","gm"),"");d.style.cssText=e;var a=FCKTableHandler._CreateTableMap(d);for(var c=0;c<a.length;c++){if((c+1)%2==0){for(var b=0;b<a[c].length;b++){a[c][b].className="evener";a[c][0].className="lefterevener";var f=a[c][b].style.cssText.replace(new RegExp("background","gm"),"");f=f.replace(new RegExp("BACKGROUND","gm"),"");f=f.replace(new RegExp("border","gm"),"");f=f.replace(new RegExp("BORDER","gm"),"");a[c][b].style.cssText=f}}else{for(b=0;b<a[c].length;b++){a[c][b].className="odder";a[c][0].className="lefterodder";var f=a[c][b].style.cssText.replace(new RegExp("background","gm"),"");f=f.replace(new RegExp("BACKGROUND","gm"),"");f=f.replace(new RegExp("border","gm"),"");f=f.replace(new RegExp("BORDER","gm"),"");a[c][b].style.cssText=""}}}for(b=0;b<a[0].length;b++){a[0][b].className="header"}},ReDrawTableSaveUndo:function(){FCKUndo.SaveUndoStep()},ReDrawTableRedo:function(){FCKUndo.Undo()}};FCK.Events=new FCKEvents(FCK);FCK.GetHTML=FCK.GetXHTML=FCK.GetData;FCK.SetHTML=FCK.SetData;FCK.InsertElementAndGetIt=FCK.CreateElement=FCK.InsertElement;function _FCK_ProtectEvents_ReplaceTags(a){return a.replace(FCKRegexLib.EventAttributes,_FCK_ProtectEvents_ReplaceEvents)}function _FCK_ProtectEvents_ReplaceEvents(a,b){return" "+b+'_fckprotectedatt="'+encodeURIComponent(a)+'"'}function _FCK_ProtectEvents_RestoreEvents(a,b){return decodeURIComponent(b)}function _FCK_MouseEventsListener(a){if(!a){a=window.event}if(a.type=="mousedown"){FCK.MouseDownFlag=true}else{if(a.type=="mouseup"){FCK.MouseDownFlag=false}else{if(a.type=="mousemove"){FCK.Events.FireEvent("OnMouseMove",a)}}}}function _FCK_PaddingNodeListener(){if(FCKConfig.EnterMode.IEquals("br")){return}FCKDomTools.EnforcePaddingNode(FCK.EditorDocument,FCKConfig.EnterMode);if(!FCKBrowserInfo.IsIE&&FCKDomTools.PaddingNode){var e=FCKSelection.GetSelection();if(e&&e.rangeCount==1){var c=e.getRangeAt(0);if(c.collapsed&&c.startContainer==FCK.EditorDocument.body&&c.startOffset==0){c.selectNodeContents(FCKDomTools.PaddingNode);c.collapse(true);e.removeAllRanges();e.addRange(c)}}}else{if(FCKDomTools.PaddingNode){var b=FCKSelection.GetParentElement();var a=FCKDomTools.PaddingNode;if(b&&b.nodeName.IEquals("body")){if(FCK.EditorDocument.body.childNodes.length==1&&FCK.EditorDocument.body.firstChild==a){if(FCKSelection._GetSelectionDocument(FCK.EditorDocument.selection)!=FCK.EditorDocument){return}var c=FCK.EditorDocument.body.createTextRange();var d=false;if(!a.childNodes.firstChild){a.appendChild(FCKTools.GetElementDocument(a).createTextNode("\ufeff"));d=true}c.moveToElementText(a);c.select();if(d){c.pasteHTML("")}}}}}}function _FCK_EditingArea_OnLoad(){FCK.EditorWindow=FCK.EditingArea.Window;FCK.EditorDocument=FCK.EditingArea.Document;FCK.InitializeBehaviors();FCK.MouseDownFlag=false;FCKTools.AddEventListener(FCK.EditorDocument,"mousemove",_FCK_MouseEventsListener);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",_FCK_MouseEventsListener);FCKTools.AddEventListener(FCK.EditorDocument,"mouseup",_FCK_MouseEventsListener);if(FCKBrowserInfo.IsSafari){var a=function(b){if(!(b.ctrlKey||b.metaKey)){return}if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return}switch(b.keyCode){case 89:FCKUndo.Redo();break;case 90:FCKUndo.Undo();break}};FCKTools.AddEventListener(FCK.EditorDocument,"keyup",a)}FCK.EnterKeyHandler=new FCKEnterKey(FCK.EditorWindow,FCKConfig.EnterMode,FCKConfig.ShiftEnterMode,FCKConfig.TabSpaces);FCK.KeystrokeHandler.AttachToElement(FCK.EditorDocument);if(FCK._ForceResetIsDirty){FCK.ResetIsDirty()}if(FCKBrowserInfo.IsIE&&FCK.HasFocus){FCK.EditorDocument.body.setActive()}FCK.OnAfterSetHTML();FCKCommands.GetCommand("ShowBlocks").RestoreState();if(FCK.Status!=FCK_STATUS_NOTLOADED){return}FCK.SetStatus(FCK_STATUS_ACTIVE)}function _FCK_GetEditorAreaStyleTags(){return FCKTools.GetStyleHtml(FCKConfig.EditorAreaCSS)+FCKTools.GetStyleHtml(FCKConfig.EditorAreaDucklingCSS)+FCKTools.GetStyleHtml(FCKConfig.EditorAreaStyles)}function _FCK_KeystrokeHandler_OnKeystroke(b,a){if(FCK.Status!=FCK_STATUS_COMPLETE){return false}if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){switch(a){case"Paste":return !FCK.Paste();case"Cut":FCKUndo.SaveUndoStep();return false}}else{if(a.Equals("Paste","Undo","Redo","SelectAll","Cut")){return false}}var c=FCK.Commands.GetCommand(a);if(c.GetState()==FCK_TRISTATE_DISABLED){return false}return(c.Execute.apply(c,FCKTools.ArgumentsToArray(arguments,2))!==false)}(function(){var a=window.parent.document;var c=a.getElementById(FCK.Name);var b=0;while(c||b==0){if(c&&c.tagName.toLowerCase().Equals("input","textarea")){FCK.LinkedField=c;break}c=a.getElementsByName(FCK.Name)[b++]}})();var FCKTempBin={Elements:new Array(),AddElement:function(a){var b=this.Elements.length;this.Elements[b]=a;return b},RemoveElement:function(a){var b=this.Elements[a];this.Elements[a]=null;return b},Reset:function(){var a=0;while(a<this.Elements.length){this.Elements[a++]=null}this.Elements.length=0}};var FCKFocusManager=FCK.FocusManager={IsLocked:false,AddWindow:function(c,b){var a;if(FCKBrowserInfo.IsIE){a=c.nodeType==1?c:c.frameElement?c.frameElement:c.document}else{if(FCKBrowserInfo.IsSafari){a=c}else{a=c.document}}FCKTools.AddEventListener(a,"blur",FCKFocusManager_Win_OnBlur);FCKTools.AddEventListener(a,"focus",b?FCKFocusManager_Win_OnFocus_Area:FCKFocusManager_Win_OnFocus)},RemoveWindow:function(a){if(FCKBrowserInfo.IsIE){oTarget=a.nodeType==1?a:a.frameElement?a.frameElement:a.document}else{oTarget=a.document}FCKTools.RemoveEventListener(oTarget,"blur",FCKFocusManager_Win_OnBlur);FCKTools.RemoveEventListener(oTarget,"focus",FCKFocusManager_Win_OnFocus_Area);FCKTools.RemoveEventListener(oTarget,"focus",FCKFocusManager_Win_OnFocus)},Lock:function(){this.IsLocked=true},Unlock:function(){if(this._HasPendingBlur){FCKFocusManager._Timer=window.setTimeout(FCKFocusManager_FireOnBlur,100)}this.IsLocked=false},_ResetTimer:function(){this._HasPendingBlur=false;if(this._Timer){window.clearTimeout(this._Timer);delete this._Timer}}};function FCKFocusManager_Win_OnBlur(){if(typeof(FCK)!="undefined"&&FCK.HasFocus){FCKFocusManager._ResetTimer();FCKFocusManager._Timer=window.setTimeout(FCKFocusManager_FireOnBlur,100)}}function FCKFocusManager_FireOnBlur(){if(FCKFocusManager.IsLocked){FCKFocusManager._HasPendingBlur=true}else{FCK.HasFocus=false;FCK.Events.FireEvent("OnBlur")}}function FCKFocusManager_Win_OnFocus_Area(){if(FCKFocusManager._IsFocusing){return}FCKFocusManager._IsFocusing=true;FCK.Focus();FCKFocusManager_Win_OnFocus();FCKTools.RunFunction(function(){delete FCKFocusManager._IsFocusing})}function FCKFocusManager_Win_OnFocus(){FCKFocusManager._ResetTimer();if(!FCK.HasFocus&&!FCKFocusManager.IsLocked){FCK.HasFocus=true;FCK.Events.FireEvent("OnFocus")}}(function(){var d=window.frameElement;var c=d.width;var a=d.height;if(/^\d+$/.test(c)){c+="px"}if(/^\d+$/.test(a)){a+="px"}var b=d.style;b.border=b.padding=b.margin=0;b.backgroundColor="transparent";b.backgroundImage="none";b.width=c;b.height=a})();

FCK.Description="FCKeditor for Internet Explorer 5.5+";FCK._GetBehaviorsStyle=function(){if(!FCK._BehaviorsStyle){var b=FCKConfig.BasePath;var c="";var a;a='<style type="text/css" _fcktemp="true">';if(FCKConfig.ShowBorders){c="url("+b+"css/behaviors/showtableborders.htc)"}a+="INPUT,TEXTAREA,SELECT,.FCK__Anchor,.FCK__PageBreak,.FCK__InputHidden";if(FCKConfig.DisableObjectResizing){a+=",IMG";c+=" url("+b+"css/behaviors/disablehandles.htc)"}a+=" { behavior: url("+b+"css/behaviors/disablehandles.htc) ; }";if(c.length>0){a+="TABLE { behavior: "+c+" ; }"}a+="</style>";FCK._BehaviorsStyle=a}return FCK._BehaviorsStyle};function Doc_OnMouseUp(){if(FCK.EditorWindow.event.srcElement.tagName=="HTML"){FCK.Focus();FCK.EditorWindow.event.cancelBubble=true;FCK.EditorWindow.event.returnValue=false}}function Doc_OnPaste(){var a=FCK.EditorDocument.body;FCKTools.removeEventListener(a,"paste",Doc_OnPaste);var b=FCK.Paste(!FCKConfig.ForcePasteAsPlainText&&!FCKConfig.AutoDetectPasteFromWord);FCKTools.addEventListener(a,"paste",Doc_OnPaste);return b}function Doc_OnDblClick(){FCK.OnDoubleClick(FCK.EditorWindow.event.srcElement);FCK.EditorWindow.event.cancelBubble=true}function Doc_OnSelectionChange(){if(!FCK.IsSelectionChangeLocked&&FCK.EditorDocument){FCK.Events.FireEvent("OnSelectionChange")}}function Doc_OnDrop(){if(FCK.MouseDownFlag){FCK.MouseDownFlag=false;return}if(FCKConfig.ForcePasteAsPlainText){var a=FCK.EditorWindow.event;if(FCK._CheckIsPastingEnabled()||FCKConfig.ShowDropDialog){FCK.PasteAsPlainText(a.dataTransfer.getData("Text"))}a.returnValue=false;a.cancelBubble=true}}FCK.InitializeBehaviors=function(a){FCKTools.AddEventListener(this.EditorDocument,"mouseup",Doc_OnMouseUp);FCKTools.AddEventListener(this.EditorDocument.body,"paste",Doc_OnPaste);FCKTools.AddEventListener(this.EditorDocument.body,"drop",Doc_OnDrop);FCK.ContextMenu._InnerContextMenu.AttachToElement(FCK.EditorDocument.body);FCKTools.AddEventListener(this.EditorDocument,"keydown",FCK._KeyDownListener);FCKTools.AddEventListener(this.EditorDocument,"dblclick",Doc_OnDblClick);FCKTools.AddEventListener(this.EditorDocument,"selectionchange",Doc_OnSelectionChange);FCKTools.AddEventListener(FCK.EditorDocument,"mousedown",Doc_OnMouseDown)};FCK.InsertHtml=function(b){b=FCKConfig.ProtectedSource.Protect(b);b=FCK.ProtectEvents(b);b=FCK.ProtectUrls(b);b=FCK.ProtectTags(b);FCKSelection.Restore();FCK.EditorWindow.focus();FCKUndo.SaveUndoStep();var a=FCKSelection.GetSelection();if(a.type.toLowerCase()=="control"){a.clear()}b='<span id="__fakeFCKRemove__" style="display:none;">fakeFCKRemove</span>'+b;a.createRange().pasteHTML(b);FCK.EditorDocument.getElementById("__fakeFCKRemove__").removeNode(true);FCKDocumentProcessor.Process(FCK.EditorDocument);this.Events.FireEvent("OnSelectionChange")};FCK.SetInnerHtml=function(b){var a=FCK.EditorDocument;a.body.innerHTML='<div id="__fakeFCKRemove__">&nbsp;</div>'+b;a.getElementById("__fakeFCKRemove__").removeNode(true)};function FCK_PreloadImages(){var a=new FCKImagePreloader();a.AddImages(FCKConfig.PreloadImages);a.AddImages(FCKConfig.SkinPath+"fck_strip.gif");a.OnComplete=LoadToolbarSetup;a.Start()}function Document_OnContextMenu(){return(event.srcElement._FCKShowContextMenu==true)}document.oncontextmenu=Document_OnContextMenu;function FCK_Cleanup(){this.LinkedField=null;this.EditorWindow=null;this.EditorDocument=null}FCK._ExecPaste=function(){if(FCK._PasteIsRunning){return true}if(FCKConfig.ForcePasteAsPlainText){FCK.PasteAsPlainText();return false}var b=FCK._CheckIsPastingEnabled(true);if(b===false){FCKTools.RunFunction(FCKDialog.OpenDialog,FCKDialog,["FCKDialog_Paste",FCKLang.Paste,"dialog/fck_paste.html",400,330,"Security"])}else{if(FCKConfig.AutoDetectPasteFromWord&&b.length>0){var a=/<\w[^>]*(( class="?MsoNormal"?)|(="mso-))/gi;if(a.test(b)){}}FCK._PasteIsRunning=true;FCK.ExecuteNamedCommand("Paste");delete FCK._PasteIsRunning}return false};FCK.PasteAsPlainText=function(e){if(!FCK._CheckIsPastingEnabled()){FCKDialog.OpenDialog("FCKDialog_Paste",FCKLang.PasteAsText,"dialog/fck_paste.html",400,330,"PlainText");return}var b=null;if(!e){b=clipboardData.getData("Text")}else{b=e}if(b&&b.length>0){b=FCKTools.HTMLEncode(b);b=FCKTools.ProcessLineBreaks(window,FCKConfig,b);var c=b.search("</p>");var a=b.search("<p>");if((c!=-1&&a!=-1&&c<a)||(c!=-1&&a==-1)){var d=b.substr(0,c);b=b.substr(c+4);this.InsertHtml(d)}FCKUndo.SaveLocked=true;this.InsertHtml(b);FCKUndo.SaveLocked=false}};FCK._CheckIsPastingEnabled=function(a){FCK._PasteIsEnabled=false;document.body.attachEvent("onpaste",FCK_CheckPasting_Listener);var b=FCK.GetClipboardHTML();FCKTools.RemoveEventListener(document.body,"paste",FCK_CheckPasting_Listener);if(FCK._PasteIsEnabled){if(!a){b=true}}else{b=false}delete FCK._PasteIsEnabled;return b};function FCK_CheckPasting_Listener(){FCK._PasteIsEnabled=true}FCK.GetClipboardHTML=function(){var c=document.getElementById("___FCKHiddenDiv");if(!c){c=document.createElement("DIV");c.id="___FCKHiddenDiv";var b=c.style;b.position="absolute";b.visibility=b.overflow="hidden";b.width=b.height=1;document.body.appendChild(c);}c.innerHTML="";var d=document.body.createTextRange();d.moveToElementText(c);d.execCommand("Paste");var a=c.innerHTML;c.innerHTML="";return a};FCK.CreateLink=function(a,d){var b=new Array();FCK.ExecuteNamedCommand("Unlink",null,false,!!d);if(a.length>0){if(FCKSelection.GetType()=="Control"){var f=this.EditorDocument.createElement("A");f.href=a;var c=FCKSelection.GetSelectedElement();c.parentNode.insertBefore(f,c);c.parentNode.removeChild(c);f.appendChild(c);return[f]}var e="javascript:void(0);/*"+(new Date().getTime())+"*/";FCK.ExecuteNamedCommand("CreateLink",e,false,!!d);var j=this.EditorDocument.links;for(var g=0;g<j.length;g++){var f=j[g];if(f.getAttribute("href",2)==e){var h=f.innerHTML;f.href=a;f.innerHTML=h;var k=f.lastChild;if(k&&k.nodeName=="BR"){FCKDomTools.InsertAfterNode(f,f.removeChild(k))}b.push(f)}}}return b};function _FCK_RemoveDisabledAtt(){this.removeAttribute("disabled")}function Doc_OnMouseDown(a){var b=a.srcElement;if(b.nodeName.IEquals("input")&&b.type.IEquals(["radio","checkbox"])&&!b.disabled){b.disabled=true;FCKTools.SetTimeout(_FCK_RemoveDisabledAtt,1,b)}};
var FCKConfig=FCK.Config={};if (document.location.protocol=='file:'){FCKConfig.BasePath=decodeURIComponent(document.location.pathname.substr(1));FCKConfig.BasePath=FCKConfig.BasePath.replace(/\\/gi, '/');var sFullProtocol=document.location.href.match(/^(file\:\/{2,3})/)[1];if (FCKBrowserInfo.IsOpera) sFullProtocol+='localhost/';FCKConfig.BasePath=sFullProtocol+FCKConfig.BasePath.substring(0,FCKConfig.BasePath.lastIndexOf('/')+1);}else FCKConfig.BasePath=document.location.protocol+'//'+document.location.host+document.location.pathname.substring(0,document.location.pathname.lastIndexOf('/')+1);FCKConfig.FullBasePath=FCKConfig.BasePath;FCKConfig.EditorPath=FCKConfig.BasePath.replace(/editor\/$/,'');try{FCKConfig.ScreenWidth=screen.width;FCKConfig.ScreenHeight=screen.height;}catch (e){FCKConfig.ScreenWidth=800;FCKConfig.ScreenHeight=600;};FCKConfig.ProcessHiddenField=function(){this.PageConfig={};var A=window.parent.document.getElementById(FCK.Name+'___Config');if (!A) return;var B=A.value.split('&');for (var i=0;i<B.length;i++){if (B[i].length==0) continue;var C=B[i].split('=');var D=decodeURIComponent(C[0]);var E=decodeURIComponent(C[1]);if (D=='CustomConfigurationsPath') FCKConfig[D]=E;else if (E.toLowerCase()=="true") this.PageConfig[D]=true;else if (E.toLowerCase()=="false") this.PageConfig[D]=false;else if (E.length>0&&!isNaN(E)) this.PageConfig[D]=parseInt(E,10);else this.PageConfig[D]=E;}};function FCKConfig_LoadPageConfig(){var A=FCKConfig.PageConfig;for (var B in A) FCKConfig[B]=A[B];};function FCKConfig_PreProcess(){var A=FCKConfig;if (A.AllowQueryStringDebug){try{if ((/fckdebug=true/i).test(window.top.location.search)) A.Debug=true;}catch (e) {/*Ignore it. Much probably we are inside a FRAME where the "top" is in another domain (security error).*/}};if (!A.PluginsPath.EndsWith('/')) A.PluginsPath+='/';var B=A.ToolbarComboPreviewCSS;if (!B||B.length==0) A.ToolbarComboPreviewCSS=A.EditorAreaCSS;A.RemoveAttributesArray=(A.RemoveAttributes||'').split(',');if (!FCKConfig.SkinEditorCSS||FCKConfig.SkinEditorCSS.length==0) FCKConfig.SkinEditorCSS=FCKConfig.SkinPath+'fck_editor.css';if (!FCKConfig.SkinDialogCSS||FCKConfig.SkinDialogCSS.length==0) FCKConfig.SkinDialogCSS=FCKConfig.EditorAreaDucklingCSS;/*FCKConfig.SkinDialogCSS=FCKConfig.SkinPath+'fck_dialog.css';*/};FCKConfig.ToolbarSets={};FCKConfig.Plugins={};FCKConfig.Plugins.Items=[];FCKConfig.Plugins.Add=function(A,B,C){FCKConfig.Plugins.Items.AddItem([A,B,C]);};FCKConfig.ProtectedSource={};FCKConfig.ProtectedSource._CodeTag=(new Date()).valueOf();FCKConfig.ProtectedSource.RegexEntries=[/<!--[\s\S]*?-->/g,/<script[\s\S]*?<\/script>/gi,/<noscript[\s\S]*?<\/noscript>/gi];FCKConfig.ProtectedSource.Add=function(A){this.RegexEntries.AddItem(A);};FCKConfig.ProtectedSource.Protect=function(A){var B=this._CodeTag;function _Replace(protectedSource){var C=FCKTempBin.AddElement(protectedSource);return '<!--{'+B+C+'}-->';};for (var i=0;i<this.RegexEntries.length;i++){A=A.replace(this.RegexEntries[i],_Replace);};return A;};FCKConfig.ProtectedSource.Revert=function(A,B){function _Replace(m,opener,index){var C=B?FCKTempBin.RemoveElement(index):FCKTempBin.Elements[index];return FCKConfig.ProtectedSource.Revert(C,B);};var D=new RegExp("(<|&lt;)!--\\{"+this._CodeTag+"(\\d+)\\}--(>|&gt;)","g");return A.replace(D,_Replace);};FCKConfig.GetBodyAttributes=function(){var A='';if (this.BodyId&&this.BodyId.length>0) A+=' id="'+this.BodyId+'"';if (this.BodyClass&&this.BodyClass.length>0) A+=' class="'+this.BodyClass+'"';return A;};FCKConfig.ApplyBodyAttributes=function(A){if (this.BodyId&&this.BodyId.length>0) A.id=FCKConfig.BodyId;if (this.BodyClass&&this.BodyClass.length>0) A.className+=' '+FCKConfig.BodyClass;};
var FCKDebug={Output:function(){},OutputObject:function(){}};
var FCKDomTools={RemoveAttr:function(b,a){if(b){if(a){if(FCKBrowserInfo.IsGeckoLike||FCKBrowserInfo.IsGecko){delete b[a]}else{b.removeAttribute(a)}}}},MoveChildren:function(c,d,b){if(c==d){return}var a;if(b){while((a=c.lastChild)){d.insertBefore(c.removeChild(a),d.firstChild)}}else{while((a=c.firstChild)){d.appendChild(c.removeChild(a))}}},MoveNode:function(b,c,a){if(a){c.insertBefore(FCKDomTools.RemoveNode(b),c.firstChild)}else{c.appendChild(FCKDomTools.RemoveNode(b))}},TrimNode:function(a){this.LTrimNode(a);this.RTrimNode(a)},LTrimNode:function(c){var d;while((d=c.firstChild)){if(d.nodeType==3){var b=d.nodeValue.LTrim();var a=d.nodeValue.length;if(b.length==0){c.removeChild(d);continue}else{if(b.length<a){d.splitText(a-b.length);c.removeChild(c.firstChild)}}}break}},RTrimNode:function(c){var d;while((d=c.lastChild)){if(d.nodeType==3){var b=d.nodeValue.RTrim();var a=d.nodeValue.length;if(b.length==0){d.parentNode.removeChild(d);continue}else{if(b.length<a){d.splitText(b.length);c.lastChild.parentNode.removeChild(c.lastChild)}}}break}if(!FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsOpera){d=c.lastChild;if(d&&d.nodeType==1&&d.nodeName.toLowerCase()=="br"){d.parentNode.removeChild(d)}}},RemoveNode:function(b,c){if(c){var a;while((a=b.firstChild)){b.parentNode.insertBefore(b.removeChild(a),b)}}return b.parentNode.removeChild(b)},GetFirstChild:function(c,a){if(typeof(a)=="string"){a=[a]}var b=c.firstChild;while(b){if(b.nodeType==1&&b.tagName.Equals.apply(b.tagName,a)){return b}b=b.nextSibling}return null},GetLastChild:function(c,a){if(typeof(a)=="string"){a=[a]}var b=c.lastChild;while(b){if(b.nodeType==1&&(!a||b.tagName.Equals(a))){return b}b=b.previousSibling}return null},GetPreviousSourceElement:function(c,d,a,b){if(!c){return null}if(a&&c.nodeType==1&&c.nodeName.IEquals(a)){return null}if(c.previousSibling){c=c.previousSibling}else{return this.GetPreviousSourceElement(c.parentNode,d,a,b)}while(c){if(c.nodeType==1){if(a&&c.nodeName.IEquals(a)){break}if(!b||!c.nodeName.IEquals(b)){return c}}else{if(d&&c.nodeType==3&&c.nodeValue.RTrim().length>0){break}}if(c.lastChild){c=c.lastChild}else{return this.GetPreviousSourceElement(c,d,a,b)}}return null},GetNextSourceElement:function(d,e,b,c,a){while((d=this.GetNextSourceNode(d,a))){if(d.nodeType==1){if(b&&d.nodeName.IEquals(b)){break}if(c&&d.nodeName.IEquals(c)){return this.GetNextSourceElement(d,e,b,c)}return d}else{if(e&&d.nodeType==3&&d.nodeValue.RTrim().length>0){break}}}return null},GetNextSourceNode:function(c,a,b,d){if(!c){return null}var e;if(!a&&c.firstChild){e=c.firstChild}else{if(d&&c==d){return null}e=c.nextSibling;if(!e&&(!d||d!=c.parentNode)){return this.GetNextSourceNode(c.parentNode,true,b,d)}}if(b&&e&&e.nodeType!=b){return this.GetNextSourceNode(e,false,b,d)}return e},GetPreviousSourceNode:function(c,a,b,d){if(!c){return null}var e;if(!a&&c.lastChild){e=c.lastChild}else{if(d&&c==d){return null}e=c.previousSibling;if(!e&&(!d||d!=c.parentNode)){return this.GetPreviousSourceNode(c.parentNode,true,b,d)}}if(b&&e&&e.nodeType!=b){return this.GetPreviousSourceNode(e,false,b,d)}return e},InsertAfterNode:function(b,a){return b.parentNode.insertBefore(a,b.nextSibling)},GetParents:function(b){var a=new Array();while(b){a.unshift(b);b=b.parentNode}return a},GetCommonParents:function(c,b){var f=this.GetParents(c);var e=this.GetParents(b);var a=[];for(var d=0;d<f.length;d++){if(f[d]==e[d]){a.push(f[d])}}return a},GetCommonParentNode:function(b,a,e){var f={};if(!e.pop){e=[e]}while(e.length>0){f[e.pop().toLowerCase()]=1}var d=this.GetCommonParents(b,a);var c=null;while((c=d.pop())){if(f[c.nodeName.toLowerCase()]){return c}}return null},GetIndexOf:function(c){var b=c.parentNode?c.parentNode.firstChild:null;var a=-1;while(b){a++;if(b==c){return a}b=b.nextSibling}return -1},PaddingNode:null,EnforcePaddingNode:function(d,a){try{if(!d||!d.body){return}}catch(c){return}this.CheckAndRemovePaddingNode(d,a,true);try{if(d.body.lastChild&&(d.body.lastChild.nodeType!=1||d.body.lastChild.tagName.toLowerCase()==a.toLowerCase())){return}}catch(c){return}var b=d.createElement(a);if(FCKBrowserInfo.IsGecko&&FCKListsLib.NonEmptyBlockElements[a]){FCKTools.AppendBogusBr(b)}this.PaddingNode=b;if(d.body.childNodes.length==1&&d.body.firstChild.nodeType==1&&d.body.firstChild.tagName.toLowerCase()=="br"&&(d.body.firstChild.getAttribute("_moz_dirty")!=null||d.body.firstChild.getAttribute("type")=="_moz")){d.body.replaceChild(b,d.body.firstChild)}else{d.body.appendChild(b)}},CheckAndRemovePaddingNode:function(f,c,b){var a=this.PaddingNode;if(!a){return}try{if(a.parentNode!=f.body||a.tagName.toLowerCase()!=c||(a.childNodes.length>1)||(a.firstChild&&a.firstChild.nodeValue!="\xa0"&&String(a.firstChild.tagName).toLowerCase()!="br")){this.PaddingNode=null;return}}catch(d){this.PaddingNode=null;return}if(!b){if(a.parentNode.childNodes.length>1){a.parentNode.removeChild(a)}this.PaddingNode=null}},HasAttribute:function(c,b){if(c.hasAttribute){return c.hasAttribute(b)}else{var a=c.attributes[b];return(a!=undefined&&a.specified)}},HasAttributes:function(c){var a=c.attributes;for(var b=0;b<a.length;b++){if(FCKBrowserInfo.IsIE&&a[b].nodeName=="class"){if(c.className.length>0){return true}}else{if(a[b].specified){return true}}}return false},RemoveAttribute:function(b,a){if(FCKBrowserInfo.IsIE&&a.toLowerCase()=="class"){a="className"}return b.removeAttribute(a,0)},RemoveAttributes:function(c,a){for(var b=0;b<a.length;b++){this.RemoveAttribute(c,a[b])}},GetAttributeValue:function(b,a){var c=a;if(typeof a=="string"){a=b.attributes[a]}else{c=a.nodeName}if(a&&a.specified){if(c=="style"){return b.style.cssText}else{if(c=="class"||c.indexOf("on")==0){return a.nodeValue}else{return b.getAttribute(c,2)}}}return null},Contains:function(b,a){if(b.contains&&a.nodeType==1){return b.contains(a)}while((a=a.parentNode)){if(a==b){return true}}return false},BreakParent:function(c,e,d){var a=d||new FCKDomRange(FCKTools.GetElementWindow(c));a.SetStart(c,4);a.SetEnd(e,4);var b=a.ExtractContents();a.InsertNode(c.parentNode.removeChild(c));b.InsertAfterNode(c);a.Release(!!d)},GetNodeAddress:function(f,g){var c=[];while(f&&f!=FCKTools.GetElementDocument(f).documentElement){var a=f.parentNode;var b=-1;for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];if(g===true&&e.nodeType==3&&e.previousSibling&&e.previousSibling.nodeType==3){continue}b++;if(a.childNodes[d]==f){break}}c.unshift(b);f=f.parentNode}return c},GetNodeFromAddress:function(f,e,g){var h=f.documentElement;for(var b=0;b<e.length;b++){var c=e[b];if(!g){h=h.childNodes[c];continue}var d=-1;for(var a=0;a<h.childNodes.length;a++){var k=h.childNodes[a];if(g===true&&k.nodeType==3&&k.previousSibling&&k.previousSibling.nodeType==3){continue}d++;if(d==c){h=k;break}}}return h},CloneElement:function(a){a=a.cloneNode(false);a.removeAttribute("id",false);return a},ClearElementJSProperty:function(b,a){if(FCKBrowserInfo.IsIE){b.removeAttribute(a)}else{delete b[a]}},SetElementMarker:function(a,c,b,d){var e=String(parseInt(Math.random()*268435455,10));c._FCKMarkerId=e;c[b]=d;if(!a[e]){a[e]={"element":c,"markers":{}}}a[e]["markers"][b]=d},ClearElementMarkers:function(a,d,c){var e=d._FCKMarkerId;if(!e||!a[e]){return}this.ClearElementJSProperty(d,"_FCKMarkerId");for(var b in a[e]["markers"]){this.ClearElementJSProperty(d,b)}if(c){delete a[e]}},ClearAllMarkers:function(a){for(var b in a){this.ClearElementMarkers(a,a[b]["element"],true)}},ListToArray:function(c,d,k,h,l){if(!c.nodeName.IEquals(["ul","ol"])){return[]}if(!h){h=0}if(!k){k=[]}for(var f=0;f<c.childNodes.length;f++){var a=c.childNodes[f];if(!a.nodeName.IEquals("li")){continue}var g={"parent":c,"indent":h,"id":a.id,"className":a.className,"attributes":a.attributes,"m_element":a,"contents":[]};if(!l){g.grandparent=c.parentNode;if(g.grandparent&&g.grandparent.nodeName.IEquals("li")){g.grandparent=g.grandparent.parentNode}}else{g.grandparent=l}if(d){this.SetElementMarker(d,a,"_FCK_ListArray_Index",k.length)}k.push(g);for(var e=0;e<a.childNodes.length;e++){var b=a.childNodes[e];if(b.nodeName.IEquals(["ul","ol"])){this.ListToArray(b,d,k,h+1,g.grandparent)}else{g.contents.push(b)}}}return k},ArrayToList:function(d,e,k){if(k==undefined){k=0}if(!d||d.length<k+1){return null}var m=FCKTools.GetElementDocument(d[k].parent);var b=m.createDocumentFragment();var c=null;var j=k;var n=Math.max(d[k].indent,0);var l=null;while(true){var o=d[j];if(o.indent==n){if(!c||d[j].parent.nodeName!=c.nodeName){c=d[j].parent.cloneNode(false);b.appendChild(c)}l=m.createElement("li");l=this.CopyAttributes(o.m_element,l);c.appendChild(l);for(var g=0;g<o.contents.length;g++){l.appendChild(o.contents[g].cloneNode(true));if(o.id!=""){l.id=o.id}l.className=o.className}j++}else{if(o.indent==Math.max(n,0)+1){var h=this.ArrayToList(d,null,j);if(!h){return null}l.appendChild(h.listNode);j=h.nextIndex}else{if(o.indent==-1&&k==0&&o.grandparent){var l;if(o.grandparent.nodeName.IEquals(["ul","ol"])){l=m.createElement("li")}else{if(FCKConfig.EnterMode.IEquals(["div","p"])&&!o.grandparent.nodeName.IEquals("td")){l=m.createElement(FCKConfig.EnterMode)}else{l=m.createDocumentFragment()}}for(var g=0;g<o.contents.length;g++){l.appendChild(o.contents[g].cloneNode(true))}if(l.nodeType==11){if(l.lastChild&&l.lastChild.getAttribute&&l.lastChild.getAttribute("type")=="_moz"){l.removeChild(l.lastChild)}l.appendChild(m.createElement("br"))}if(l.nodeName.IEquals(FCKConfig.EnterMode)&&l.firstChild){this.TrimNode(l);if(FCKListsLib.BlockBoundaries[l.firstChild.nodeName.toLowerCase()]){var f=m.createDocumentFragment();while(l.firstChild){f.appendChild(l.removeChild(l.firstChild))}l=f}}if(FCKBrowserInfo.IsGeckoLike&&!FCKBrowserInfo.IsIE11&&l.nodeName.IEquals(["div","p"])){FCKTools.AppendBogusBr(l)}l=this.CopyAttributes(o.m_element,l);b.appendChild(l);c=null;j++}else{return null}}}if(d.length<=j||Math.max(d[j].indent,0)<n){break}}if(e){var a=b.firstChild;while(a){if(a.nodeType==1){this.ClearElementMarkers(e,a)}a=this.GetNextSourceNode(a)}}return{"listNode":b,"nextIndex":j}},GetNextSibling:function(b,a){b=b.nextSibling;while(b&&!a&&b.nodeType!=1&&(b.nodeType!=3||b.nodeValue.length==0)){b=b.nextSibling}return b},GetPreviousSibling:function(b,a){b=b.previousSibling;while(b&&!a&&b.nodeType!=1&&(b.nodeType!=3||b.nodeValue.length==0)){b=b.previousSibling}return b},CheckIsEmptyElement:function(c,b){var d=c.firstChild;var a=null;while(d){if(d.nodeType==1){if(a||!FCKListsLib.InlineNonEmptyElements[d.nodeName.toLowerCase()]){return false}if(!b||b(d)===true){a=d}}else{if(d.nodeType==3&&d.nodeValue.length>0){return false}}d=d.nextSibling}return a?this.CheckIsEmptyElement(a,b):true},SetElementStyles:function(c,a){var d=c.style;for(var b in a){d[b]=a[b]}},SetOpacity:function(b,a){if(typeof b.style.opacity!="undefined"){b.style.opacity=a}else{a=Math.round(a*100);b.style.filter=(a>100?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+a+")")}},GetCurrentElementStyle:function(b,a){if(FCKBrowserInfo.IsIE){return b.currentStyle[a]}else{return b.ownerDocument.defaultView.getComputedStyle(b,"").getPropertyValue(a)}},GetPositionedAncestor:function(b){var a=b;while(a!=FCKTools.GetElementDocument(a).documentElement){if(this.GetCurrentElementStyle(a,"position")!="static"){return a}if(a==FCKTools.GetElementDocument(a).documentElement&&currentWindow!=w){a=currentWindow.frameElement}else{a=a.parentNode}}return null},ScrollIntoView:function(b,d){var c=FCKTools.GetElementWindow(b);var f=FCKTools.GetViewPaneSize(c).Height;var e=f*-1;if(d===false){e+=b.offsetHeight;e+=parseInt(this.GetCurrentElementStyle(b,"marginBottom")||0,10)}e+=b.offsetTop;while((b=b.offsetParent)){e+=b.offsetTop||0}var a=FCKTools.GetScrollPosition(c).Y;if(e>0&&e>a){c.scrollTo(0,e)}},CheckIsEditable:function(a){var c=a.nodeName.toLowerCase();var b=FCK.DTD[c]||FCK.DTD.span;return(b["#"]&&!FCKListsLib.NonEditableElements[c])},CopyAttributes:function(f,d){var g=f.attributes;for(var b=0;b<g.length;b++){var c=g[b];var a=c.nodeName.toLowerCase();if(c.specified){var e=f.getAttribute(a);if(d.nodeType==1){d.setAttribute(a,e)}}}if(f.style.cssText){d.style.cssText=f.style.cssText}return d},FixDomTree:function(f){var d=["P:COLORSCHEME"];var h=["META","LINK","STYLE","FCK:META","TITLE","O:SHAPELAYOUT","O:IDMAP","COL","O:P"];var j="";if(!f){return j}if(f.nodeType==3){var b=f.nodeValue;b=b.replace(new RegExp("&","gm"),"&amp;");b=b.replace(new RegExp(">","gm"),"&gt;");b=b.replace(new RegExp("<","gm"),"&lt;");j=j+b}else{if(f.nodeType==1){for(var g=0;g<h.length;g++){if(f.scopeName){if(h[g]==(f.scopeName+":"+f.nodeName).toUpperCase()){return""}}else{if(h[g]==f.nodeName.toUpperCase()){return""}}}var k=false;for(var g=0;g<d.length;g++){if(f.scopeName){if(d[g]==(f.scopeName+":"+f.nodeName).toUpperCase()){k=true}}else{if(d[g]==f.nodeName.toUpperCase()){k=true}}}if(!k){if(f.tagName=="IMG"&&f.getAttribute("_fckflash")){f=FCK.GetRealElement(f)}if(f.tagName=="A"){if(f.href){var e=f.getAttribute("href",2);f._fcksavedurl=e}}j="<"+f.tagName;var m=f.attributes;if(m!=null){for(g=0;g<m.length;g++){if(m[g].specified){if(m[g].name=="href"){var l=m[g].value;if(l){l=l.replace("&quot;","");l=l.replace('"',"")}j+=' href="'+f.getAttribute("href",2)+'"'}else{if(m[g].name.indexOf(":")==-1){var l=m[g].value;if(l){l=l.replace("&quot;","");l=l.replace('"',"")}j+=" "+m[g].name+'="'+l+'"'}}}}if(f.style.cssText){j+=" "+"style"+'="'+f.style.cssText+'"'}}if(f.tagName.toLowerCase()=="input"){j=j+'value="'+f.getAttribute("value")+'"'}if(!!/^(area|base|basefont|col|frame|hr|img|br|input|isindex|link|meta|param)$/.test(f.tagName.toLowerCase())){return j+" />"}j=j+">"}var c=f.childNodes;if(c!=null){for(var g=0;g<c.length;g++){j=j+this.FixDomTree(c[g])}}if(!k){j=j+"</"+f.tagName+">"}}}j=j.replace('<SPAN style=""></SPAN>',"");return j}};
var FCKTools={};FCKTools.CreateBogusBR=function(a){var b=a.createElement("br");b.setAttribute("type","_moz");return b};FCKTools.FixCssUrls=function(a,b){if(!a||a.length==0){return b}return b.replace(/url\s*\(([\s'"]*)(.*?)([\s"']*)\)/g,function(c,d,e,f){if(/^\/|^\w?:/.test(e)){return c}else{return"url("+d+a+e+f+")"}})};FCKTools._GetUrlFixedCss=function(c,b){var a=c.match(/^([^|]+)\|([\s\S]*)/);if(a){return FCKTools.FixCssUrls(a[1],a[2])}else{return c}};FCKTools.AppendStyleSheet=function(d,c){if(!c){return[]}if(typeof(c)=="string"){if(/[\\\/\.][^{}]*$/.test(c)){return this.AppendStyleSheet(d,c.split(","))}else{return[this.AppendStyleString(d,FCKTools._GetUrlFixedCss(c))]}}else{var b=[];for(var a=0;a<c.length;a++){b.push(this._AppendStyleSheet(d,c[a]))}return b}};FCKTools.GetStyleHtml=(function(){var a=function(e,d){if(e.length==0){return""}var c=d?' _fcktemp="true"':"";return"<"+'style type="text/css"'+c+">"+e+"<"+"/style>"};var b=function(c,e){if(c.length==0){return""}var d=e?' _fcktemp="true"':"";return"<"+'link href="'+c+'" type="text/css" rel="stylesheet" '+d+"/>"};return function(f,e){if(!f){return""}if(typeof(f)=="string"){if(/[\\\/\.][^{}]*$/.test(f)){return this.GetStyleHtml(f.split(","),e)}else{return a(this._GetUrlFixedCss(f),e)}}else{var d="";for(var c=0;c<f.length;c++){d+=b(f[c],e)}return d}}})();FCKTools.GetElementDocument=function(a){return a.ownerDocument||a.document};FCKTools.GetElementWindow=function(a){return this.GetDocumentWindow(this.GetElementDocument(a))};FCKTools.GetDocumentWindow=function(a){if(FCKBrowserInfo.IsSafari&&!a.parentWindow){this.FixDocumentParentWindow(window.top)}return a.parentWindow||a.defaultView};FCKTools.FixDocumentParentWindow=function(b){if(b.document){b.document.parentWindow=b}for(var a=0;a<b.frames.length;a++){FCKTools.FixDocumentParentWindow(b.frames[a])}};FCKTools.HTMLEncode=function(a){if(!a){return""}a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a};FCKTools.HTMLDecode=function(a){if(!a){return""}a=a.replace(/&gt;/g,">");a=a.replace(/&lt;/g,"<");a=a.replace(/&amp;/g,"&");return a};FCKTools._ProcessLineBreaksForPMode=function(l,o,k,b,f){var m=0;var e="<p>";var g="</p>";var h="<br />";if(k){e="<li>";g="</li>";m=1}while(b&&b!=l.FCK.EditorDocument.body){if(b.tagName.toLowerCase()=="p"){m=1;break}b=b.parentNode}for(var d=0;d<o.length;d++){var j=o.charAt(d);if(j=="\r"){continue}if(j!="\n"){f.push(j);continue}var a=o.charAt(d+1);if(a=="\r"){d++;a=o.charAt(d+1)}if(a=="\n"){d++;if(m){f.push(g)}f.push(e);m=1}else{f.push(h)}}};FCKTools._ProcessLineBreaksForDivMode=function(j,l,h,a,e){var k=0;var d="<div>";var f="</div>";if(h){d="<li>";f="</li>";k=1}while(a&&a!=j.FCK.EditorDocument.body){if(a.tagName.toLowerCase()=="div"){k=1;break}a=a.parentNode}for(var b=0;b<l.length;b++){var g=l.charAt(b);if(g=="\r"){continue}if(g!="\n"){e.push(g);continue}if(k){if(e[e.length-1]==d){e.push("&nbsp;")}e.push(f)}e.push(d);k=1}if(k){e.push(f)}};FCKTools._ProcessLineBreaksForBrMode=function(j,l,h,a,e){var k=0;var d="<br />";var f="";if(h){d="<li>";f="</li>";k=1}for(var b=0;b<l.length;b++){var g=l.charAt(b);if(g=="\r"){continue}if(g!="\n"){e.push(g);continue}if(k&&f.length){e.push(f)}e.push(d);k=1}};FCKTools.ProcessLineBreaks=function(g,e,h){var c=e.EnterMode.toLowerCase();var a=[];var f=0;var b=new g.FCKDomRange(g.FCK.EditorWindow);b.MoveToSelection();var d=b._Range.startContainer;while(d&&d.nodeType!=1){d=d.parentNode}if(d&&d.tagName.toLowerCase()=="li"){f=1}if(c=="p"){this._ProcessLineBreaksForPMode(g,h,f,d,a)}else{if(c=="div"){this._ProcessLineBreaksForDivMode(g,h,f,d,a)}else{if(c=="br"){this._ProcessLineBreaksForBrMode(g,h,f,d,a)}}}return a.join("")};FCKTools.AddSelectOption=function(a,d,c){var b=FCKTools.GetElementDocument(a).createElement("OPTION");b.text=d;b.value=c;a.options.add(b);return b};FCKTools.RunFunction=function(c,a,d,b){if(c){this.SetTimeout(c,0,a,d,b)}};FCKTools.SetTimeout=function(d,c,a,e,b){return(b||window).setTimeout(function(){if(e){d.apply(a,[].concat(e))}else{d.apply(a)}},c)};FCKTools.SetInterval=function(d,c,a,e,b){return(b||window).setInterval(function(){d.apply(a,e||[])},c)};FCKTools.ConvertStyleSizeToHtml=function(a){return a.EndsWith("%")?a:parseInt(a,10)};FCKTools.ConvertHtmlSizeToStyle=function(a){return a.EndsWith("%")?a:(a+"px")};FCKTools.GetElementAscensor=function(b,a){var c=b;var d=","+a.toUpperCase()+",";while(c){if(d.indexOf(","+c.nodeName.toUpperCase()+",")!=-1){return c}c=c.parentNode}return null};FCKTools.CreateEventListener=function(a,c){var b=function(){var e=[];for(var d=0;d<arguments.length;d++){e.push(arguments[d])}a.apply(this,e.concat(c))};return b};FCKTools.IsStrictMode=function(a){return("CSS1Compat"==(a.compatMode||(FCKBrowserInfo.IsSafari?"CSS1Compat":null)))};FCKTools.ArgumentsToArray=function(b,e,a){e=e||0;a=a||b.length;var d=new Array();for(var c=e;c<e+a&&c<b.length;c++){d.push(b[c])}return d};FCKTools.CloneObject=function(b){var a=function(){};a.prototype=b;return new a};FCKTools.AppendBogusBr=function(b){if(!b){return}var a=this.GetLastItem(b.getElementsByTagName("br"));if(!a||(a.getAttribute("type",2)!="_moz"&&a.getAttribute("_moz_dirty")==null)){var c=this.GetElementDocument(b);if(!FCKBrowserInfo.IsIE11&&(FCKBrowserInfo.IsIE||FCKBrowserInfo.IsOpera)){b.appendChild(c.createTextNode(""))}else{b.appendChild(this.CreateBogusBR(c))}}};FCKTools.GetLastItem=function(a){if(a.length>0){return a[a.length-1]}return null};FCKTools.GetDocumentPosition=function(c,f){var a=0;var h=0;var e=f;var b=null;var d=FCKTools.GetElementWindow(e);while(e&&!(d==c&&(e==c.document.body||e==c.document.documentElement))){a+=e.offsetLeft-e.scrollLeft;h+=e.offsetTop-e.scrollTop;if(!FCKBrowserInfo.IsOpera){var g=b;while(g&&g!=e){a-=g.scrollLeft;h-=g.scrollTop;g=g.parentNode}}b=e;if(e.offsetParent){e=e.offsetParent}else{if(d!=c){e=d.frameElement;b=null;if(e){d=e.contentWindow.parent}}else{e=null}}}if(FCKDomTools.GetCurrentElementStyle(c.document.body,"position")!="static"||(FCKBrowserInfo.IsIE&&FCKDomTools.GetPositionedAncestor(f)==null)){a+=c.document.body.offsetLeft;h+=c.document.body.offsetTop}return{"x":a,"y":h}};FCKTools.GetWindowPosition=function(b,c){var d=this.GetDocumentPosition(b,c);var a=FCKTools.GetScrollPosition(b);d.x-=a.X;d.y-=a.Y;return d};FCKTools.ProtectFormStyles=function(f){if(!f||f.nodeType!=1||f.tagName.toLowerCase()!="form"){return[]}var e=[];var d=["style","className"];for(var c=0;c<d.length;c++){var b=d[c];if(f.elements.namedItem(b)){var a=f.elements.namedItem(b);e.push([a,a.nextSibling]);f.removeChild(a)}}return e};FCKTools.RestoreFormStyles=function(e,d){if(!e||e.nodeType!=1||e.tagName.toLowerCase()!="form"){return}if(d.length>0){for(var a=d.length-1;a>=0;a--){var c=d[a][0];var b=d[a][1];if(b){e.insertBefore(c,b)}else{e.appendChild(c)}}}};FCKTools.GetNextNode=function(b,c){if(b.firstChild){return b.firstChild}else{if(b.nextSibling){return b.nextSibling}else{var a=b.parentNode;while(a){if(a==c){return null}if(a.nextSibling){return a.nextSibling}else{a=a.parentNode}}}}return null};FCKTools.GetNextTextNode=function(a,b,c){node=this.GetNextNode(a,b);if(c&&node&&c(node)){return null}while(node&&node.nodeType!=3){node=this.GetNextNode(node,b);if(c&&node&&c(node)){return null}}return node};FCKTools.Merge=function(){var b=arguments;var e=b[0];for(var c=1;c<b.length;c++){var a=b[c];for(var d in a){e[d]=a[d]}}return e};FCKTools.IsArray=function(a){return(a instanceof Array)};FCKTools.AppendLengthProperty=function(c,b){var a=0;for(var d in c){a++}return c[b||"length"]=a};FCKTools.NormalizeCssText=function(a){var b=document.createElement("span");b.style.cssText=a;return b.style.cssText};FCKTools.Bind=function(a,b){return function(){return b.apply(a,arguments)}};FCKTools.GetVoidUrl=function(){if(FCK_IS_CUSTOM_DOMAIN){return"javascript: void( function(){"+"document.open();"+"document.write('<html><head><title></title></head><body></body></html>');"+"document.domain = '"+FCK_RUNTIME_DOMAIN+"';"+"document.close();"+"}() ) ;"}if(FCKBrowserInfo.IsIE){if(FCKBrowserInfo.IsIE7||!FCKBrowserInfo.IsIE6){return""}else{return"javascript: '';"}}return"javascript: void(0);"};FCKTools.ResetStyles=function(a){a.style.cssText="margin:0;"+"padding:0;"+"border:0;"+"background-color:transparent;"+"background-image:none;"};
FCKTools.CancelEvent=function(a){if(a.preventDefault){a.preventDefault()}a.returnValue=false;return false};FCKTools._AppendStyleSheet=function(b,a){if(b.createStyleSheet){return b.createStyleSheet(a).owningElement}else{var c=b.createElement("LINK");c.rel="stylesheet";c.type="text/css";c.href=a;b.getElementsByTagName("HEAD")[0].appendChild(c);return c}};FCKTools.AppendStyleString=function(b,c){if(!c){return null}var a=b.createStyleSheet("");a.cssText=c;return a};FCKTools.ClearElementAttributes=function(a){a.clearAttributes()};FCKTools.GetAllChildrenIds=function(a){var d=new Array();for(var c=0;c<a.all.length;c++){var b=a.all[c].id;if(b&&b.length>0){d[d.length]=b}}return d};FCKTools.RemoveOuterTags=function(a){a.insertAdjacentHTML("beforeBegin",a.innerHTML);a.parentNode.removeChild(a)};FCKTools.CreateXmlObject=function(a){var c=null;switch(a){case"XmlHttp":try{return new XMLHttpRequest()}catch(d){}c=["MSXML2.XmlHttp","Microsoft.XmlHttp"];break;case"DOMDocument":c=["MSXML2.DOMDocument","Microsoft.XmlDom"];break}if(c){for(var b=0;b<2;b++){try{return new ActiveXObject(c[b])}catch(d){}}}if(FCKLang.NoActiveX){alert(FCKLang.NoActiveX);FCKLang.NoActiveX=null}return null};FCKTools.DisableSelection=function(b){var c=(typeof b.style.msUserSelect!="undefined")&&!FCKBrowserInfo.IsIE10;if(c){b.style.msUserSelect="none"}else{b.setAttribute("unselectable","on")}var f,a=0;var d=b.getElementsByTagName("*");while((f=d[a++])){switch(f.tagName){case"IFRAME":case"TEXTAREA":case"INPUT":case"SELECT":break;default:if(c){f.style.msUserSelect="none"}else{f.setAttribute("unselectable","on")}}}};FCKTools.GetScrollPosition=function(b){var a=b.document;var c={X:a.documentElement.scrollLeft,Y:a.documentElement.scrollTop};if(c.X>0||c.Y>0){return c}return{X:a.body.scrollLeft,Y:a.body.scrollTop}};FCKTools.AddEventListener=function(d,a,b,c){if(typeof oTemp==undefined){c=false}if(d.attachEvent){d.attachEvent("on"+a,b)}else{d.addEventListener(a,b,c)}};FCKTools.RemoveEventListener=function(c,a,b){if(c.detachEvent){c.detachEvent("on"+a,b)}else{c.removeEventListener(a,b,false)}};FCKTools._PreventDefault=function(a){if(a.preventDefault){a.preventDefault()}a.returnValue=false};FCKTools.AddEventListenerEx=function(e,a,b,d){var c=new Object();c.Source=e;c.Params=d||[];c.Listener=function(g){var f=b.apply(c.Source,[g].concat(c.Params));if(!f){FCKTools.CancelEvent(g)}return f};if(FCK.IECleanup){FCK.IECleanup.AddItem(null,function(){c.Source=null;c.Params=null})}FCKTools.AddEventListener(e,a,c.Listener);e=null;d=null};FCKTools.GetViewPaneSize=function(c){var b;var a=c.document.documentElement;if(a&&a.clientWidth){b=a}else{b=c.document.body}if(b){return{Width:b.clientWidth,Height:b.clientHeight}}else{return{Width:0,Height:0}}};FCKTools.SaveStyles=function(c){var d=FCKTools.ProtectFormStyles(c);var b=new Object();if(c.className.length>0){b.Class=c.className;c.className=""}var a=c.style.cssText;if(a.length>0){b.Inline=a;c.style.cssText=""}FCKTools.RestoreFormStyles(c,d);return b};FCKTools.RestoreStyles=function(b,a){var c=FCKTools.ProtectFormStyles(b);b.className=a.Class||"";b.style.cssText=a.Inline||"";FCKTools.RestoreFormStyles(b,c)};FCKTools.RegisterDollarFunction=function(a){a.$=function(b){return a.document.getElementById(b)}};FCKTools.AppendElement=function(b,a){return b.appendChild(this.GetElementDocument(b).createElement(a))};FCKTools.ToLowerCase=function(a){return a.toLowerCase()};

var FCKeditorAPI;function InitializeAPI(){var A=window.parent;if (!(FCKeditorAPI=A.FCKeditorAPI)){var B='window.FCKeditorAPI = {Version : "2.6.2",VersionBuild : "19417",Instances : new Object(),GetInstance : function( name ){return this.Instances[ name ];},_FormSubmit : function(){for ( var name in FCKeditorAPI.Instances ){var oEditor = FCKeditorAPI.Instances[ name ] ;if ( oEditor.GetParentForm && oEditor.GetParentForm() == this )oEditor.UpdateLinkedField() ;}this._FCKOriginalSubmit() ;},_FunctionQueue	: {Functions : new Array(),IsRunning : false,Add : function( f ){this.Functions.push( f );if ( !this.IsRunning )this.StartNext();},StartNext : function(){var aQueue = this.Functions ;if ( aQueue.length > 0 ){this.IsRunning = true;aQueue[0].call();}else this.IsRunning = false;},Remove : function( f ){var aQueue = this.Functions;var i = 0, fFunc;while( (fFunc = aQueue[ i ]) ){if ( fFunc == f )aQueue.splice( i,1 );i++ ;}this.StartNext();}}}';if (A.execScript) A.execScript(B,'JavaScript');else{if (FCKBrowserInfo.IsGecko10){eval.call(A,B);}else if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.FCKeditorAPI_Evaluate(A,B);}else if (FCKBrowserInfo.IsSafari||FCKBrowserInfo.IsGecko19){var C=A.document;var D=C.createElement('script');D.appendChild(C.createTextNode(B));C.documentElement.appendChild(D);}else A.eval(B);};FCKeditorAPI=A.FCKeditorAPI;FCKeditorAPI.__Instances=FCKeditorAPI.Instances;};FCKeditorAPI.Instances[FCK.Name]=FCK;};function _AttachFormSubmitToAPI(){var A=FCK.GetParentForm();if (A){FCKTools.AddEventListener(A,'submit',FCK.UpdateLinkedField);if (!A._FCKOriginalSubmit&&(typeof(A.submit)=='function'||(!A.submit.tagName&&!A.submit.length))){A._FCKOriginalSubmit=A.submit;A.submit=FCKeditorAPI._FormSubmit;}}};function FCKeditorAPI_Cleanup(){if (window.FCKConfig&&FCKConfig.MsWebBrowserControlCompat&&!window.FCKUnloadFlag) return;delete FCKeditorAPI.Instances[FCK.Name];};function FCKeditorAPI_ConfirmCleanup(){if (window.FCKConfig&&FCKConfig.MsWebBrowserControlCompat) window.FCKUnloadFlag=true;};FCKTools.AddEventListener(window,'unload',FCKeditorAPI_Cleanup);FCKTools.AddEventListener(window,'beforeunload',FCKeditorAPI_ConfirmCleanup);
var FCKImagePreloader=function(){this._Images=[];};FCKImagePreloader.prototype={AddImages:function(A){if (typeof(A)=='string') A=A.split(';');this._Images=this._Images.concat(A);},Start:function(){var A=this._Images;this._PreloadCount=A.length;for (var i=0;i<A.length;i++){var B=document.createElement('img');FCKTools.AddEventListenerEx(B,'load',_FCKImagePreloader_OnImage,this);FCKTools.AddEventListenerEx(B,'error',_FCKImagePreloader_OnImage,this);B.src=A[i];_FCKImagePreloader_ImageCache.push(B);}}};var _FCKImagePreloader_ImageCache=[];function _FCKImagePreloader_OnImage(A,B){if ((--B._PreloadCount)==0&&B.OnComplete) B.OnComplete();};
var FCKRegexLib={AposEntity:/&apos;/gi,ObjectElements:/^(?:IMG|TABLE|TR|TD|TH|INPUT|SELECT|TEXTAREA|HR|OBJECT|A|UL|OL|LI)$/i,NamedCommands:/^(?:Cut|Copy|Paste|Print|SelectAll|RemoveFormat|Unlink|Undo|Redo|Bold|Italic|Underline|StrikeThrough|Subscript|Superscript|JustifyLeft|JustifyCenter|JustifyRight|JustifyFull|Outdent|Indent|InsertOrderedList|InsertUnorderedList|InsertHorizontalRule)$/i,BeforeBody:/(^[\s\S]*\<body[^\>]*\>)/i,AfterBody:/(\<\/body\>[\s\S]*$)/i,ToReplace:/___fcktoreplace:([\w]+)/ig,MetaHttpEquiv:/http-equiv\s*=\s*["']?([^"' ]+)/i,HasBaseTag:/<base /i,HasBodyTag:/<body[\s|>]/i,HtmlOpener:/<html\s?[^>]*>/i,HeadOpener:/<head\s?[^>]*>/i,HeadCloser:/<\/head\s*>/i,FCK_Class:/\s*FCK__[^ ]*(?=\s+|$)/,ElementName:/(^[a-z_:][\w.\-:]*\w$)|(^[a-z_]$)/,ForceSimpleAmpersand:/___FCKAmp___/g,SpaceNoClose:/\/>/g,EmptyParagraph:/^<(p|div|address|h\d|center)(?=[ >])[^>]*>\s*(<\/\1>)?$/,EmptyOutParagraph:/^<(p|div|address|h\d|center)(?=[ >])[^>]*>(?:\s*|&nbsp;)(<\/\1>)?$/,TagBody:/></,GeckoEntitiesMarker:/#\?-\:/g,ProtectUrlsImg:/<img(?=\s).*?\ssrc=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,ProtectUrlsA:/<a(?=\s).*?\shref=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,ProtectUrlsArea:/<area(?=\s).*?\shref=((?:(?:\s*)("|').*?\2)|(?:[^"'][^ >]+))/gi,Html4DocType:/HTML 4\.0 Transitional/i,DocTypeTag:/<!DOCTYPE[^>]*>/i,HtmlDocType:/DTD HTML/,TagsWithEvent:/<[^\>]+ on\w+[\s\r\n]*=[\s\r\n]*?('|")[\s\S]+?\>/g,EventAttributes:/\s(on\w+)[\s\r\n]*=[\s\r\n]*?('|")([\s\S]*?)\2/g,ProtectedEvents:/\s\w+_fckprotectedatt="([^"]+)"/g,StyleProperties:/\S+\s*:/g,InvalidSelfCloseTags:/(<(?!base|meta|link|hr|br|param|img|area|input)([a-zA-Z0-9:]+)[^>]*)\/>/gi,StyleVariableAttName:/#\(\s*("|')(.+?)\1[^\)]*\s*\)/g,RegExp:/^\/(.*)\/([gim]*)$/,HtmlTag:/<[^\s<>](?:"[^"]*"|'[^']*'|[^<])*>/};
var FCKListsLib={BlockElements:{ address:1,blockquote:1,center:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,marquee:1,noscript:1,ol:1,p:1,pre:1,script:1,table:1,ul:1 },NonEmptyBlockElements:{ p:1,div:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,address:1,pre:1,ol:1,ul:1,li:1,td:1,th:1 },InlineChildReqElements:{ abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,'var':1 },InlineNonEmptyElements:{ a:1,abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,'var':1 },EmptyElements:{ base:1,col:1,meta:1,link:1,hr:1,br:1,param:1,img:1,area:1,input:1 },PathBlockElements:{ address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,de:1 },PathBlockLimitElements:{ body:1,div:1,td:1,th:1,caption:1,form:1 },StyleBlockElements:{ address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1 },StyleObjectElements:{ img:1,hr:1,li:1,table:1,tr:1,td:1,embed:1,object:1,ol:1,ul:1 },NonEditableElements:{ button:1,option:1,script:1,iframe:1,textarea:1,object:1,embed:1,map:1,applet:1 },BlockBoundaries:{ p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,address:1,pre:1,ol:1,ul:1,li:1,dt:1,de:1,table:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,caption:1,col:1,colgroup:1,blockquote:1,body:1 },ListBoundaries:{ p:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,address:1,pre:1,ol:1,ul:1,li:1,dt:1,de:1,table:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,caption:1,col:1,colgroup:1,blockquote:1,body:1,br:1 }};
var FCKLanguageManager=FCK.Language={AvailableLanguages:{af:"Afrikaans",ar:"Arabic",bg:"Bulgarian",bn:"Bengali/Bangla",bs:"Bosnian",ca:"Catalan",cs:"Czech",da:"Danish",de:"German",el:"Greek",en:"English","en-au":"English (Australia)","en-ca":"English (Canadian)","en-uk":"English (United Kingdom)",eo:"Esperanto",es:"Spanish",et:"Estonian",eu:"Basque",fa:"Persian",fi:"Finnish",fo:"Faroese",fr:"French","fr-ca":"French (Canada)",gl:"Galician",gu:"Gujarati",he:"Hebrew",hi:"Hindi",hr:"Croatian",hu:"Hungarian",it:"Italian",ja:"Japanese",km:"Khmer",ko:"Korean",lt:"Lithuanian",lv:"Latvian",mn:"Mongolian",ms:"Malay",nb:"Norwegian Bokmal",nl:"Dutch",no:"Norwegian",pl:"Polish",pt:"Portuguese (Portugal)","pt-br":"Portuguese (Brazil)",ro:"Romanian",ru:"Russian",sk:"Slovak",sl:"Slovenian",sr:"Serbian (Cyrillic)","sr-latn":"Serbian (Latin)",sv:"Swedish",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",zh:"Chinese Traditional","zh-cn":"Chinese Simplified"},GetActiveLanguage:function(){if(FCKConfig.AutoDetectLanguage){var a;if(navigator.userLanguage){a=navigator.userLanguage.toLowerCase()}else{if(navigator.language){a=navigator.language.toLowerCase()}else{return FCKConfig.DefaultLanguage}}if(a.length>=5){a=a.substr(0,5);if(this.AvailableLanguages[a]){return a}}if(a.length>=2){a=a.substr(0,2);if(this.AvailableLanguages[a]){return a}}}return this.DefaultLanguage},TranslateElements:function(g,b,a,f){var j=g.getElementsByTagName(b);var h,d;for(var c=0;c<j.length;c++){if((h=j[c].getAttribute("fckLang"))){if((d=FCKLang[h])){if(f){d=FCKTools.HTMLEncode(d)}j[c][a]=d}}}},TranslatePage:function(a){this.TranslateElements(a,"INPUT","value");this.TranslateElements(a,"SPAN","innerHTML");this.TranslateElements(a,"LABEL","innerHTML");this.TranslateElements(a,"OPTION","innerHTML",true);this.TranslateElements(a,"LEGEND","innerHTML")},Initialize:function(){if(this.AvailableLanguages[FCKConfig.DefaultLanguage]){this.DefaultLanguage=FCKConfig.DefaultLanguage}else{this.DefaultLanguage="en-us"}this.ActiveLanguage={};this.ActiveLanguage.Code=this.GetActiveLanguage();this.ActiveLanguage.Name=this.AvailableLanguages[this.ActiveLanguage.Code];var a=FCKConfig.DucklingLocales;if(this.AvailableLanguages[a]==undefined){a="en-us"}this.ActiveLanguage.Code=a;this.ActiveLanguage.Name=this.AvailableLanguages[a]}};
var FCKXHtmlEntities={};FCKXHtmlEntities.Initialize=function(){if (FCKXHtmlEntities.Entities) return;var A='';var B,e;if (FCKConfig.ProcessHTMLEntities){FCKXHtmlEntities.Entities={'':'nbsp','':'iexcl','':'cent','':'pound','':'curren','':'yen','':'brvbar','':'sect','':'uml','':'copy','':'ordf','':'laquo','':'not','':'shy','':'reg','':'macr','':'deg','':'plusmn','':'sup2','':'sup3','':'acute','':'micro','':'para','':'middot','':'cedil','':'sup1','':'ordm','':'raquo','':'frac14','':'frac12','':'frac34','':'iquest','':'times','':'divide','':'fnof','':'bull','':'hellip','':'prime','':'Prime','':'oline','':'frasl','':'weierp','':'image','':'real','':'trade','':'alefsym','':'larr','':'uarr','':'rarr','':'darr','':'harr','':'crarr','':'lArr','':'uArr','':'rArr','':'dArr','':'hArr','':'forall','':'part','':'exist','':'empty','':'nabla','':'isin','':'notin','':'ni','':'prod','':'sum','':'minus','':'lowast','':'radic','':'prop','':'infin','':'ang','':'and','':'or','':'cap','':'cup','':'int','':'there4','':'sim','':'cong','':'asymp','':'ne','':'equiv','':'le','':'ge','':'sub','':'sup','':'nsub','':'sube','':'supe','':'oplus','':'otimes','':'perp','':'sdot','\u2308':'lceil','\u2309':'rceil','\u230a':'lfloor','\u230b':'rfloor','\u2329':'lang','\u232a':'rang','':'loz','':'spades','':'clubs','':'hearts','':'diams','"':'quot','':'circ','':'tilde','':'ensp','':'emsp','':'thinsp','':'zwnj','':'zwj','':'lrm','':'rlm','':'ndash','':'mdash','':'lsquo','':'rsquo','':'sbquo','':'ldquo','':'rdquo','':'bdquo','':'dagger','':'Dagger','':'permil','':'lsaquo','':'rsaquo','':'euro'};for (e in FCKXHtmlEntities.Entities) A+=e;if (FCKConfig.IncludeLatinEntities){B={'':'Agrave','':'Aacute','':'Acirc','':'Atilde','':'Auml','':'Aring','':'AElig','':'Ccedil','':'Egrave','':'Eacute','':'Ecirc','':'Euml','':'Igrave','':'Iacute','':'Icirc','':'Iuml','':'ETH','':'Ntilde','':'Ograve','':'Oacute','':'Ocirc','':'Otilde','':'Ouml','':'Oslash','':'Ugrave','':'Uacute','':'Ucirc','':'Uuml','':'Yacute','':'THORN','':'szlig','':'agrave','':'aacute','':'acirc','':'atilde','':'auml','':'aring','':'aelig','':'ccedil','':'egrave','':'eacute','':'ecirc','':'euml','':'igrave','':'iacute','':'icirc','':'iuml','':'eth','':'ntilde','':'ograve','':'oacute','':'ocirc','':'otilde','':'ouml','':'oslash','':'ugrave','':'uacute','':'ucirc','':'uuml','':'yacute','':'thorn','':'yuml','':'OElig','':'oelig','':'Scaron','':'scaron','':'Yuml'};for (e in B){FCKXHtmlEntities.Entities[e]=B[e];A+=e;};B=null;};if (FCKConfig.IncludeGreekEntities){B={'':'Alpha','':'Beta','':'Gamma','':'Delta','':'Epsilon','':'Zeta','':'Eta','':'Theta','':'Iota','':'Kappa','':'Lambda','':'Mu','':'Nu','':'Xi','':'Omicron','':'Pi','':'Rho','':'Sigma','':'Tau','':'Upsilon','':'Phi','':'Chi','':'Psi','':'Omega','':'alpha','':'beta','':'gamma','':'delta','':'epsilon','':'zeta','':'eta','':'theta','':'iota','':'kappa','':'lambda','':'mu','':'nu','':'xi','':'omicron','':'pi','':'rho','':'sigmaf','':'sigma','':'tau','':'upsilon','':'phi','':'chi','':'psi','':'omega','\u03d1':'thetasym','\u03d2':'upsih','\u03d6':'piv'};for (e in B){FCKXHtmlEntities.Entities[e]=B[e];A+=e;};B=null;}}else{FCKXHtmlEntities.Entities={};A='';};var C='['+A+']';if (FCKConfig.ProcessNumericEntities) C='[^ -~]|'+C;var D=FCKConfig.AdditionalNumericEntities;if (D&&D.length>0) C+='|'+FCKConfig.AdditionalNumericEntities;FCKXHtmlEntities.EntitiesRegex=new RegExp(C,'g');};
var FCKXHtml=new Object();FCKXHtml.CurrentJobNum=0;FCKXHtml.GetXHTML=function(e,f,g){FCKDomTools.CheckAndRemovePaddingNode(FCKTools.GetElementDocument(e),FCKConfig.EnterMode);FCKXHtmlEntities.Initialize();this._NbspEntity=(FCKConfig.ProcessHTMLEntities?"nbsp":"#160");var b=FCK.IsDirty();FCKXHtml.SpecialBlocks=[];this.XML=FCKTools.CreateXmlObject("DOMDocument");this.MainNode=this.XML.appendChild(this.XML.createElement("xhtml"));FCKXHtml.CurrentJobNum++;if(f){this._AppendNode(this.MainNode,e)}else{this._AppendChildNodes(this.MainNode,e,false)}var d=this._GetMainXmlString();this.XML=null;if(FCKBrowserInfo.IsSafari){d=d.replace(/^<xhtml.*?>/,"<xhtml>")}d=d.substr(7,d.length-15).Trim();if(FCKConfig.DocType.length>0&&FCKRegexLib.HtmlDocType.test(FCKConfig.DocType)){d=d.replace(FCKRegexLib.SpaceNoClose,">")}else{d=d.replace(FCKRegexLib.SpaceNoClose," />")}if(FCKConfig.ForceSimpleAmpersand){d=d.replace(FCKRegexLib.ForceSimpleAmpersand,"&")}if(g){d=FCKCodeFormatter.Format(d)}for(var c=0;c<FCKXHtml.SpecialBlocks.length;c++){var a=new RegExp("___FCKsi___"+c);d=d.replace(a,FCKXHtml.SpecialBlocks[c])}d=d.replace(FCKRegexLib.GeckoEntitiesMarker,"&");if(!b){FCK.ResetIsDirty()}FCKDomTools.EnforcePaddingNode(FCKTools.GetElementDocument(e),FCKConfig.EnterMode);return d};FCKXHtml._AppendAttribute=function(b,a,c){try{if(c==undefined||c==null){c=""}else{if(c.replace){if(FCKConfig.ForceSimpleAmpersand){c=c.replace(/&/g,"___FCKAmp___")}c=c.replace(FCKXHtmlEntities.EntitiesRegex,FCKXHtml_GetEntity)}}var d=this.XML.createAttribute(a);d.value=c;b.attributes.setNamedItem(d)}catch(f){}};FCKXHtml._AppendChildNodes=function(a,c,d){var f=c.firstChild;while(f){this._AppendNode(a,f);f=f.nextSibling}if(d&&c.tagName&&c.tagName.toLowerCase()!="pre"){FCKDomTools.TrimNode(a);if(FCKConfig.FillEmptyBlocks){var b=a.lastChild;if(b&&b.nodeType==1&&b.nodeName=="br"){this._AppendEntity(a,this._NbspEntity)}}}if(a.childNodes.length==0){if(d&&FCKConfig.FillEmptyBlocks){this._AppendEntity(a,this._NbspEntity);return a}var e=a.nodeName;if(FCKListsLib.InlineChildReqElements[e]){return null}if(!FCKListsLib.EmptyElements[e]){a.appendChild(this.XML.createTextNode(""))}}return a};FCKXHtml._AppendNode=function(b,c){if(!c){return false}switch(c.nodeType){case 1:if(FCKBrowserInfo.IsGecko&&c.tagName.toLowerCase()=="br"&&c.parentNode.tagName.toLowerCase()=="pre"){var i="\r";if(c==c.parentNode.firstChild){i+="\r"}return FCKXHtml._AppendNode(b,this.XML.createTextNode(i))}if(c.getAttribute("_fckfakelement")){return FCKXHtml._AppendNode(b,FCK.GetRealElement(c))}if(FCKBrowserInfo.IsGecko&&(c.hasAttribute("_moz_editor_bogus_node")||c.getAttribute("type")=="_moz")){if(c.nextSibling||FCKBrowserInfo.IsIE11){return false}}if(c.getAttribute("_fcktemp")){return false}var h=c.tagName.toLowerCase();if(FCKBrowserInfo.IsIE){if(c.scopeName&&c.scopeName!="HTML"&&c.scopeName!="FCK"){h=c.scopeName.toLowerCase()+":"+h}}else{if(h.StartsWith("fck:")){h=h.Remove(0,4)}}if(!FCKRegexLib.ElementName.test(h)){return false}if(c._fckxhtmljob&&c._fckxhtmljob==FCKXHtml.CurrentJobNum){return false}if(h=="o:o:p"){return false}if(h=="st1:st1:chmetcnv"){return false}var g=null;try{g=this.XML.createElement(h)}catch(a){return false}FCKXHtml._AppendAttributes(b,c,g,h);c._fckxhtmljob=FCKXHtml.CurrentJobNum;var f=FCKXHtml.TagProcessors[h];if(f){g=f(g,c,b)}else{g=this._AppendChildNodes(g,c,Boolean(FCKListsLib.NonEmptyBlockElements[h]))}if(!g){return false}b.appendChild(g);break;case 3:if(c.parentNode&&c.parentNode.nodeName.IEquals("pre")){return this._AppendTextNode(b,c.nodeValue)}return this._AppendTextNode(b,c.nodeValue.ReplaceNewLineChars(" "));case 8:if(FCKBrowserInfo.IsIE&&!c.innerHTML){break}try{b.appendChild(this.XML.createComment(c.nodeValue))}catch(d){}break;default:b.appendChild(this.XML.createComment("Element not supported - Type: "+c.nodeType+" Name: "+c.nodeName));break}return true};FCKXHtml._AppendSpecialItem=function(a){return"___FCKsi___"+FCKXHtml.SpecialBlocks.AddItem(a)};FCKXHtml._AppendEntity=function(b,a){b.appendChild(this.XML.createTextNode("#?-:"+a+";"))};FCKXHtml._AppendTextNode=function(c,a){var b=a.length>0;if(b){c.appendChild(this.XML.createTextNode(a.replace(FCKXHtmlEntities.EntitiesRegex,FCKXHtml_GetEntity)))}return b};function FCKXHtml_GetEntity(b){var a=FCKXHtmlEntities.Entities[b]||("#"+b.charCodeAt(0));return"#?-:"+a+";"}FCKXHtml.TagProcessors={a:function(b,c){if(c.innerHTML.Trim().length==0&&!c.name){return false}var a=c.getAttribute("_fcksavedurl");if(a!=null){FCKXHtml._AppendAttribute(b,"href",a)}if(FCKBrowserInfo.IsIE){if(c.name){FCKXHtml._AppendAttribute(b,"name",c.name)}}b=FCKXHtml._AppendChildNodes(b,c,false);return b},area:function(d,e){var b=e.getAttribute("_fcksavedurl");if(b!=null){FCKXHtml._AppendAttribute(d,"href",b)}if(FCKBrowserInfo.IsIE){if(!d.attributes.getNamedItem("coords")){var a=e.getAttribute("coords",2);if(a&&a!="0,0,0"){FCKXHtml._AppendAttribute(d,"coords",a)}}if(!d.attributes.getNamedItem("shape")){var c=e.getAttribute("shape",2);if(c&&c.length>0){FCKXHtml._AppendAttribute(d,"shape",c.toLowerCase())}}}return d},body:function(a,b){a=FCKXHtml._AppendChildNodes(a,b,false);a.removeAttribute("spellcheck");return a},iframe:function(a,b){var c=b.innerHTML;if(FCKBrowserInfo.IsGecko){c=FCKTools.HTMLDecode(c)}c=c.replace(/\s_fcksavedurl="[^"]*"/g,"");a.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(c)));return a},img:function(b,c){if(!b.attributes.getNamedItem("alt")){FCKXHtml._AppendAttribute(b,"alt","")}var a=c.getAttribute("_fcksavedurl");if(a!=null){FCKXHtml._AppendAttribute(b,"src",a)}if(c.style.width){b.removeAttribute("width")}if(c.style.height){b.removeAttribute("height")}return b},li:function(a,b,c){if(c.nodeName.IEquals(["ul","ol"])){return FCKXHtml._AppendChildNodes(a,b,true)}var d=FCKXHtml.XML.createElement("ul");b._fckxhtmljob=null;do{FCKXHtml._AppendNode(d,b);do{b=FCKDomTools.GetNextSibling(b)}while(b&&b.nodeType==3&&b.nodeValue.Trim().length==0)}while(b&&b.nodeName.toLowerCase()=="li");return d},ol:function(b,c,d){if(c.innerHTML.Trim().length==0){return false}var a=d.lastChild;if(a&&a.nodeType==3){a=a.previousSibling}if(a&&a.nodeName.toUpperCase()=="LI"){c._fckxhtmljob=null;FCKXHtml._AppendNode(a,c);return false}b=FCKXHtml._AppendChildNodes(b,c);return b},pre:function(a,b){var c=b.firstChild;if(c&&c.nodeType==3){a.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem("\r\n")))}FCKXHtml._AppendChildNodes(a,b,true);return a},script:function(a,b){if(!a.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(a,"type","text/javascript")}a.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(b.text)));return a},span:function(a,b){if(b.innerHTML.length==0){return false}a=FCKXHtml._AppendChildNodes(a,b,false);return a},style:function(b,c){if(!b.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(b,"type","text/css")}var a=c.innerHTML;if(FCKBrowserInfo.IsIE){a=a.replace(/^(\r\n|\n|\r)/,"")}b.appendChild(FCKXHtml.XML.createTextNode(FCKXHtml._AppendSpecialItem(a)));return b},title:function(a,b){a.appendChild(FCKXHtml.XML.createTextNode(FCK.EditorDocument.title));return a}};FCKXHtml.TagProcessors.ul=FCKXHtml.TagProcessors.ol;
FCKXHtml._GetMainXmlString=function(){return this.MainNode.xml};FCKXHtml._AppendAttributes=function(o,m,d,k){var h=m.attributes,c=false;for(var b=0;b<h.length;b++){var i=h[b];if(i.specified){var f=i.nodeName.toLowerCase();var a;if(f.StartsWith("_fck")){continue}else{if(f=="style"){c=true;continue}else{if(f=="class"){a=i.nodeValue.replace(FCKRegexLib.FCK_Class,"");if(a.length==0){continue}}else{if(f.indexOf("on")==0){a=i.nodeValue}else{if(k=="body"&&f=="contenteditable"){continue}else{if(i.nodeValue===true){a=f}else{try{a=m.getAttribute(f,2)}catch(g){}}}}}}}this._AppendAttribute(d,f,a||i.nodeValue)}}if(c||m.style.cssText.length>0){var l=FCKTools.ProtectFormStyles(m);var j=m.style.cssText.replace(FCKRegexLib.StyleProperties,FCKTools.ToLowerCase);FCKTools.RestoreFormStyles(m,l);this._AppendAttribute(d,"style",j)}};FCKXHtml.TagProcessors["div"]=function(a,b){if(b.align.length>0){FCKXHtml._AppendAttribute(a,"align",b.align)}a=FCKXHtml._AppendChildNodes(a,b,true);return a};FCKXHtml.TagProcessors["font"]=function(a,b){if(a.attributes.length==0){a=FCKXHtml.XML.createDocumentFragment()}a=FCKXHtml._AppendChildNodes(a,b);return a};FCKXHtml.TagProcessors["form"]=function(b,c){if(c.acceptCharset&&c.acceptCharset.length>0&&c.acceptCharset!="UNKNOWN"){FCKXHtml._AppendAttribute(b,"accept-charset",c.acceptCharset)}var a=c.attributes["name"];if(a&&a.value.length>0){FCKXHtml._AppendAttribute(b,"name",a.value)}b=FCKXHtml._AppendChildNodes(b,c,true);return b};FCKXHtml.TagProcessors["input"]=function(a,b){if(b.name){FCKXHtml._AppendAttribute(a,"name",b.name)}if(b.value&&!a.attributes.getNamedItem("value")){FCKXHtml._AppendAttribute(a,"value",b.value)}if(!a.attributes.getNamedItem("type")){FCKXHtml._AppendAttribute(a,"type","text")}return a};FCKXHtml.TagProcessors["label"]=function(a,b){if(b.htmlFor.length>0){FCKXHtml._AppendAttribute(a,"for",b.htmlFor)}a=FCKXHtml._AppendChildNodes(a,b);return a};FCKXHtml.TagProcessors["map"]=function(b,c){if(!b.attributes.getNamedItem("name")){var a=c.name;if(a){FCKXHtml._AppendAttribute(b,"name",a)}}b=FCKXHtml._AppendChildNodes(b,c,true);return b};FCKXHtml.TagProcessors["meta"]=function(c,d){var a=c.attributes.getNamedItem("http-equiv");if(a==null||a.value.length==0){var b=d.outerHTML.match(FCKRegexLib.MetaHttpEquiv);if(b){b=b[1];FCKXHtml._AppendAttribute(c,"http-equiv",b)}}return c};FCKXHtml.TagProcessors["option"]=function(a,b){if(b.selected&&!a.attributes.getNamedItem("selected")){FCKXHtml._AppendAttribute(a,"selected","selected")}a=FCKXHtml._AppendChildNodes(a,b);return a};FCKXHtml.TagProcessors["textarea"]=FCKXHtml.TagProcessors["select"]=function(a,b){if(b.name){FCKXHtml._AppendAttribute(a,"name",b.name)}a=FCKXHtml._AppendChildNodes(a,b);return a};
var FCKCodeFormatter={};FCKCodeFormatter.Init=function(){var A=this.Regex={};A.BlocksOpener=/\<(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;A.BlocksCloser=/\<\/(P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|TITLE|META|LINK|BASE|SCRIPT|LINK|TD|TH|AREA|OPTION)[^\>]*\>/gi;A.NewLineTags=/\<(BR|HR)[^\>]*\>/gi;A.MainTags=/\<\/?(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR)[^\>]*\>/gi;A.LineSplitter=/\s*\n+\s*/g;A.IncreaseIndent=/^\<(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL)[ \/\>]/i;A.DecreaseIndent=/^\<\/(HTML|HEAD|BODY|FORM|TABLE|TBODY|THEAD|TR|UL|OL)[ \>]/i;A.FormatIndentatorRemove=new RegExp('^'+FCKConfig.FormatIndentator);A.ProtectedTags=/(<PRE[^>]*>)([\s\S]*?)(<\/PRE>)/gi;};FCKCodeFormatter._ProtectData=function(A,B,C,D){return B+'___FCKpd___'+FCKCodeFormatter.ProtectedData.AddItem(C)+D;};FCKCodeFormatter.Format=function(A){if (!this.Regex) this.Init();FCKCodeFormatter.ProtectedData=[];var B=A.replace(this.Regex.ProtectedTags,FCKCodeFormatter._ProtectData);B=B.replace(this.Regex.BlocksOpener,'\n$&');B=B.replace(this.Regex.BlocksCloser,'$&\n');B=B.replace(this.Regex.NewLineTags,'$&\n');B=B.replace(this.Regex.MainTags,'\n$&\n');var C='';var D=B.split(this.Regex.LineSplitter);B='';for (var i=0;i<D.length;i++){var E=D[i];if (E.length==0) continue;if (this.Regex.DecreaseIndent.test(E)) C=C.replace(this.Regex.FormatIndentatorRemove,'');B+=C+E+'\n';if (this.Regex.IncreaseIndent.test(E)) C+=FCKConfig.FormatIndentator;};for (var j=0;j<FCKCodeFormatter.ProtectedData.length;j++){var F=new RegExp('___FCKpd___'+j);B=B.replace(F,FCKCodeFormatter.ProtectedData[j].replace(/\$/g,'$$$$'));};return B.Trim();};
//versionend! Before there i don't use merge code between 4.6.1 with 4.6.4, and i uesed by 4.6.1 always 09-7-31 diyanliang 

//code version 2.6.4 start
var FCKUndo={};FCKUndo.SavedData=[];FCKUndo.CurrentIndex=-1;FCKUndo.TypesCount=0;FCKUndo.Changed=false;FCKUndo.MaxTypes=25;FCKUndo.Typing=false;FCKUndo.SaveLocked=false;FCKUndo._GetBookmark=function(){FCKSelection.Restore();var A=new FCKDomRange(FCK.EditorWindow);try{A.MoveToSelection();}catch (e){return null;};if (FCKBrowserInfo.IsIE){var B=A.CreateBookmark();var C=FCK.EditorDocument.body.innerHTML;A.MoveToBookmark(B);return [B,C];};return A.CreateBookmark2();};FCKUndo._SelectBookmark=function(A){if (!A) return;var B=new FCKDomRange(FCK.EditorWindow);if (A instanceof Object){if (FCKBrowserInfo.IsIE) B.MoveToBookmark(A[0]);else B.MoveToBookmark2(A);try{B.Select();}catch (e){B.MoveToPosition(FCK.EditorDocument.body,4);B.Select();}}};FCKUndo._CompareCursors=function(A,B){for (var i=0;i<Math.min(A.length,B.length);i++){if (A[i]<B[i]) return-1;else if (A[i]>B[i]) return 1;};if (A.length<B.length) return-1;else if (A.length>B.length) return 1;return 0;};FCKUndo._CheckIsBookmarksEqual=function(A,B){if (!(A&&B)) return false;if (FCKBrowserInfo.IsIE){var C=A[1].search(A[0].StartId);var D=B[1].search(B[0].StartId);var E=A[1].search(A[0].EndId);var F=B[1].search(B[0].EndId);return C==D&&E==F;}else{return this._CompareCursors(A.Start,B.Start)==0&&this._CompareCursors(A.End,B.End)==0;}};FCKUndo.SaveUndoStep=function(){if (FCK.EditMode!=0||this.SaveLocked) return;if (this.SavedData.length) this.Changed=true;var A=FCK.EditorDocument.body.innerHTML;var B=this._GetBookmark();this.SavedData=this.SavedData.slice(0,this.CurrentIndex+1);if (this.CurrentIndex>0&&A==this.SavedData[this.CurrentIndex][0]&&this._CheckIsBookmarksEqual(B,this.SavedData[this.CurrentIndex][1])) return;else if (this.CurrentIndex==0&&this.SavedData.length&&A==this.SavedData[0][0]){this.SavedData[0][1]=B;return;};if (this.CurrentIndex+1>=FCKConfig.MaxUndoLevels) this.SavedData.shift();else this.CurrentIndex++;this.SavedData[this.CurrentIndex]=[A,B];FCK.Events.FireEvent("OnSelectionChange");};FCKUndo.CheckUndoState=function(){return (this.Changed||this.CurrentIndex>0);};FCKUndo.CheckRedoState=function(){return (this.CurrentIndex<(this.SavedData.length-1));};FCKUndo.Undo=function(){if (this.CheckUndoState()){if (this.CurrentIndex==(this.SavedData.length-1)){this.SaveUndoStep();};this._ApplyUndoLevel(--this.CurrentIndex);FCK.Events.FireEvent("OnSelectionChange");}};FCKUndo.Redo=function(){if (this.CheckRedoState()){this._ApplyUndoLevel(++this.CurrentIndex);FCK.Events.FireEvent("OnSelectionChange");}};FCKUndo._ApplyUndoLevel=function(A){var B=this.SavedData[A];if (!B) return;if (FCKBrowserInfo.IsIE){if (B[1]&&B[1][1]) FCK.SetInnerHtml(B[1][1]);else FCK.SetInnerHtml(B[0]);}else FCK.EditorDocument.body.innerHTML=B[0];this._SelectBookmark(B[1]);this.TypesCount=0;this.Changed=false;this.Typing=false;};
var FCKEditingArea=function(A){this.TargetElement=A;this.Mode=0;if (FCK.IECleanup) FCK.IECleanup.AddItem(this,FCKEditingArea_Cleanup);};FCKEditingArea.prototype.Start=function(A,B){var C=this.TargetElement;var D=FCKTools.GetElementDocument(C);while(C.firstChild) C.removeChild(C.firstChild);if (this.Mode==0){if (FCK_IS_CUSTOM_DOMAIN) A='<script>document.domain="'+FCK_RUNTIME_DOMAIN+'";</script>'+A;if (FCKBrowserInfo.IsIE) A=A.replace(/(<base[^>]*?)\s*\/?>(?!\s*<\/base>)/gi,'$1></base>');else if (!B){var E=A.match(FCKRegexLib.BeforeBody);var F=A.match(FCKRegexLib.AfterBody);if (E&&F){var G=A.substr(E[1].length,A.length-E[1].length-F[1].length);A=E[1]+'&nbsp;'+F[1];if (FCKBrowserInfo.IsGecko&&(G.length==0||FCKRegexLib.EmptyParagraph.test(G))) G='<br type="_moz">';this._BodyHTML=G;}else this._BodyHTML=A;};var H=this.IFrame=D.createElement('iframe');var I='<script type="text/javascript" _fcktemp="true">window.onerror=function(){return true;};</script>';H.frameBorder=0;H.style.width=H.style.height='100%';if (FCK_IS_CUSTOM_DOMAIN&&FCKBrowserInfo.IsIE){window._FCKHtmlToLoad=A.replace(/<head>/i,'<head>'+I);H.src='javascript:void( (function(){document.open() ;document.domain="'+document.domain+'" ;document.write( window.parent._FCKHtmlToLoad );document.close() ;window.parent._FCKHtmlToLoad = null ;})() )';}else if (!FCKBrowserInfo.IsGecko){H.src='javascript:void(0)';};C.appendChild(H);this.Window=H.contentWindow;if (!FCK_IS_CUSTOM_DOMAIN||!FCKBrowserInfo.IsIE){var J=this.Window.document;J.open();J.write(A.replace(/<head>/i,'<head>'+I));J.close();};if (FCKBrowserInfo.IsAIR) FCKAdobeAIR.EditingArea_Start(J,A);if (FCKBrowserInfo.IsGecko10&&!B){this.Start(A,true);return;};if (H.readyState&&H.readyState!='completed'){var K=this;setTimeout(function(){try{K.Window.document.documentElement.doScroll("left");}catch(e){setTimeout(arguments.callee,0);return;};K.Window._FCKEditingArea=K;FCKEditingArea_CompleteStart.call(K.Window);},0);}else{this.Window._FCKEditingArea=this;if (FCKBrowserInfo.IsGecko10) this.Window.setTimeout(FCKEditingArea_CompleteStart,500);else FCKEditingArea_CompleteStart.call(this.Window);}}else{var L=this.Textarea=D.createElement('textarea');L.className='SourceField';L.dir='ltr';FCKDomTools.SetElementStyles(L,{width:'100%',height:'100%',border:'none',resize:'none',outline:'none'});C.appendChild(L);L.value=A;FCKTools.RunFunction(this.OnLoad);}};function FCKEditingArea_CompleteStart(){if (!this.document.body){this.setTimeout(FCKEditingArea_CompleteStart,50);return;};var A=this._FCKEditingArea;A.Document=A.Window.document;A.MakeEditable();FCKTools.RunFunction(A.OnLoad);};FCKEditingArea.prototype.MakeEditable=function(){var A=this.Document;if (FCKBrowserInfo.IsIE){A.body.id=(!FCKConfig.ducklingbodyid)?"fckcontentbody":FCKConfig.ducklingbodyid;A.body.disabled=true;A.body.contentEditable=true;A.body.removeAttribute("disabled");}else{try{A.body.spellcheck=(this.FFSpellChecker!==false);if (this._BodyHTML){A.body.innerHTML=this._BodyHTML;A.body.offsetLeft;this._BodyHTML=null;};A.designMode='on';A.execCommand('enableObjectResizing',false,!FCKConfig.DisableObjectResizing);A.execCommand('enableInlineTableEditing',false,!FCKConfig.DisableFFTableHandles);}catch (e){FCKTools.AddEventListener(this.Window.frameElement,'DOMAttrModified',FCKEditingArea_Document_AttributeNodeModified);}}};function FCKEditingArea_Document_AttributeNodeModified(A){var B=A.currentTarget.contentWindow._FCKEditingArea;if (B._timer) window.clearTimeout(B._timer);B._timer=FCKTools.SetTimeout(FCKEditingArea_MakeEditableByMutation,1000,B);};function FCKEditingArea_MakeEditableByMutation(){delete this._timer;FCKTools.RemoveEventListener(this.Window.frameElement,'DOMAttrModified',FCKEditingArea_Document_AttributeNodeModified);this.MakeEditable();};FCKEditingArea.prototype.Focus=function(){try{if (this.Mode==0){if (FCKBrowserInfo.IsIE) this._FocusIE();else this.Window.focus();}else{var A=FCKTools.GetElementDocument(this.Textarea);if ((!A.hasFocus||A.hasFocus())&&A.activeElement==this.Textarea) return;this.Textarea.focus();}}catch(e) {}};FCKEditingArea.prototype._FocusIE=function(){this.Document.body.setActive();this.Window.focus();var A=this.Document.selection.createRange();var B=A.parentElement();var C=B.nodeName.toLowerCase();if (B.childNodes.length>0||!(FCKListsLib.BlockElements[C]||FCKListsLib.NonEmptyBlockElements[C])){return;};A=new FCKDomRange(this.Window);A.MoveToElementEditStart(B);A.Select();};function FCKEditingArea_Cleanup(){if (this.Document) this.Document.body.innerHTML="";this.TargetElement=null;this.IFrame=null;this.Document=null;this.Textarea=null;if (this.Window){this.Window._FCKEditingArea=null;this.Window=null;}};
var FCKKeystrokeHandler=function(A){this.Keystrokes={};this.CancelCtrlDefaults=(A!==false);};FCKKeystrokeHandler.prototype.AttachToElement=function(A){FCKTools.AddEventListenerEx(A,'keydown',_FCKKeystrokeHandler_OnKeyDown,this);if (FCKBrowserInfo.IsGecko10||FCKBrowserInfo.IsOpera||(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac)) FCKTools.AddEventListenerEx(A,'keypress',_FCKKeystrokeHandler_OnKeyPress,this);};FCKKeystrokeHandler.prototype.SetKeystrokes=function(){for (var i=0;i<arguments.length;i++){var A=arguments[i];if (!A) continue;if (typeof(A[0])=='object') this.SetKeystrokes.apply(this,A);else{if (A.length==1) delete this.Keystrokes[A[0]];else this.Keystrokes[A[0]]=A[1]===true?true:A;}}};function _FCKKeystrokeHandler_OnKeyDown(A,B){var C=A.keyCode||A.which;var D=0;if (A.ctrlKey||A.metaKey) D+=CTRL;if (A.shiftKey) D+=SHIFT;if (A.altKey) D+=ALT;var E=C+D;var F=B._CancelIt=false;var G=B.Keystrokes[E];if (G){if (G===true||!(B.OnKeystroke&&B.OnKeystroke.apply(B,G))) return true;F=true;};if (F||(B.CancelCtrlDefaults&&D==CTRL&&(C<33||C>40))){B._CancelIt=true;if (A.preventDefault) return A.preventDefault();A.returnValue=false;A.cancelBubble=true;return false;};return true;};function _FCKKeystrokeHandler_OnKeyPress(A,B){if (B._CancelIt){if (A.preventDefault) return A.preventDefault();return false;};return true;};
FCK.DTD=(function(){var X=FCKTools.Merge;var A,L,J,M,N,O,D,H,P,K,Q,F,G,C,B,E,I;A={isindex:1,fieldset:1};B={input:1,button:1,select:1,textarea:1,label:1};C=X({a:1},B);D=X({iframe:1},C);E={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1};F={ins:1,del:1,script:1};G=X({b:1,acronym:1,bdo:1,'var':1,'#':1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},F);H=X({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},G);I=X({p:1},H);J=X({iframe:1},H,B);K={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,'#':1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,'var':1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};L=X({a:1},J);M={tr:1};N={'#':1};O=X({param:1},K);P=X({form:1},A,D,E,I);Q={li:1};return {col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:P,td:P,br:{},th:P,center:P,kbd:L,button:X(I,E),basefont:{},h5:L,h4:L,samp:L,h6:L,ol:Q,h1:L,h3:L,option:N,h2:L,form:X(A,D,E,I),select:{optgroup:1,option:1},font:J,ins:P,menu:Q,abbr:L,label:L,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:L,script:N,tfoot:M,cite:L,li:P,input:{},iframe:P,strong:J,textarea:N,noframes:P,big:J,small:J,span:J,hr:{},dt:L,sub:J,optgroup:{option:1},param:{},bdo:L,'var':J,div:P,object:O,sup:J,dd:P,strike:J,area:{},dir:Q,map:X({area:1,form:1,p:1},A,F,E),applet:O,dl:{dt:1,dd:1},del:P,isindex:{},fieldset:X({legend:1},K),thead:M,ul:Q,acronym:L,b:J,a:J,blockquote:P,caption:L,i:J,u:J,tbody:M,s:L,address:X(D,I),tt:J,legend:L,q:L,pre:X(G,C),p:L,em:J,dfn:L};})();
var FCKStyle=function(A){this.Element=(A.Element||'span').toLowerCase();this._StyleDesc=A;};FCKStyle.prototype={GetType:function(){var A=this.GetType_$;if (A!=undefined) return A;var B=this.Element;if (B=='#'||FCKListsLib.StyleBlockElements[B]) A=0;else if (FCKListsLib.StyleObjectElements[B]) A=2;else A=1;return (this.GetType_$=A);},ApplyToSelection:function(A){var B=new FCKDomRange(A);B.MoveToSelection();this.ApplyToRange(B,true);},ApplyToRange:function(A,B,C){switch (this.GetType()){case 0:this.ApplyToRange=this._ApplyBlockStyle;break;case 1:this.ApplyToRange=this._ApplyInlineStyle;break;default:return;};this.ApplyToRange(A,B,C);},ApplyToObject:function(A){if (!A) return;this.BuildElement(null,A);},RemoveFromSelection:function(A){var B=new FCKDomRange(A);B.MoveToSelection();this.RemoveFromRange(B,true);},RemoveFromRange:function(A,B,C){var D;var E=this._GetAttribsForComparison();var F=this._GetOverridesForComparison();if (A.CheckIsCollapsed()){var D=A.CreateBookmark(true);var H=A.GetBookmarkNode(D,true);var I=new FCKElementPath(H.parentNode);var J=[];var K=!FCKDomTools.GetNextSibling(H);var L=K||!FCKDomTools.GetPreviousSibling(H);var M;var N=-1;for (var i=0;i<I.Elements.length;i++){var O=I.Elements[i];if (this.CheckElementRemovable(O)){if (L&&!FCKDomTools.CheckIsEmptyElement(O,function(el){return (el!=H);})){M=O;N=J.length-1;}else{var P=O.nodeName.toLowerCase();if (P==this.Element){for (var Q in E){if (FCKDomTools.HasAttribute(O,Q)){switch (Q){case 'style':this._RemoveStylesFromElement(O);break;case 'class':if (FCKDomTools.GetAttributeValue(O,Q)!=this.GetFinalAttributeValue(Q)) continue;default:FCKDomTools.RemoveAttribute(O,Q);}}}};this._RemoveOverrides(O,F[P]);if (this.GetType()==1) this._RemoveNoAttribElement(O);}}else if (L) J.push(O);L=L&&((K&&!FCKDomTools.GetNextSibling(O))||(!K&&!FCKDomTools.GetPreviousSibling(O)));if (M&&(!L||(i==I.Elements.length-1))){var R=FCKDomTools.RemoveNode(H);for (var j=0;j<=N;j++){var S=FCKDomTools.CloneElement(J[j]);S.appendChild(R);R=S;};if (K) FCKDomTools.InsertAfterNode(M,R);else M.parentNode.insertBefore(R,M);L=false;M=null;}};if (B) A.SelectBookmark(D);if (C) A.MoveToBookmark(D);return;};A.Expand('inline_elements');D=A.CreateBookmark(true);var T=A.GetBookmarkNode(D,true);var U=A.GetBookmarkNode(D,false);A.Release(true);var I=new FCKElementPath(T);var X=I.Elements;var O;for (var i=1;i<X.length;i++){O=X[i];if (O==I.Block||O==I.BlockLimit) break;if (this.CheckElementRemovable(O)) FCKDomTools.BreakParent(T,O,A);};I=new FCKElementPath(U);X=I.Elements;for (var i=1;i<X.length;i++){O=X[i];if (O==I.Block||O==I.BlockLimit) break;b=O.nodeName.toLowerCase();if (this.CheckElementRemovable(O)) FCKDomTools.BreakParent(U,O,A);};var Z=FCKDomTools.GetNextSourceNode(T,true);while (Z){var a=FCKDomTools.GetNextSourceNode(Z);if (Z.nodeType==1){var b=Z.nodeName.toLowerCase();var c=(b==this.Element);if (c){for (var Q in E){if (FCKDomTools.HasAttribute(Z,Q)){switch (Q){case 'style':this._RemoveStylesFromElement(Z);break;case 'class':if (FCKDomTools.GetAttributeValue(Z,Q)!=this.GetFinalAttributeValue(Q)) continue;default:FCKDomTools.RemoveAttribute(Z,Q);}}}}else c=!!F[b];if (c){this._RemoveOverrides(Z,F[b]);this._RemoveNoAttribElement(Z);}};if (a==U) break;Z=a;};this._FixBookmarkStart(T);if (B) A.SelectBookmark(D);if (C) A.MoveToBookmark(D);},CheckElementRemovable:function(A,B){if (!A) return false;var C=A.nodeName.toLowerCase();if (C==this.Element){if (!B&&!FCKDomTools.HasAttributes(A)) return true;var D=this._GetAttribsForComparison();var E=(D._length==0);for (var F in D){if (F=='_length') continue;if (this._CompareAttributeValues(F,FCKDomTools.GetAttributeValue(A,F),(this.GetFinalAttributeValue(F)||''))){E=true;if (!B) break;}else{E=false;if (B) return false;}};if (E) return true;};var G=this._GetOverridesForComparison()[C];if (G){if (!(D=G.Attributes)) return true;for (var i=0;i<D.length;i++){var H=D[i][0];if (FCKDomTools.HasAttribute(A,H)){var I=D[i][1];if (I==null||(typeof I=='string'&&FCKDomTools.GetAttributeValue(A,H)==I)||I.test(FCKDomTools.GetAttributeValue(A,H))) return true;}}};return false;},CheckActive:function(A){switch (this.GetType()){case 0:return this.CheckElementRemovable(A.Block||A.BlockLimit,true);case 1:var B=A.Elements;for (var i=0;i<B.length;i++){var C=B[i];if (C==A.Block||C==A.BlockLimit) continue;if (this.CheckElementRemovable(C,true)) return true;}};return false;},RemoveFromElement:function(A){var B=this._GetAttribsForComparison();var C=this._GetOverridesForComparison();var D=A.getElementsByTagName(this.Element);for (var i=D.length-1;i>=0;i--){var E=D[i];for (var F in B){if (FCKDomTools.HasAttribute(E,F)){switch (F){case 'style':this._RemoveStylesFromElement(E);break;case 'class':if (FCKDomTools.GetAttributeValue(E,F)!=this.GetFinalAttributeValue(F)) continue;default:FCKDomTools.RemoveAttribute(E,F);}}};this._RemoveOverrides(E,C[this.Element]);this._RemoveNoAttribElement(E);};for (var G in C){if (G!=this.Element){D=A.getElementsByTagName(G);for (var i=D.length-1;i>=0;i--){var E=D[i];this._RemoveOverrides(E,C[G]);this._RemoveNoAttribElement(E);}}}},_RemoveStylesFromElement:function(A){var B=A.style.cssText;var C=this.GetFinalStyleValue();if (B.length>0&&C.length==0) return;C='(^|;)\\s*('+C.replace(/\s*([^ ]+):.*?(;|$)/g,'$1|').replace(/\|$/,'')+'):[^;]+';var D=new RegExp(C,'gi');B=B.replace(D,'').Trim();if (B.length==0||B==';') FCKDomTools.RemoveAttribute(A,'style');else A.style.cssText=B.replace(D,'');},_RemoveOverrides:function(A,B){var C=B&&B.Attributes;if (C){for (var i=0;i<C.length;i++){var D=C[i][0];if (FCKDomTools.HasAttribute(A,D)){var E=C[i][1];if (E==null||(E.test&&E.test(FCKDomTools.GetAttributeValue(A,D)))||(typeof E=='string'&&FCKDomTools.GetAttributeValue(A,D)==E)) FCKDomTools.RemoveAttribute(A,D);}}}},_RemoveNoAttribElement:function(A){if (!FCKDomTools.HasAttributes(A)){var B=A.firstChild;var C=A.lastChild;FCKDomTools.RemoveNode(A,true);this._MergeSiblings(B);if (B!=C) this._MergeSiblings(C);}},BuildElement:function(A,B){var C=B||A.createElement(this.Element);var D=this._StyleDesc.Attributes;var E;if (D){for (var F in D){E=this.GetFinalAttributeValue(F);if (F.toLowerCase()=='class') C.className=E;else C.setAttribute(F,E);}};if (this._GetStyleText().length>0) C.style.cssText=this.GetFinalStyleValue();return C;},_CompareAttributeValues:function(A,B,C){if (A=='style'&&B&&C){B=B.replace(/;$/,'').toLowerCase();C=C.replace(/;$/,'').toLowerCase();};return (B==C||((B===null||B==='')&&(C===null||C==='')))},GetFinalAttributeValue:function(A){var B=this._StyleDesc.Attributes;var B=B?B[A]:null;if (!B&&A=='style') return this.GetFinalStyleValue();if (B&&this._Variables) B=B.Replace(FCKRegexLib.StyleVariableAttName,this._GetVariableReplace,this);return B;},GetFinalStyleValue:function(){var A=this._GetStyleText();if (A.length>0&&this._Variables){A=A.Replace(FCKRegexLib.StyleVariableAttName,this._GetVariableReplace,this);A=FCKTools.NormalizeCssText(A);};return A;},_GetVariableReplace:function(){return this._Variables[arguments[2]]||arguments[0];},SetVariable:function(A,B){var C=this._Variables;if (!C) C=this._Variables={};this._Variables[A]=B;},_FromPre:function(A,B,C){var D=B.innerHTML;D=D.replace(/(\r\n|\r)/g,'\n');D=D.replace(/^[ \t]*\n/,'');D=D.replace(/\n$/,'');D=D.replace(/^[ \t]+|[ \t]+$/g,function(match,offset,s){if (match.length==1) return '&nbsp;';else if (offset==0) return new Array(match.length).join('&nbsp;')+' ';else return ' '+new Array(match.length).join('&nbsp;');});var E=new FCKHtmlIterator(D);var F=[];E.Each(function(isTag,value){if (!isTag){value=value.replace(/\n/g,'<br>');value=value.replace(/[ \t]{2,}/g,function (match){return new Array(match.length).join('&nbsp;')+' ';});};F.push(value);});C.innerHTML=F.join('');return C;},_ToPre:function(A,B,C){var D=B.innerHTML.Trim();D=D.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,'<br />');var E=new FCKHtmlIterator(D);var F=[];E.Each(function(isTag,value){if (!isTag) value=value.replace(/([ \t\n\r]+|&nbsp;)/g,' ');else if (isTag&&value=='<br />') value='\n';F.push(value);});if (FCKBrowserInfo.IsIE){var G=A.createElement('div');G.appendChild(C);C.outerHTML='<pre>\n'+F.join('')+'</pre>';C=G.removeChild(G.firstChild);}else C.innerHTML=F.join('');return C;},_CheckAndMergePre:function(A,B){if (A!=FCKDomTools.GetPreviousSourceElement(B,true)) return;var C=A.innerHTML.replace(/\n$/,'')+'\n\n'+B.innerHTML.replace(/^\n/,'');if (FCKBrowserInfo.IsIE) B.outerHTML='<pre>'+C+'</pre>';else B.innerHTML=C;FCKDomTools.RemoveNode(A);},_CheckAndSplitPre:function(A){var B;var C=A.firstChild;C=C&&C.nextSibling;while (C){var D=C.nextSibling;if (D&&D.nextSibling&&C.nodeName.IEquals('br')&&D.nodeName.IEquals('br')){FCKDomTools.RemoveNode(C);C=D.nextSibling;FCKDomTools.RemoveNode(D);B=FCKDomTools.InsertAfterNode(B||A,FCKDomTools.CloneElement(A));continue;};if (B){C=C.previousSibling;FCKDomTools.MoveNode(C.nextSibling,B);};C=C.nextSibling;}},_ApplyBlockStyle:function(A,B,C){var D;if (B) D=A.CreateBookmark();var E=new FCKDomRangeIterator(A);E.EnforceRealBlocks=true;var F;var G=A.Window.document;var H;while((F=E.GetNextParagraph())){var I=this.BuildElement(G);var J=I.nodeName.IEquals('pre');var K=F.nodeName.IEquals('pre');var L=J&&!K;var M=!J&&K;if (L) I=this._ToPre(G,F,I);else if (M) I=this._FromPre(G,F,I);else FCKDomTools.MoveChildren(F,I);F.parentNode.insertBefore(I,F);FCKDomTools.RemoveNode(F);if (J){if (H) this._CheckAndMergePre(H,I);H=I;}else if (M) this._CheckAndSplitPre(I);};if (B) A.SelectBookmark(D);if (C) A.MoveToBookmark(D);},_ApplyInlineStyle:function(A,B,C){var D=A.Window.document;if (A.CheckIsCollapsed()){var E=this.BuildElement(D);A.InsertNode(E);A.MoveToPosition(E,2);A.Select();return;};var F=this.Element;var G=FCK.DTD[F]||FCK.DTD.span;var H=this._GetAttribsForComparison();var I;A.Expand('inline_elements');var J=A.CreateBookmark(true);var K=A.GetBookmarkNode(J,true);var L=A.GetBookmarkNode(J,false);A.Release(true);var M=FCKDomTools.GetNextSourceNode(K,true);while (M){var N=false;var O=M.nodeType;var P=O==1?M.nodeName.toLowerCase():null;if (!P||G[P]){if ((FCK.DTD[M.parentNode.nodeName.toLowerCase()]||FCK.DTD.span)[F]||!FCK.DTD[F]){if (!A.CheckHasRange()) A.SetStart(M,3);if (O!=1||M.childNodes.length==0){var Q=M;var R=Q.parentNode;while (Q==R.lastChild&&G[R.nodeName.toLowerCase()]){Q=R;};A.SetEnd(Q,4);if (Q==Q.parentNode.lastChild&&!G[Q.parentNode.nodeName.toLowerCase()]) N=true;}else{A.SetEnd(M,3);}}else N=true;}else N=true;M=FCKDomTools.GetNextSourceNode(M);if (M==L){M=null;N=true;};if (N&&A.CheckHasRange()&&!A.CheckIsCollapsed()){I=this.BuildElement(D);A.ExtractContents().AppendTo(I);if (I.innerHTML.RTrim().length>0){A.InsertNode(I);this.RemoveFromElement(I);this._MergeSiblings(I,this._GetAttribsForComparison());if (!FCKBrowserInfo.IsIE) I.normalize();};A.Release(true);}};this._FixBookmarkStart(K);if (B) A.SelectBookmark(J);if (C) A.MoveToBookmark(J);},_FixBookmarkStart:function(A){var B;while ((B=A.nextSibling)){if (B.nodeType==1&&FCKListsLib.InlineNonEmptyElements[B.nodeName.toLowerCase()]){if (!B.firstChild) FCKDomTools.RemoveNode(B);else FCKDomTools.MoveNode(A,B,true);continue;};if (B.nodeType==3&&B.length==0){FCKDomTools.RemoveNode(B);continue;};break;}},_MergeSiblings:function(A,B){if (!A||A.nodeType!=1||!FCKListsLib.InlineNonEmptyElements[A.nodeName.toLowerCase()]) return;this._MergeNextSibling(A,B);this._MergePreviousSibling(A,B);},_MergeNextSibling:function(A,B){var C=A.nextSibling;var D=(C&&C.nodeType==1&&C.getAttribute('_fck_bookmark'));if (D) C=C.nextSibling;if (C&&C.nodeType==1&&C.nodeName==A.nodeName){if (!B) B=this._CreateElementAttribsForComparison(A);if (this._CheckAttributesMatch(C,B)){var E=A.lastChild;if (D) FCKDomTools.MoveNode(A.nextSibling,A);FCKDomTools.MoveChildren(C,A);FCKDomTools.RemoveNode(C);if (E) this._MergeNextSibling(E);}}},_MergePreviousSibling:function(A,B){var C=A.previousSibling;var D=(C&&C.nodeType==1&&C.getAttribute('_fck_bookmark'));if (D) C=C.previousSibling;if (C&&C.nodeType==1&&C.nodeName==A.nodeName){if (!B) B=this._CreateElementAttribsForComparison(A);if (this._CheckAttributesMatch(C,B)){var E=A.firstChild;if (D) FCKDomTools.MoveNode(A.previousSibling,A,true);FCKDomTools.MoveChildren(C,A,true);FCKDomTools.RemoveNode(C);if (E) this._MergePreviousSibling(E);}}},_GetStyleText:function(){var A=this._StyleDesc.Styles;var B=(this._StyleDesc.Attributes?this._StyleDesc.Attributes['style']||'':'');if (B.length>0) B+=';';for (var C in A) B+=C+':'+A[C]+';';if (B.length>0&&!(/#\(/.test(B))){B=FCKTools.NormalizeCssText(B);};return (this._GetStyleText=function() { return B;})();},_GetAttribsForComparison:function(){var A=this._GetAttribsForComparison_$;if (A) return A;A={};var B=this._StyleDesc.Attributes;if (B){for (var C in B){A[C.toLowerCase()]=B[C].toLowerCase();}};if (this._GetStyleText().length>0){A['style']=this._GetStyleText().toLowerCase();};FCKTools.AppendLengthProperty(A,'_length');return (this._GetAttribsForComparison_$=A);},_GetOverridesForComparison:function(){var A=this._GetOverridesForComparison_$;if (A) return A;A={};var B=this._StyleDesc.Overrides;if (B){if (!FCKTools.IsArray(B)) B=[B];for (var i=0;i<B.length;i++){var C=B[i];var D;var E;var F;if (typeof C=='string') D=C.toLowerCase();else{D=C.Element?C.Element.toLowerCase():this.Element;F=C.Attributes;};E=A[D]||(A[D]={});if (F){var G=(E.Attributes=E.Attributes||[]);for (var H in F){G.push([H.toLowerCase(),F[H]]);}}}};return (this._GetOverridesForComparison_$=A);},_CreateElementAttribsForComparison:function(A){var B={};var C=0;for (var i=0;i<A.attributes.length;i++){var D=A.attributes[i];if (D.specified){B[D.nodeName.toLowerCase()]=FCKDomTools.GetAttributeValue(A,D).toLowerCase();C++;}};B._length=C;return B;},_CheckAttributesMatch:function(A,B){var C=A.attributes;var D=0;for (var i=0;i<C.length;i++){var E=C[i];if (E.specified){var F=E.nodeName.toLowerCase();var G=B[F];if (!G) break;if (G!=FCKDomTools.GetAttributeValue(A,E).toLowerCase()) break;D++;}};return (D==B._length);}};
var FCKStyles=FCK.Styles={_Callbacks:{},_ObjectStyles:{},ApplyStyle:function(a){if(typeof a=="string"){a=this.GetStyles()[a]}if(a){if(a.GetType()==FCK_STYLE_OBJECT){a.ApplyToObject(FCKSelection.GetSelectedElement())}else{a.ApplyToSelection(FCK.EditorWindow)}FCK.Events.FireEvent("OnSelectionChange")}},RemoveStyle:function(a){if(typeof a=="string"){a=this.GetStyles()[a]}if(a){a.RemoveFromSelection(FCK.EditorWindow);FCK.Events.FireEvent("OnSelectionChange")}},AttachStyleStateChange:function(a,d,c){var b=this._Callbacks[a];if(!b){b=this._Callbacks[a]=[]}b.push([d,c])},CheckSelectionChanges:function(){var g=FCKSelection.GetBoundaryParentElement(true);if(!g){return}var k=new FCKElementPath(g);var j=this.GetStyles();for(var d in j){var f=this._Callbacks[d];if(f){var b=j[d];var a=b.CheckActive(k);if(a!=(b._LastState||null)){b._LastState=a;for(var e=0;e<f.length;e++){var h=f[e][0];var c=f[e][1];h.call(c||window,d,a)}}}}},CheckStyleInSelection:function(a){return false},_GetRemoveFormatTagsRegex:function(){var a=new RegExp("^(?:"+FCKConfig.RemoveFormatTags.replace(/,/g,"|")+")$","i");return(this._GetRemoveFormatTagsRegex=function(){return a})&&a},RemoveAll:function(){var g=new FCKDomRange(FCK.EditorWindow);g.MoveToSelection();if(g.CheckIsCollapsed()){return}g.Expand("inline_elements");var k=g.CreateBookmark(true);var c=g.GetBookmarkNode(k,true);var h=g.GetBookmarkNode(k,false);g.Release(true);var j=this._GetRemoveFormatTagsRegex();var l=new FCKElementPath(c);var e=l.Elements;var b;for(var f=1;f<e.length;f++){b=e[f];if(b==l.Block||b==l.BlockLimit){break}if(j.test(b.nodeName)){FCKDomTools.BreakParent(c,b,g)}}l=new FCKElementPath(h);e=l.Elements;for(var f=1;f<e.length;f++){b=e[f];if(b==l.Block||b==l.BlockLimit){break}elementName=b.nodeName.toLowerCase();if(j.test(b.nodeName)){FCKDomTools.BreakParent(h,b,g)}}var a=FCKDomTools.GetNextSourceNode(c,true,1);while(a){if(a==h){break}var d=FCKDomTools.GetNextSourceNode(a,false,1);if(j.test(a.nodeName)){FCKDomTools.RemoveNode(a,true)}else{FCKDomTools.RemoveAttributes(a,FCKConfig.RemoveAttributesArray)}a=d}g.SelectBookmark(k);FCK.Events.FireEvent("OnSelectionChange")},GetStyle:function(a){return this.GetStyles()[a]},GetStyles:function(){var a=this._GetStyles;if(!a){a=this._GetStyles=FCKTools.Merge(this._LoadStylesCore(),this._LoadStylesCustom(),this._LoadStylesXml())}return a},CheckHasObjectStyle:function(a){return !!this._ObjectStyles[a]},_LoadStylesCore:function(){var d={};var a=FCKConfig.CoreStyles;for(var b in a){var c=d["_FCK_"+b]=new FCKStyle(a[b]);c.IsCore=true}return d},_LoadStylesCustom:function(){var d={};var a=FCKConfig.CustomStyles;if(a){for(var b in a){var c=d[b]=new FCKStyle(a[b]);c.Name=b}}return d},_LoadStylesXml:function(){var m={};var f=FCKConfig.StylesXmlPath;if(!f||f.length==0){return m}var e=new FCKXml();e.LoadUrl(f);var q=FCKXml.TransformToObject(e.SelectSingleNode("Styles"));var o=q.$Style;if(!o){return m}for(var u=0;u<o.length;u++){var w=o[u];var b=(w.element||"").toLowerCase();if(b.length==0){throw ('The element name is required. Error loading "'+f+'"')}var h={Element:b,Attributes:{},Styles:{},Overrides:[]};var c=w.$Attribute||[];for(var t=0;t<c.length;t++){h.Attributes[c[t].name]=c[t].value}var s=w.$Style||[];for(t=0;t<s.length;t++){h.Styles[s[t].name]=s[t].value}var l=w.$Override;if(l){for(t=0;t<l.length;t++){var g=l[t];var p={Element:g.element};var a=g.$Attribute;if(a){p.Attributes={};for(var r=0;r<a.length;r++){var d=a[r].value||null;if(d){var n=d&&FCKRegexLib.RegExp.exec(d);if(n){d=new RegExp(n[1],n[2]||"")}}p.Attributes[a[r].name]=d}}h.Overrides.push(p)}}var v=new FCKStyle(h);v.Name=w.name||b;if(v.GetType()==FCK_STYLE_OBJECT){this._ObjectStyles[b]=true}m[v.Name]=v}return m}};
var FCKListHandler={OutdentListItem:function(A){var B=A.parentNode;if (B.tagName.toUpperCase().Equals('UL','OL')){var C=FCKTools.GetElementDocument(A);var D=new FCKDocumentFragment(C);var E=D.RootNode;var F=false;var G=FCKDomTools.GetFirstChild(A,['UL','OL']);if (G){F=true;var H;while ((H=G.firstChild)) E.appendChild(G.removeChild(H));FCKDomTools.RemoveNode(G);};var I;var J=false;while ((I=A.nextSibling)){if (!F&&I.nodeType==1&&I.nodeName.toUpperCase()=='LI') J=F=true;E.appendChild(I.parentNode.removeChild(I));if (!J&&I.nodeType==1&&I.nodeName.toUpperCase().Equals('UL','OL')) FCKDomTools.RemoveNode(I,true);};var K=B.parentNode.tagName.toUpperCase();var L=(K=='LI');if (L||K.Equals('UL','OL')){if (F){var G=B.cloneNode(false);D.AppendTo(G);A.appendChild(G);}else if (L) D.InsertAfterNode(B.parentNode);else D.InsertAfterNode(B);if (L) FCKDomTools.InsertAfterNode(B.parentNode,B.removeChild(A));else FCKDomTools.InsertAfterNode(B,B.removeChild(A));}else{if (F){var N=B.cloneNode(false);D.AppendTo(N);FCKDomTools.InsertAfterNode(B,N);};var O=C.createElement(FCKConfig.EnterMode=='p'?'p':'div');FCKDomTools.MoveChildren(B.removeChild(A),O);FCKDomTools.InsertAfterNode(B,O);if (FCKConfig.EnterMode=='br'){if (FCKBrowserInfo.IsGecko) O.parentNode.insertBefore(FCKTools.CreateBogusBR(C),O);else FCKDomTools.InsertAfterNode(O,FCKTools.CreateBogusBR(C));FCKDomTools.RemoveNode(O,true);}};if (this.CheckEmptyList(B)) FCKDomTools.RemoveNode(B,true);}},CheckEmptyList:function(A){return (FCKDomTools.GetFirstChild(A,'LI')==null);},CheckListHasContents:function(A){var B=A.firstChild;while (B){switch (B.nodeType){case 1:if (!B.nodeName.IEquals('UL','LI')) return true;break;case 3:if (B.nodeValue.Trim().length>0) return true;};B=B.nextSibling;};return false;}};
var FCKElementPath=function(d){var a=null;var c=null;var g=new Array();var f=d;while(f){if(f.nodeType==1){if(!this.LastElement){this.LastElement=f}var b=f.nodeName.toLowerCase();if(!FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsIE&&f.scopeName&&f.scopeName!="HTML"){b=f.scopeName.toLowerCase()+":"+b}if(!c){if(!a&&FCKListsLib.PathBlockElements[b]!=null){a=f}if(FCKListsLib.PathBlockLimitElements[b]!=null){if(!a&&b=="div"&&!FCKElementPath._CheckHasBlock(f)){a=f}else{c=f}}}g.push(f);if(b=="body"){break}}f=f.parentNode}this.Block=a;this.BlockLimit=c;this.Elements=g};FCKElementPath._CheckHasBlock=function(b){var d=b.childNodes;for(var a=0,c=d.length;a<c;a++){var e=d[a];if(e.nodeType==1&&FCKListsLib.BlockElements[e.nodeName.toLowerCase()]){return true}}return false};
var FCKDomRange=function(a){this.Window=a;this._Cache={}};FCKDomRange.prototype={_UpdateElementInfo:function(){var e=this._Range;if(!e){this.Release(true)}else{var d=e.startContainer;var b=e.endContainer;var c=new FCKElementPath(d);this.StartNode=d.nodeType==3?d:d.childNodes[e.startOffset];this.StartContainer=d;this.StartBlock=c.Block;this.StartBlockLimit=c.BlockLimit;if(d!=b){c=new FCKElementPath(b)}var a=b;if(e.endOffset==0){while(a&&!a.previousSibling){a=a.parentNode}if(a){a=a.previousSibling}}else{if(a.nodeType==1){a=a.childNodes[e.endOffset-1]}}this.EndNode=a;this.EndContainer=b;this.EndBlock=c.Block;this.EndBlockLimit=c.BlockLimit}this._Cache={}},CreateRange:function(){return new FCKW3CRange(this.Window.document)},DeleteContents:function(){if(this._Range){this._Range.deleteContents();this._UpdateElementInfo()}},ExtractContents:function(){if(this._Range){var a=this._Range.extractContents();this._UpdateElementInfo();return a}return null},CheckIsCollapsed:function(){if(this._Range){return this._Range.collapsed}return false},Collapse:function(a){if(this._Range){this._Range.collapse(a)}this._UpdateElementInfo()},Clone:function(){var a=FCKTools.CloneObject(this);if(this._Range){a._Range=this._Range.cloneRange()}return a},MoveToNodeContents:function(a){if(!this._Range){this._Range=this.CreateRange()}this._Range.selectNodeContents(a);this._UpdateElementInfo()},MoveToElementStart:function(a){this.SetStart(a,1);this.SetEnd(a,1)},MoveToElementEditStart:function(a){var b=null;while(a&&a.nodeType==1){if(FCKDomTools.CheckIsEditable(a)){b=a}else{if(b){break}}a=a.firstChild}if(b){this.MoveToElementStart(b)}},InsertNode:function(a){if(this._Range){this._Range.insertNode(a)}},CheckIsEmpty:function(){if(this.CheckIsCollapsed()){return true}var a=this.Window.document.createElement("div");this._Range.cloneContents().AppendTo(a);FCKDomTools.TrimNode(a);return(a.innerHTML.length==0)},CheckStartOfBlock:function(){var d=this._Cache;var c=d.IsStartOfBlock;if(c!=undefined){return c}var g=this.StartBlock||this.StartBlockLimit;var b=this._Range.startContainer;var f=this._Range.startOffset;var e=null;if(f>0){if(b.nodeType==3){var a=b.nodeValue.substr(0,f).Trim();if(a.length!=0){return d.IsStartOfBlock=false}}else{e=b.childNodes[f-1]}}if(!e){e=FCKDomTools.GetPreviousSourceNode(b,true,null,g)}while(e){switch(e.nodeType){case 1:if(!FCKListsLib.InlineChildReqElements[e.nodeName.toLowerCase()]){return d.IsStartOfBlock=false}break;case 3:if(e.nodeValue.Trim().length>0){return d.IsStartOfBlock=false}}e=FCKDomTools.GetPreviousSourceNode(e,false,null,g)}return d.IsStartOfBlock=true},CheckEndOfBlock:function(i){var b=this._Cache.IsEndOfBlock;if(b!=undefined){return b}var d=this.EndBlock||this.EndBlockLimit;var a=this._Range.endContainer;var f=this._Range.endOffset;var c=null;if(a.nodeType==3){var e=a.nodeValue;if(f<e.length){e=e.substr(f);if(e.Trim().length!=0){return this._Cache.IsEndOfBlock=false}}}else{c=a.childNodes[f]}if(!c){c=FCKDomTools.GetNextSourceNode(a,true,null,d)}var g=false;while(c){switch(c.nodeType){case 1:var h=c.nodeName.toLowerCase();if(FCKListsLib.InlineChildReqElements[h]){break}if(h=="br"&&!g){g=true;break}return this._Cache.IsEndOfBlock=false;case 3:if(c.nodeValue.Trim().length>0){return this._Cache.IsEndOfBlock=false}}c=FCKDomTools.GetNextSourceNode(c,false,null,d)}if(i){this.Select()}return this._Cache.IsEndOfBlock=true},CreateBookmark:function(e){var f={StartId:(new Date()).valueOf()+Math.floor(Math.random()*1000)+"S",EndId:(new Date()).valueOf()+Math.floor(Math.random()*1000)+"E"};var b=this.Window.document;var d;var a=null;var c;if(!this.CheckIsCollapsed()){a=b.createElement("span");a.style.display="none";a.id=f.EndId;a.setAttribute("_fck_bookmark",true);a.innerHTML="&nbsp;";c=this.Clone();c.Collapse(false);c.InsertNode(a)}d=b.createElement("span");d.style.display="none";d.id=f.StartId;d.setAttribute("_fck_bookmark",true);d.innerHTML="&nbsp;";c=this.Clone();c.Collapse(true);c.InsertNode(d);if(e){f.StartNode=d;f.EndNode=a}if(a){this.SetStart(d,4);this.SetEnd(a,3)}else{this.MoveToPosition(d,4)}return f},GetBookmarkNode:function(a,c){var b=this.Window.document;if(c){return a.StartNode||b.getElementById(a.StartId)}else{return a.EndNode||b.getElementById(a.EndId)}},MoveToBookmark:function(c,b){var d=this.GetBookmarkNode(c,true);var a=this.GetBookmarkNode(c,false);this.SetStart(d,3);if(!b){FCKDomTools.RemoveNode(d)}if(a){this.SetEnd(a,3);if(!b){FCKDomTools.RemoveNode(a)}}else{this.Collapse(true)}this._UpdateElementInfo()},CreateBookmark2:function(){if(!this._Range){return{"Start":0,"End":0}}var d={"Start":[this._Range.startOffset],"End":[this._Range.endOffset]};var a=this._Range.startContainer.previousSibling;var f=this._Range.endContainer.previousSibling;var e=this._Range.startContainer;var b=this._Range.endContainer;while(a&&e.nodeType==3){d.Start[0]+=a.length;e=a;a=a.previousSibling}while(f&&b.nodeType==3){d.End[0]+=f.length;b=f;f=f.previousSibling}if(e.nodeType==1&&e.childNodes[d.Start[0]]&&e.childNodes[d.Start[0]].nodeType==3){var c=e.childNodes[d.Start[0]];var g=0;while(c.previousSibling&&c.previousSibling.nodeType==3){c=c.previousSibling;g+=c.length}e=c;d.Start[0]=g}if(b.nodeType==1&&b.childNodes[d.End[0]]&&b.childNodes[d.End[0]].nodeType==3){var c=b.childNodes[d.End[0]];var g=0;while(c.previousSibling&&c.previousSibling.nodeType==3){c=c.previousSibling;g+=c.length}b=c;d.End[0]=g}d.Start=FCKDomTools.GetNodeAddress(e,true).concat(d.Start);d.End=FCKDomTools.GetNodeAddress(b,true).concat(d.End);return d},MoveToBookmark2:function(d){var b=FCKDomTools.GetNodeFromAddress(this.Window.document,d.Start.slice(0,-1),true);var e=FCKDomTools.GetNodeFromAddress(this.Window.document,d.End.slice(0,-1),true);this.Release(true);this._Range=new FCKW3CRange(this.Window.document);var a=d.Start[d.Start.length-1];var c=d.End[d.End.length-1];while(b.nodeType==3&&a>b.length){if(!b.nextSibling||b.nextSibling.nodeType!=3){break}a-=b.length;b=b.nextSibling}while(e.nodeType==3&&c>e.length){if(!e.nextSibling||e.nextSibling.nodeType!=3){break}c-=e.length;e=e.nextSibling}this._Range.setStart(b,a);this._Range.setEnd(e,c);this._UpdateElementInfo()},MoveToPosition:function(b,a){this.SetStart(b,a);this.Collapse(true)},SetStart:function(c,a,b){var d=this._Range;if(!d){d=this._Range=this.CreateRange()}switch(a){case 1:d.setStart(c,0);break;case 2:d.setStart(c,c.childNodes.length);break;case 3:d.setStartBefore(c);break;case 4:d.setStartAfter(c)}if(!b){this._UpdateElementInfo()}},SetEnd:function(c,a,b){var d=this._Range;if(!d){d=this._Range=this.CreateRange()}switch(a){case 1:d.setEnd(c,0);break;case 2:d.setEnd(c,c.childNodes.length);break;case 3:d.setEndBefore(c);break;case 4:d.setEndAfter(c)}if(!b){this._UpdateElementInfo()}},Expand:function(c){var f,a;switch(c){case"inline_elements":if(this._Range.startOffset==0){f=this._Range.startContainer;if(f.nodeType!=1){f=f.previousSibling?null:f.parentNode}if(f){while(FCKListsLib.InlineNonEmptyElements[f.nodeName.toLowerCase()]){this._Range.setStartBefore(f);if(f!=f.parentNode.firstChild){break}f=f.parentNode}}}f=this._Range.endContainer;var e=this._Range.endOffset;if((f.nodeType==3&&e>=f.nodeValue.length)||(f.nodeType==1&&e>=f.childNodes.length)||(f.nodeType!=1&&f.nodeType!=3)){if(f.nodeType!=1){f=f.nextSibling?null:f.parentNode}if(f){while(FCKListsLib.InlineNonEmptyElements[f.nodeName.toLowerCase()]){this._Range.setEndAfter(f);if(f!=f.parentNode.lastChild){break}f=f.parentNode}}}break;case"block_contents":case"list_contents":var d=FCKListsLib.BlockBoundaries;if(c=="list_contents"||FCKConfig.EnterMode=="br"){d=FCKListsLib.ListBoundaries}if(this.StartBlock&&FCKConfig.EnterMode!="br"&&c=="block_contents"){this.SetStart(this.StartBlock,1)}else{f=this._Range.startContainer;if(f.nodeType==1){var b=f.childNodes[this._Range.startOffset];if(b){f=FCKDomTools.GetPreviousSourceNode(b,true)}else{f=f.lastChild||f}}while(f&&(f.nodeType!=1||(f!=this.StartBlockLimit&&!d[f.nodeName.toLowerCase()]))){this._Range.setStartBefore(f);f=f.previousSibling||f.parentNode}}if(this.EndBlock&&FCKConfig.EnterMode!="br"&&c=="block_contents"&&this.EndBlock.nodeName.toLowerCase()!="li"){this.SetEnd(this.EndBlock,2)}else{f=this._Range.endContainer;if(f.nodeType==1){f=f.childNodes[this._Range.endOffset]||f.lastChild}while(f&&(f.nodeType!=1||(f!=this.StartBlockLimit&&!d[f.nodeName.toLowerCase()]))){this._Range.setEndAfter(f);f=f.nextSibling||f.parentNode}if(f&&f.nodeName.toLowerCase()=="br"){this._Range.setEndAfter(f)}}this._UpdateElementInfo()}},SplitBlock:function(e){var h=e||FCKConfig.EnterMode;if(!this._Range){this.MoveToSelection()}if(this.StartBlockLimit==this.EndBlockLimit){var d=this.StartBlock;var a=this.EndBlock;var c=null;if(h!="br"){if(!d){d=this.FixBlock(true,h);a=this.EndBlock}if(!a){a=this.FixBlock(false,h)}}var b=(d!=null&&this.CheckStartOfBlock());var f=(a!=null&&this.CheckEndOfBlock());if(!this.CheckIsEmpty()){this.DeleteContents()}if(d&&a&&d==a){if(f){c=new FCKElementPath(this.StartContainer);this.MoveToPosition(a,4);a=null}else{if(b){c=new FCKElementPath(this.StartContainer);this.MoveToPosition(d,3);d=null}else{this.SetEnd(d,2);var g=this.ExtractContents();a=d.cloneNode(false);a.removeAttribute("id",false);g.AppendTo(a);FCKDomTools.InsertAfterNode(d,a);this.MoveToPosition(d,4);if(FCKBrowserInfo.IsGecko&&!d.nodeName.IEquals(["ul","ol"])){FCKTools.AppendBogusBr(d)}}}}return{PreviousBlock:d,NextBlock:a,WasStartOfBlock:b,WasEndOfBlock:f,ElementPath:c}}return null},FixBlock:function(a,d){var c=this.CreateBookmark();this.Collapse(a);this.Expand("block_contents");var b=this.Window.document.createElement(d);this.ExtractContents().AppendTo(b);FCKDomTools.TrimNode(b);if(FCKDomTools.CheckIsEmptyElement(b,function(e){return e.getAttribute("_fck_bookmark")!="true"})&&FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(b)}this.InsertNode(b);this.MoveToBookmark(c);return b},Release:function(a){if(!a){this.Window=null}this.StartNode=null;this.StartContainer=null;this.StartBlock=null;this.StartBlockLimit=null;this.EndNode=null;this.EndContainer=null;this.EndBlock=null;this.EndBlockLimit=null;this._Range=null;this._Cache=null},CheckHasRange:function(){return !!this._Range},GetTouchedStartNode:function(){var b=this._Range;var a=b.startContainer;if(b.collapsed||a.nodeType!=1){return a}return a.childNodes[b.startOffset]||a},GetTouchedEndNode:function(){var b=this._Range;var a=b.endContainer;if(b.collapsed||a.nodeType!=1){return a}return a.childNodes[b.endOffset-1]||a},MoveToSelection:function(){if(this.Window.getSelection){this.Release(true);var a=this.Window.getSelection();if(a&&a.rangeCount>0){this._Range=FCKW3CRange.CreateFromRange(this.Window.document,a.getRangeAt(0));this._UpdateElementInfo()}else{if(this.Window.document){this.MoveToElementStart(this.Window.document.body)}}}else{this.Release(true);this._Range=new FCKW3CRange(this.Window.document);var a=FCKSelection.GetSelection();if(a.type!="Control"){var c=this._GetSelectionMarkerTag(true);var d=this._GetSelectionMarkerTag(false);if(!c&&!d){this._Range.setStart(this.Window.document.body,0);this._UpdateElementInfo();return}this._Range.setStart(c.parentNode,FCKDomTools.GetIndexOf(c));c.parentNode.removeChild(c);this._Range.setEnd(d.parentNode,FCKDomTools.GetIndexOf(d));d.parentNode.removeChild(d);this._UpdateElementInfo()}else{var b=a.createRange().item(0);if(b){this._Range.setStartBefore(b);this._Range.setEndAfter(b);this._UpdateElementInfo()}}}},Select:function(g){if(FCKBrowserInfo.IsGecko||FCKBrowserInfo.IsGeckoLike){var f=this._Range;if(f){var b=f.startContainer;if(f.collapsed&&b.nodeType==1&&b.childNodes.length==0){b.appendChild(f._Document.createTextNode(""))}var a=this.Window.document.createRange();a.setStart(b,f.startOffset);try{a.setEnd(f.endContainer,f.endOffset)}catch(d){if(d.toString().Contains("NS_ERROR_ILLEGAL_VALUE")){f.collapse(true);a.setEnd(A.endContainer,f.endOffset)}else{throw (d)}}var c=this.Window.getSelection();c.removeAllRanges();c.addRange(a)}}else{if(this._Range){this.SelectBookmark(this.CreateBookmark(true),g)}}},SelectBookmark:function(i,b){if(FCKBrowserInfo.IsGecko||FCKBrowserInfo.IsGeckoLike){var m=this.Window.document.createRange();var c=this.GetBookmarkNode(i,true);var h=this.GetBookmarkNode(i,false);m.setStart(c.parentNode,FCKDomTools.GetIndexOf(c));FCKDomTools.RemoveNode(c);if(h){m.setEnd(h.parentNode,FCKDomTools.GetIndexOf(h));FCKDomTools.RemoveNode(h)}var l=this.Window.getSelection();l.removeAllRanges();l.addRange(m)}else{var j=this.CheckIsCollapsed();var k=false;var g=null;var d=this.GetBookmarkNode(i,true);if(!d){return}var e=null;if(!j){e=this.GetBookmarkNode(i,false)}var a=this.Window.document.body.createTextRange();a.moveToElementText(d);a.moveStart("character",1);if(e){var f=this.Window.document.body.createTextRange();f.moveToElementText(e);a.setEndPoint("EndToEnd",f);a.moveEnd("character",-1)}else{k=(b||!d.previousSibling||d.previousSibling.nodeName.toLowerCase()=="br")&&!d.nextSibing;g=this.Window.document.createElement("span");g.innerHTML="&#65279;";d.parentNode.insertBefore(g,d);if(k){d.parentNode.insertBefore(this.Window.document.createTextNode("\ufeff"),d)}}if(!this._Range){this._Range=this.CreateRange()}this._Range.setStartBefore(d);d.parentNode.removeChild(d);if(j){if(k){a.moveStart("character",-1);a.select();this.Window.document.selection.clear()}else{a.select()}FCKDomTools.RemoveNode(g)}else{this._Range.setEndBefore(e);e.parentNode.removeChild(e);a.select()}}},_GetSelectionMarkerTag:function(a){var f=this.Window.document;var c=f.selection;var g;try{g=c.createRange()}catch(d){return null}if(g.parentElement().document!=f){return null}g.collapse(a===true);var b="fck_dom_range_temp_"+(new Date()).valueOf()+"_"+Math.floor(Math.random()*1000);g.pasteHTML('<span id="'+b+'"></span>');return f.getElementById(b)}};
var FCKDomRangeIterator=function(a){this.Range=a;this.ForceBrBreak=false;this.EnforceRealBlocks=false};FCKDomRangeIterator.CreateFromSelection=function(b){var a=new FCKDomRange(b);a.MoveToSelection();return new FCKDomRangeIterator(a)};FCKDomRangeIterator.prototype={GetNextParagraph:function(){var i=null;var l=null;var j;var o;var b;var h=this.ForceBrBreak?FCKListsLib.ListBoundaries:FCKListsLib.BlockBoundaries;if(!this._LastNode){l=this.Range.Clone();l.Expand(this.ForceBrBreak?"list_contents":"block_contents");this._NextNode=l.GetTouchedStartNode();this._LastNode=l.GetTouchedEndNode();l=null}var e=this._NextNode;var c=this._LastNode;this._NextNode=null;while(e){var g=false;var f=(e.nodeType!=1);var n=false;if(!f){var m=e.nodeName.toLowerCase();if(h[m]&&(!FCKBrowserInfo.IsIE7||e.scopeName=="HTML")){if(m=="br"){f=true}else{if(!l&&e.childNodes.length==0&&m!="hr"){i=e;j=e==c;break}}if(l){l.SetEnd(e,3,true);if(m!="br"){this._NextNode=e}}g=true}else{if(e.firstChild){if(!l){l=new FCKDomRange(this.Range.Window);l.SetStart(e,3,true)}e=e.firstChild;continue}f=true}}else{if(e.nodeType==3){if(/^[\r\n\t ]+$/.test(e.nodeValue)){f=false}}}if(f&&!l){l=new FCKDomRange(this.Range.Window);l.SetStart(e,3,true)}j=((!g||f)&&e==c);if(l&&!g){while(!e.nextSibling&&!j){var k=e.parentNode;if(h[k.nodeName.toLowerCase()]){g=true;j=j||(k==c);break}e=k;f=true;j=(e==c);n=true}}if(f){l.SetEnd(e,4,true)}if((g||j)&&l){l._UpdateElementInfo();if(l.StartNode==l.EndNode&&l.StartNode.parentNode==l.StartBlockLimit&&l.StartNode.getAttribute&&l.StartNode.getAttribute("_fck_bookmark")){l=null}else{break}}if(j){break}e=FCKDomTools.GetNextSourceNode(e,n,null,c)}if(!i){if(!l){this._NextNode=null;return null}i=l.StartBlock;if(!i&&!this.EnforceRealBlocks&&l.StartBlockLimit.nodeName.IEquals("DIV","TH","TD")&&l.CheckStartOfBlock()&&l.CheckEndOfBlock()){i=l.StartBlockLimit}else{if(!i||(this.EnforceRealBlocks&&i.nodeName.toLowerCase()=="li")){i=this.Range.Window.document.createElement(FCKConfig.EnterMode=="p"?"p":"div");l.ExtractContents().AppendTo(i);FCKDomTools.TrimNode(i);l.InsertNode(i);o=true;b=true}else{if(i.nodeName.toLowerCase()!="li"){if(!l.CheckStartOfBlock()||!l.CheckEndOfBlock()){i=i.cloneNode(false);l.ExtractContents().AppendTo(i);FCKDomTools.TrimNode(i);var p=l.SplitBlock();o=!p.WasStartOfBlock;b=!p.WasEndOfBlock;l.InsertNode(i)}}else{if(!j){this._NextNode=i==c?null:FCKDomTools.GetNextSourceNode(l.EndNode,true,null,c);return i}}}}}if(o){var a=i.previousSibling;if(a&&a.nodeType==1){if(a.nodeName.toLowerCase()=="br"){a.parentNode.removeChild(a)}else{if(a.lastChild&&a.lastChild.nodeName.IEquals("br")){a.removeChild(a.lastChild)}}}}if(b){var d=i.lastChild;if(d&&d.nodeType==1&&d.nodeName.toLowerCase()=="br"){i.removeChild(d)}}if(!this._NextNode){this._NextNode=(j||i==c)?null:FCKDomTools.GetNextSourceNode(i,true,null,c)}return i}};


var FCKDocumentFragment=function(A){this._Document=A;this.RootNode=A.createElement('div');};FCKDocumentFragment.prototype={AppendTo:function(A){FCKDomTools.MoveChildren(this.RootNode,A);},AppendHtml:function(A){var B=this._Document.createElement('div');B.innerHTML=A;FCKDomTools.MoveChildren(B,this.RootNode);},InsertAfterNode:function(A){var B=this.RootNode;var C;while((C=B.lastChild)) FCKDomTools.InsertAfterNode(A,B.removeChild(C));}};
var FCKW3CRange=function(A){this._Document=A;this.startContainer=null;this.startOffset=null;this.endContainer=null;this.endOffset=null;this.collapsed=true;};FCKW3CRange.CreateRange=function(A){return new FCKW3CRange(A);};FCKW3CRange.CreateFromRange=function(A,B){var C=FCKW3CRange.CreateRange(A);C.setStart(B.startContainer,B.startOffset);C.setEnd(B.endContainer,B.endOffset);return C;};FCKW3CRange.prototype={_UpdateCollapsed:function(){this.collapsed=(this.startContainer==this.endContainer&&this.startOffset==this.endOffset);},setStart:function(A,B){this.startContainer=A;this.startOffset=B;if (!this.endContainer){this.endContainer=A;this.endOffset=B;};this._UpdateCollapsed();},setEnd:function(A,B){this.endContainer=A;this.endOffset=B;if (!this.startContainer){this.startContainer=A;this.startOffset=B;};this._UpdateCollapsed();},setStartAfter:function(A){this.setStart(A.parentNode,FCKDomTools.GetIndexOf(A)+1);},setStartBefore:function(A){this.setStart(A.parentNode,FCKDomTools.GetIndexOf(A));},setEndAfter:function(A){this.setEnd(A.parentNode,FCKDomTools.GetIndexOf(A)+1);},setEndBefore:function(A){this.setEnd(A.parentNode,FCKDomTools.GetIndexOf(A));},collapse:function(A){if (A){this.endContainer=this.startContainer;this.endOffset=this.startOffset;}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset;};this.collapsed=true;},selectNodeContents:function(A){this.setStart(A,0);this.setEnd(A,A.nodeType==3?A.data.length:A.childNodes.length);},insertNode:function(A){var B=this.startContainer;var C=this.startOffset;if (B.nodeType==3){B.splitText(C);if (B==this.endContainer) this.setEnd(B.nextSibling,this.endOffset-this.startOffset);FCKDomTools.InsertAfterNode(B,A);return;}else{B.insertBefore(A,B.childNodes[C]||null);if (B==this.endContainer){this.endOffset++;this.collapsed=false;}}},deleteContents:function(){if (this.collapsed) return;this._ExecContentsAction(0);},extractContents:function(){var A=new FCKDocumentFragment(this._Document);if (!this.collapsed) this._ExecContentsAction(1,A);return A;},cloneContents:function(){var A=new FCKDocumentFragment(this._Document);if (!this.collapsed) this._ExecContentsAction(2,A);return A;},_ExecContentsAction:function(A,B){var C=this.startContainer;var D=this.endContainer;var E=this.startOffset;var F=this.endOffset;var G=false;var H=false;if (D.nodeType==3) D=D.splitText(F);else{if (D.childNodes.length>0){if (F>D.childNodes.length-1){D=FCKDomTools.InsertAfterNode(D.lastChild,this._Document.createTextNode(''));H=true;}else D=D.childNodes[F];}};if (C.nodeType==3){C.splitText(E);if (C==D) D=C.nextSibling;}else{if (E==0){C=C.insertBefore(this._Document.createTextNode(''),C.firstChild);G=true;}else if (E>C.childNodes.length-1){C=C.appendChild(this._Document.createTextNode(''));G=true;}else C=C.childNodes[E].previousSibling;};var I=FCKDomTools.GetParents(C);var J=FCKDomTools.GetParents(D);var i,topStart,topEnd;for (i=0;i<I.length;i++){topStart=I[i];topEnd=J[i];if (topStart!=topEnd) break;};var K,levelStartNode,levelClone,currentNode,currentSibling;if (B) K=B.RootNode;for (var j=i;j<I.length;j++){levelStartNode=I[j];if (K&&levelStartNode!=C) levelClone=K.appendChild(levelStartNode.cloneNode(levelStartNode==C));currentNode=levelStartNode.nextSibling;while(currentNode){if (currentNode==J[j]||currentNode==D) break;currentSibling=currentNode.nextSibling;if (A==2) K.appendChild(currentNode.cloneNode(true));else{currentNode.parentNode.removeChild(currentNode);if (A==1) K.appendChild(currentNode);};currentNode=currentSibling;};if (K) K=levelClone;};if (B) K=B.RootNode;for (var k=i;k<J.length;k++){levelStartNode=J[k];if (A>0&&levelStartNode!=D) levelClone=K.appendChild(levelStartNode.cloneNode(levelStartNode==D));if (!I[k]||levelStartNode.parentNode!=I[k].parentNode){currentNode=levelStartNode.previousSibling;while(currentNode){if (currentNode==I[k]||currentNode==C) break;currentSibling=currentNode.previousSibling;if (A==2) K.insertBefore(currentNode.cloneNode(true),K.firstChild);else{currentNode.parentNode.removeChild(currentNode);if (A==1) K.insertBefore(currentNode,K.firstChild);};currentNode=currentSibling;}};if (K) K=levelClone;};if (A==2){var L=this.startContainer;if (L.nodeType==3){L.data+=L.nextSibling.data;L.parentNode.removeChild(L.nextSibling);};var M=this.endContainer;if (M.nodeType==3&&M.nextSibling){M.data+=M.nextSibling.data;M.parentNode.removeChild(M.nextSibling);}}else{if (topStart&&topEnd&&(C.parentNode!=topStart.parentNode||D.parentNode!=topEnd.parentNode)){var N=FCKDomTools.GetIndexOf(topEnd);if (G&&topEnd.parentNode==C.parentNode) N--;this.setStart(topEnd.parentNode,N);};this.collapse(true);};if(G) C.parentNode.removeChild(C);if(H&&D.parentNode) D.parentNode.removeChild(D);},cloneRange:function(){return FCKW3CRange.CreateFromRange(this._Document,this);}};
var FCKEnterKey=function(b,a,e,c){this.Window=b;this.EnterMode=a||"p";this.ShiftEnterMode=e||"br";var d=new FCKKeystrokeHandler(false);d._EnterKey=this;d.OnKeystroke=FCKEnterKey_OnKeystroke;d.SetKeystrokes([[13,"Enter"],[SHIFT+13,"ShiftEnter"],[8,"Backspace"],[CTRL+8,"CtrlBackspace"],[46,"Delete"]]);this.TabText="";if(c>0||FCKBrowserInfo.IsSafari){while(c--){this.TabText+="\xa0"}d.SetKeystrokes([9,"Tab"])}d.AttachToElement(b.document)};function FCKEnterKey_OnKeystroke(a,d){var b=this._EnterKey;try{switch(d){case"Enter":return b.DoEnter();break;case"ShiftEnter":return b.DoShiftEnter();break;case"Backspace":return b.DoBackspace();break;case"Delete":return b.DoDelete();break;case"Tab":return b.DoTab();break;case"CtrlBackspace":return b.DoCtrlBackspace();break}}catch(c){}return false}FCKEnterKey.prototype.DoEnter=function(e,d){FCKUndo.SaveUndoStep();this._HasShift=(d===true);var a=FCKSelection.GetParentElement();var b=new FCKElementPath(a);var c=e||this.EnterMode;if(c=="br"||b.Block&&b.Block.tagName.toLowerCase()=="pre"){return this._ExecuteEnterBr()}else{return this._ExecuteEnterBlock(c)}};FCKEnterKey.prototype.DoShiftEnter=function(){return this.DoEnter(this.ShiftEnterMode,true)};FCKEnterKey.prototype.DoBackspace=function(){var g=false;var d=new FCKDomRange(this.Window);d.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(d,this.Window.document.body)){this._FixIESelectAllBug(d);return true}var k=d.CheckIsCollapsed();if(!k){if(FCKBrowserInfo.IsIE&&this.Window.document.selection.type.toLowerCase()=="control"){var m=this.Window.document.selection.createRange();for(var j=m.length-1;j>=0;j--){var b=m.item(j);b.parentNode.removeChild(b)}return true}return false}if(FCKBrowserInfo.IsIE){var f=FCKDomTools.GetPreviousSourceElement(d.StartNode,true);if(f&&f.nodeName.toLowerCase()=="br"){var e=d.Clone();e.SetStart(f,4);if(e.CheckIsEmpty()){f.parentNode.removeChild(f);return true}}}var h=d.StartBlock;var a=d.EndBlock;if(d.StartBlockLimit==d.EndBlockLimit&&h&&a){if(!k){var l=d.CheckEndOfBlock();d.DeleteContents();if(h!=a){d.SetStart(a,1);d.SetEnd(a,1)}d.Select();g=(h==a)}if(d.CheckStartOfBlock()){var c=d.StartBlock;var n=FCKDomTools.GetPreviousSourceElement(c,true,["BODY",d.StartBlockLimit.nodeName],["UL","OL"]);g=this._ExecuteBackspace(d,n,c)}else{if(FCKBrowserInfo.IsGeckoLike){d.Select()}}}d.Release();return g};FCKEnterKey.prototype.DoCtrlBackspace=function(){FCKUndo.SaveUndoStep();var a=new FCKDomRange(this.Window);a.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(a,this.Window.document.body)){this._FixIESelectAllBug(a);return true}return false};FCKEnterKey.prototype._ExecuteBackspace=function(h,i,e){var f=false;if(!i&&e&&e.nodeName.IEquals("LI")&&e.parentNode.parentNode.nodeName.IEquals("LI")){this._OutdentWithSelection(e,h);return true}if(i&&i.nodeName.IEquals("LI")){var c=FCKDomTools.GetLastChild(i,["UL","OL"]);while(c){i=FCKDomTools.GetLastChild(c,"LI");c=FCKDomTools.GetLastChild(i,["UL","OL"])}}if(i&&e){if(e.nodeName.IEquals("LI")&&!i.nodeName.IEquals("LI")){this._OutdentWithSelection(e,h);return true}var d=e.parentNode;var a=i.nodeName.toLowerCase();if(FCKListsLib.EmptyElements[a]!=null||a=="table"){FCKDomTools.RemoveNode(i);f=true}else{FCKDomTools.RemoveNode(e);while(d.innerHTML.Trim().length==0){var b=d.parentNode;b.removeChild(d);d=b}FCKDomTools.LTrimNode(e);FCKDomTools.RTrimNode(i);h.SetStart(i,2,true);h.Collapse(true);var g=h.CreateBookmark(true);if(!e.tagName.IEquals(["TABLE"])){FCKDomTools.MoveChildren(e,i)}h.SelectBookmark(g);f=true}}return f};FCKEnterKey.prototype.DoDelete=function(){FCKUndo.SaveUndoStep();var e=false;var f=new FCKDomRange(this.Window);f.MoveToSelection();if(FCKBrowserInfo.IsIE&&this._CheckIsAllContentsIncluded(f,this.Window.document.body)){this._FixIESelectAllBug(f);return true}if(f.CheckIsCollapsed()&&f.CheckEndOfBlock(FCKBrowserInfo.IsGeckoLike)){var d=f.StartBlock;var a=FCKTools.GetElementAscensor(d,"td");var c=FCKDomTools.GetNextSourceElement(d,true,[f.StartBlockLimit.nodeName],["UL","OL","TR"],true);if(a){var b=FCKTools.GetElementAscensor(c,"td");if(b!=a){return true}}e=this._ExecuteBackspace(f,d,c)}f.Release();return e};FCKEnterKey.prototype.DoTab=function(){var c=new FCKDomRange(this.Window);c.MoveToSelection();var b=c._Range.startContainer;while(b){if(b.nodeType==1){var a=b.tagName.toLowerCase();if(a=="tr"||a=="td"||a=="th"||a=="tbody"||a=="table"){return false}else{break}}b=b.parentNode}if(this.TabText){c.DeleteContents();c.InsertNode(this.Window.document.createTextNode(this.TabText));c.Collapse(false);c.Select()}return true};FCKEnterKey.prototype._ExecuteEnterBlock=function(j,h){var d=h||new FCKDomRange(this.Window);var l=d.SplitBlock(j);if(l){var m=l.PreviousBlock;var p=l.NextBlock;var e=l.WasStartOfBlock;var c=l.WasEndOfBlock;if(p){if(p.parentNode.nodeName.IEquals("li")){FCKDomTools.BreakParent(p,p.parentNode);FCKDomTools.MoveNode(p,p.nextSibling,true)}}else{if(m&&m.parentNode.nodeName.IEquals("li")){FCKDomTools.BreakParent(m,m.parentNode);d.MoveToElementEditStart(m.nextSibling);FCKDomTools.MoveNode(m,m.previousSibling)}}if(!e&&!c){if(p.nodeName.IEquals("li")&&p.firstChild&&p.firstChild.nodeName.IEquals(["ul","ol"])){p.insertBefore(FCKTools.GetElementDocument(p).createTextNode("\xa0"),p.firstChild)}if(p){d.MoveToElementEditStart(p)}}else{if(e&&c&&m.tagName.toUpperCase()=="LI"){d.MoveToElementStart(m);this._OutdentWithSelection(m,d);d.Release();return true}var a;if(m){var b=m.tagName.toUpperCase();if(!this._HasShift&&!(/^H[1-6]$/).test(b)){a=FCKDomTools.CloneElement(m)}}else{if(p){a=FCKDomTools.CloneElement(p)}}if(!a){a=this.Window.document.createElement(j)}var o=l.ElementPath;if(o){for(var g=0,k=o.Elements.length;g<k;g++){var f=o.Elements[g];if(f==o.Block||f==o.BlockLimit){break}if(FCKListsLib.InlineChildReqElements[f.nodeName.toLowerCase()]){f=FCKDomTools.CloneElement(f);FCKDomTools.MoveChildren(a,f);a.appendChild(f)}}}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(a)}d.InsertNode(a);if(FCKBrowserInfo.IsIE){d.MoveToElementEditStart(a);d.Select()}d.MoveToElementEditStart(e&&!c?p:a)}if(FCKBrowserInfo.IsGeckoLike){if(p){var n=this.Window.document.createElement("span");n.innerHTML="&nbsp;";d.InsertNode(n);FCKDomTools.ScrollIntoView(n,false);d.DeleteContents()}else{FCKDomTools.ScrollIntoView(p||a,false)}}d.Select()}d.Release();return true};FCKEnterKey.prototype._ExecuteEnterBr=function(i){var e=new FCKDomRange(this.Window);e.MoveToSelection();if(e.StartBlockLimit==e.EndBlockLimit){e.DeleteContents();e.MoveToSelection();var g=e.CheckStartOfBlock();var c=e.CheckEndOfBlock();var h=e.StartBlock?e.StartBlock.tagName.toUpperCase():"";var f=this._HasShift;var a=false;if(!f&&h=="LI"){return this._ExecuteEnterBlock(null,e)}if(!f&&c&&(/^H[1-6]$/).test(h)){FCKDomTools.InsertAfterNode(e.StartBlock,this.Window.document.createElement("br"));if(FCKBrowserInfo.IsGecko){FCKDomTools.InsertAfterNode(e.StartBlock,this.Window.document.createTextNode(""))}e.SetStart(e.StartBlock.nextSibling,FCKBrowserInfo.IsIE?3:1)}else{var b;a=h.IEquals("pre");if(a){b=this.Window.document.createTextNode(FCKBrowserInfo.IsIE?"\r":"\n")}else{b=this.Window.document.createElement("br")}e.InsertNode(b);if(FCKBrowserInfo.IsGecko){FCKDomTools.InsertAfterNode(b,this.Window.document.createTextNode(""))}if(c&&FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(b.parentNode)}if(FCKBrowserInfo.IsIE){e.SetStart(b,4)}else{e.SetStart(b.nextSibling,1)}if(!FCKBrowserInfo.IsIE){var d=null;if(FCKBrowserInfo.IsOpera){d=this.Window.document.createElement("span")}else{d=this.Window.document.createElement("br")}b.parentNode.insertBefore(d,b.nextSibling);FCKDomTools.ScrollIntoView(d,false);d.parentNode.removeChild(d)}}e.Collapse(true);e.Select(a)}e.Release();return true};FCKEnterKey.prototype._OutdentWithSelection=function(a,b){var c=b.CreateBookmark();FCKListHandler.OutdentListItem(a);b.MoveToBookmark(c);b.Select()};FCKEnterKey.prototype._CheckIsAllContentsIncluded=function(b,e){var d=false;var c=false;if(b.StartContainer==e||b.StartContainer==e.firstChild){d=(b._Range.startOffset==0)}if(b.EndContainer==e||b.EndContainer==e.lastChild){var a=b.EndContainer.nodeType==3?b.EndContainer.length:b.EndContainer.childNodes.length;c=(b._Range.endOffset==a)}return d&&c};FCKEnterKey.prototype._FixIESelectAllBug=function(a){var c=this.Window.document;c.body.innerHTML="";var b;if(FCKConfig.EnterMode.IEquals(["div","p"])){b=c.createElement(FCKConfig.EnterMode);c.body.appendChild(b)}else{b=c.body}a.MoveToNodeContents(b);a.Collapse(true);a.Select();a.Release()};
var FCKDocumentProcessor={};FCKDocumentProcessor._Items=[];FCKDocumentProcessor.AppendNew=function(){var A={};this._Items.push(A);return A;};FCKDocumentProcessor.Process=function(A){var B=FCK.IsDirty();var C,i=0;while((C=this._Items[i++])) C.ProcessDocument(A);if (!B) FCK.ResetIsDirty();};var FCKDocumentProcessor_CreateFakeImage=function(A,B){var C=FCKTools.GetElementDocument(B).createElement('IMG');C.className=A;C.src=FCKConfig.BasePath+'images/spacer.gif';C.setAttribute('_fckfakelement','true',0);C.setAttribute('_fckrealelement',FCKTempBin.AddElement(B),0);return C;};if (FCKBrowserInfo.IsIE||FCKBrowserInfo.IsOpera){var FCKAnchorsProcessor=FCKDocumentProcessor.AppendNew();FCKAnchorsProcessor.ProcessDocument=function(A){var B=A.getElementsByTagName('A');var C;var i=B.length-1;while (i>=0&&(C=B[i--])){if (C.name.length>0){if (C.innerHTML!==''){if (FCKBrowserInfo.IsIE) C.className+=' FCK__AnchorC';}else{var D=FCKDocumentProcessor_CreateFakeImage('FCK__Anchor',C.cloneNode(true));D.setAttribute('_fckanchor','true',0);C.parentNode.insertBefore(D,C);C.parentNode.removeChild(C);}}}}};var FCKPageBreaksProcessor=FCKDocumentProcessor.AppendNew();FCKPageBreaksProcessor.ProcessDocument=function(A){var B=A.getElementsByTagName('DIV');var C;var i=B.length-1;while (i>=0&&(C=B[i--])){if (C.style.pageBreakAfter=='always'&&C.childNodes.length==1&&C.childNodes[0].style&&C.childNodes[0].style.display=='none'){var D=FCKDocumentProcessor_CreateFakeImage('FCK__PageBreak',C.cloneNode(true));C.parentNode.insertBefore(D,C);C.parentNode.removeChild(C);}}};var FCKEmbedAndObjectProcessor=(function(){var A=[];var B=function(el){var C=el.cloneNode(true);var D;var E=D=FCKDocumentProcessor_CreateFakeImage('FCK__UnknownObject',C);FCKEmbedAndObjectProcessor.RefreshView(E,el);for (var i=0;i<A.length;i++) D=A[i](el,D)||D;if (D!=E) FCKTempBin.RemoveElement(E.getAttribute('_fckrealelement'));el.parentNode.replaceChild(D,el);};var F=function(elementName,doc){var G=doc.getElementsByTagName(elementName);for (var i=G.length-1;i>=0;i--) B(G[i]);};var H=function(doc){F('object',doc);F('embed',doc);};return FCKTools.Merge(FCKDocumentProcessor.AppendNew(),{ProcessDocument:function(doc){if (FCKBrowserInfo.IsGecko) FCKTools.RunFunction(H,this,[doc]);else H(doc);},RefreshView:function(placeHolder,original){if (original.getAttribute('width')>0) placeHolder.style.width=FCKTools.ConvertHtmlSizeToStyle(original.getAttribute('width'));if (original.getAttribute('height')>0) placeHolder.style.height=FCKTools.ConvertHtmlSizeToStyle(original.getAttribute('height'));},AddCustomHandler:function(func){A.push(func);}});})();FCK.GetRealElement=function(A){var e=FCKTempBin.Elements[A.getAttribute('_fckrealelement')];if (A.getAttribute('_fckflash')){if (A.style.width.length>0) e.width=FCKTools.ConvertStyleSizeToHtml(A.style.width);if (A.style.height.length>0) e.height=FCKTools.ConvertStyleSizeToHtml(A.style.height);};return e;};if (FCKBrowserInfo.IsIE){FCKDocumentProcessor.AppendNew().ProcessDocument=function(A){var B=A.getElementsByTagName('HR');var C;var i=B.length-1;while (i>=0&&(C=B[i--])){var D=A.createElement('hr');D.mergeAttributes(C,true);FCKDomTools.InsertAfterNode(C,D);C.parentNode.removeChild(C);}}};FCKDocumentProcessor.AppendNew().ProcessDocument=function(A){var B=A.getElementsByTagName('INPUT');var C;var i=B.length-1;while (i>=0&&(C=B[i--])){if (C.type=='hidden'){var D=FCKDocumentProcessor_CreateFakeImage('FCK__InputHidden',C.cloneNode(true));D.setAttribute('_fckinputhidden','true',0);C.parentNode.insertBefore(D,C);C.parentNode.removeChild(C);}}};FCKEmbedAndObjectProcessor.AddCustomHandler(function(A,B){if (!(A.nodeName.IEquals('embed')&&(A.type=='application/x-shockwave-flash'||/\.swf($|#|\?)/i.test(A.src)))) return;B.className='FCK__Flash';B.setAttribute('_fckflash','true',0);});if (FCKBrowserInfo.IsSafari){FCKDocumentProcessor.AppendNew().ProcessDocument=function(A){var B=A.getElementsByClassName?A.getElementsByClassName('Apple-style-span'):Array.prototype.filter.call(A.getElementsByTagName('span'),function(item){ return item.className=='Apple-style-span';});for (var i=B.length-1;i>=0;i--) FCKDomTools.RemoveNode(B[i],true);}};
var FCKSelection=FCK.Selection={UseGeckoApi:function(){if(window.getSelection){return true}else{return false}},GetParentBlock:function(){var a=this.GetParentElement();while(a){if(FCKListsLib.BlockBoundaries[a.nodeName.toLowerCase()]){break}a=a.parentNode}return a},ApplyStyle:function(a){FCKStyles.ApplyStyle(new FCKStyle(a))},GetSelection:function(){if(FCKBrowserInfo.IsIE){this.Restore()}if(FCK.EditorWindow.getSelection){return FCK.EditorWindow.getSelection()}else{if(FCK.EditorDocument.selection){return FCK.EditorDocument.selection}}return null},GetSelectionText:function(){if(FCK.EditorWindow.getSelection){if(this.SelectionData){return this.SelectionData.toString()}return FCK.EditorWindow.getSelection().toString()}else{if(FCK.EditorDocument.selection){return FCK.EditorDocument.selection.createRange().text}}return null},Restore:function(){if(this.SelectionData){FCK.IsSelectionChangeLocked=true;try{if(this.SelectionData.select){this.SelectionData.select()}else{var a=FCK.EditorWindow.getSelection();a.removeAllRanges();a.addRange(this.SelectionData)}}catch(b){}FCK.IsSelectionChangeLocked=false}},Release:function(){if(this.SelectionData){delete this.SelectionData;this.SelectionData=null}},_GetSelectionDocument:function(){var a;if(this.SelectionData){a=this.SelectionData}else{a=this.GetSelectionRange()}if(!a){return null}else{if(a.item){return FCKTools.GetElementDocument(a.item(0))}else{if(a.parentElement){return FCKTools.GetElementDocument(a.parentElement())}else{return FCKTools.GetElementDocument(this._GetRangeParent(a))}}}},GetSelectionRange:function(a){if(!a){a=this.GetSelection()}if(window.getSelection){if(a.rangeCount>0){return a.getRangeAt(0)}}else{return a.createRange()}},GetSelectedElement:function(){if(FCK.EditorWindow.getSelection){var b=!!FCK.EditorWindow&&this.GetSelection();if(!b||b.rangeCount<1){return null}var a=b.getRangeAt(0);if(a.startContainer!=a.endContainer||a.startContainer.nodeType!=1||a.startOffset!=a.endOffset-1){return null}var c=a.startContainer.childNodes[a.startOffset];if(c.nodeType!=1){return null}return c}else{if(this.GetType()=="Control"){var d=this.GetSelectionRange();if(d&&d.item){return d.item(0)}}return null}},_GetRangeParent:function(a){if(a.startContainer!=a.endContainer){return null}return a.startContainer},GetParentElement:function(){if(this.UseGeckoApi()){var c=!!FCK.EditorWindow&&this.GetSelection();if(!c||c.rangeCount<1){return null}var a=c.getRangeAt(0);if(a.startContainer!=a.endContainer||a.startContainer.nodeType!=1||a.startOffset!=a.endOffset-1){return null}var d=a.startContainer.childNodes[a.startOffset];if(d.nodeType!=1){return null}return d}else{switch(this.GetType()){case"Control":var b=FCKSelection.GetSelectedElement();return b?b.parentElement:null;case"None":return null;default:return this.GetSelectionRange().parentElement()}}},SelectNode:function(c){if(this.UseGeckoApi()){var f=FCK.EditorDocument.createRange();f.selectNode(c);var a=this.GetSelection();a.removeAllRanges();a.addRange(f)}else{FCK.Focus();this.GetSelection().empty();var f=null;try{f=FCK.EditorDocument.body.createControlRange();f.addElement(c)}catch(d){try{f=FCK.EditorDocument.body.createTextRange();f.moveToElementText(c)}catch(b){}}f.select()}},Collapse:function(b){if(this.UseGeckoApi()){var a=this.GetSelection();if(b==null||b===true){a.collapseToStart()}else{a.collapseToEnd()}}else{FCK.Focus();if(this.GetType()=="Text"){var c=this.GetSelectionRange();c.collapse(b==null||b===true);c.select()}}},HasAncestorNode:function(d){if(this.UseGeckoApi()){var a=this.GetSelectedElement();if(!a&&FCK.EditorWindow){try{a=this.GetSelection().getRangeAt(0).startContainer}catch(b){}}while(a){if(a.nodeType==1&&a.nodeName.IEquals(d)){return true}a=a.parentNode}return false}else{var a;if(this.GetSelection().type=="Control"){a=this.GetSelectedElement()}else{var c=this.GetSelectionRange();a=c.parentElement()}while(a){if(a.nodeName.IEquals(d)){return true}a=a.parentNode}return false}},Delete:function(){var a=this.GetSelection();if(this.UseGeckoApi()){for(var b=0;b<a.rangeCount;b++){a.getRangeAt(b).deleteContents()}return a}else{if(a.type.toLowerCase()!="none"){a.clear()}return a}},GetType:function(){if(this.UseGeckoApi()){var b="Text";var c=null;try{c=this.GetSelection()}catch(d){}if(c&&c.rangeCount==1){var a=c.getRangeAt(0);if(a.startContainer==a.endContainer&&(a.endOffset-a.startOffset)==1&&a.startContainer.nodeType==1&&FCKListsLib.StyleObjectElements[a.startContainer.childNodes[a.startOffset].nodeName.toLowerCase()]){b="Control"}}return b}else{try{var f=this.GetSelection().type;if(f=="Control"||f=="Text"){return f}if(this.GetSelectionRange().parentElement){return"Text"}}catch(d){}return"None"}},GetBoundaryParentElement:function(d){if(this.UseGeckoApi()){if(!FCK.EditorWindow){return null}if(this.GetType()=="Control"){return this.GetSelectedElement().parentNode}else{var a=this.GetSelection();if(a&&a.rangeCount>0){var b=a.getRangeAt(d?0:(a.rangeCount-1));var c=d?b.startContainer:b.endContainer;return(c.nodeType==1?c:c.parentNode)}}return null}else{switch(this.GetType()){case"Control":var e=this.GetSelectedElement();return e?e.parentElement:null;case"None":return null;default:var f=FCK.EditorDocument;var b=this.GetSelectionRange();b.collapse(d!==false);var e=b.parentElement();return FCKTools.GetElementDocument(e)==f?e:null}}},MoveToAncestorNode:function(e){if(this.UseGeckoApi()){var b=this.GetSelectedElement();if(!b){b=this.GetSelection().getRangeAt(0).startContainer}while(b){if(b.nodeName.IEquals(e)){return b}b=b.parentNode}return null}else{var d=null,c;if(!FCK.EditorDocument){return null}if(this.GetSelection().type=="Control"){c=this.GetSelectionRange();for(var a=0;a<c.length;a++){if(c(a).parentNode){d=c(a).parentNode;break}}}else{c=this.GetSelectionRange();d=c.parentElement()}while(d&&d.nodeName!=e){d=d.parentNode}return d}},Save:function(c){if(FCKBrowserInfo.IsIE){FCK.Focus();var b=FCK.EditorDocument;if(!b){return}if(this.locked){return}this.locked=!!c;var a=this.GetSelectionRange();if(a){if(a.parentElement&&FCKTools.GetElementDocument(a.parentElement())!=b){a=null}else{if(a.item&&FCKTools.GetElementDocument(a.item(0))!=b){a=null}}}this.SelectionData=a}}};

//code version 2.6.4 end
var FCKTableHandler={};FCKTableHandler.InsertRow=function(g){var l=null;var k=this.GetSelectedCells();if(k&&k.length){l=k[g?0:(k.length-1)]}if(!l){return}var f=this._CreateTableMap(l.parentNode.parentNode);var e=testgetArrIndex(f,l);var a=testgetLastArrIndex(f,l);var m=[];var n=0;for(var d=0;d<f.length;d++){if(!m[n]){m[n]=[]}if(g){if(d!=e[0]){for(var c=0;c<f[d].length;c++){m[n][c]=f[d][c]}n++}else{m[n+1]=[];for(var c=0;c<f[d].length;c++){var b=FCKTools.GetElementDocument(l).createElement("td");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(b)}var h=isNaN(f[d][c].rowSpan)?1:f[d][c].rowSpan;if(h>1&&(d-1)<0){m[n][c]=b}else{if(h>1&&(f[d-1][c]==f[d][c])){m[n][c]=f[d][c]}else{m[n][c]=b}}m[n+1][c]=f[d][c]}n+=2}}else{if(d!=a[0]){for(c=0;c<f[d].length;c++){m[n][c]=f[d][c]}n++}else{m[n+1]=[];for(c=0;c<f[d].length;c++){var b=FCKTools.GetElementDocument(l).createElement("td");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(b)}var h=isNaN(f[d][c].rowSpan)?1:f[d][c].rowSpan;m[n][c]=f[d][c];if(h>1&&(d+1)>(f.length-1)){m[n+1][c]=b}else{if(h>1&&(f[d+1][c]==f[d][c])){m[n+1][c]=f[d][c]}else{m[n+1][c]=b}}}n+=2}}}this._InstallTableMap(m,k[0].parentNode.parentNode)};FCKTableHandler.InsertLastColumn=function(b){FCKUndo.SaveUndoStep();var f=b.getElementsByTagName("tbody");if(f){b=f[0]}var g=this._CreateTableMap(b);var m=g[g.length-1];var a=[g.length-1,m.length-1];C=m[m.length-1];if(C&&C.length){B=C[b?0:(C.length-1)]}else{B=C}var l=[];for(var e=0;e<g.length;e++){if(!l[e]){l[e]=[]}var k=0;var d=0;while(d<g[e].length){var h=isNaN(g[e][d].colSpan)?1:g[e][d].colSpan;if(d!=a[1]){l[e][k]=g[e][d];k++;d++}else{l[e][k]=g[e][d];var c=FCKTools.GetElementDocument(B).createElement("td");c.width="20";if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(c)}if(h>1&&(g[e][d+1]==g[e][d])){l[e][k+1]=g[e][d]}else{l[e][k+1]=c}k+=2;d++}}}this._InstallTableMap(l,f[0])};FCKTableHandler.InsertLastRow=function(b){FCKUndo.SaveUndoStep();var f=b.getElementsByTagName("tbody");if(f){b=f[0]}var g=this._CreateTableMap(b);var m=g[g.length-1];var a=[g.length-1,m.length-1];C=m[m.length-1];if(C&&C.length){B=C[b?0:(C.length-1)]}else{B=C}var k=[];var l=0;for(var e=0;e<g.length;e++){if(!k[l]){k[l]=[]}if(e!=a[0]){for(var d=0;d<g[e].length;d++){k[l][d]=g[e][d]}l++}else{k[l+1]=[];for(var d=0;d<g[e].length;d++){var c=FCKTools.GetElementDocument(B).createElement("td");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(c)}var h=isNaN(g[e][d].rowSpan)?1:g[e][d].rowSpan;k[l][d]=g[e][d];if(h>1&&(e+1)>(g.length-1)){k[l+1][d]=c}else{if(h>1&&(g[e+1][d]==g[e][d])){k[l+1][d]=g[e][d]}else{k[l+1][d]=c}}}l+=2}}this._InstallTableMap(k,f[0])};FCKTableHandler.DeleteRows=function(m){if(!m){var f=FCKTableHandler.GetSelectedCells();var b=[];for(var c=0;c<f.length;c++){var a=FCKTools.GetElementAscensor(f[c],"TR");var h=[];h[0]=a;h[1]=f[c];b[a.rowIndex]=h}for(var c=b.length;c>=0;c--){if(b[c]){FCKTableHandler.DeleteRows(b[c])}}return}var e=this._CreateTableMap(m[0].parentNode);var d=testgetArrIndex(e,m[1]);var l=[];c=0;newrowindex=0;while(c<e.length){if(!l[newrowindex]){l[newrowindex]=[]}if(c==d[0]){var g=isNaN(m[1].rowSpan)?1:m[1].rowSpan;c+=g}else{l[newrowindex]=e[c];newrowindex++;c++}}if(l.length==1&&l[0].length==0){var k=FCKTools.GetElementAscensor(m[0],"TABLE");FCKTableHandler.DeleteTable(k)}else{this._InstallTableMap(l,m[0].parentNode)}};FCKTableHandler.DeleteTable=function(a){if(!a){a=FCKSelection.GetSelectedElement();if(!a||a.tagName!="TABLE"){a=FCKSelection.MoveToAncestorNode("TABLE")}}if(!a){return}FCKSelection.SelectNode(a);FCKSelection.Collapse();if(a.parentNode.childNodes.length==1){a.parentNode.parentNode.removeChild(a.parentNode)}else{a.parentNode.removeChild(a)}};FCKTableHandler.InsertColumn=function(k){var l=null;var a=this.GetSelectedCells();if(a&&a.length){l=a[k?0:(a.length-1)]}if(!l){return}var g=this._CreateTableMap(l.parentNode.parentNode);var f=testgetArrIndex(g,l);var b=testgetLastArrIndex(g,l);var n=[];for(var e=0;e<g.length;e++){if(!n[e]){n[e]=[]}var m=0;var d=0;if(k){while(d<g[e].length){var h=isNaN(g[e][d].colSpan)?1:g[e][d].colSpan;if(d!=f[1]){n[e][m]=g[e][d];m++;d++}else{var c=FCKTools.GetElementDocument(l).createElement("td");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(c)}if(h>1&&(g[e][d-1]==g[e][d])){n[e][m]=g[e][d]}else{n[e][m]=c}n[e][m+1]=g[e][d];m+=2;d++}}}else{while(d<g[e].length){var h=isNaN(g[e][d].colSpan)?1:g[e][d].colSpan;if(d!=b[1]){n[e][m]=g[e][d];m++;d++}else{n[e][m]=g[e][d];var c=FCKTools.GetElementDocument(l).createElement("td");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(c)}if(h>1&&(g[e][d+1]==g[e][d])){n[e][m+1]=g[e][d]}else{n[e][m+1]=c}m+=2;d++}}}}this._InstallTableMap(n,a[0].parentNode.parentNode)};testgetArrIndex=function(a,d){for(var c=0;c<a.length;c++){for(var b=0;b<a[c].length;b++){if(a[c][b].cellIndex==d.cellIndex&&a[c][b].parentNode.rowIndex==d.parentNode.rowIndex){return[c,b]}}}};testgetLastArrIndex=function(a,e){var c=null;for(var d=0;d<a.length;d++){for(var b=0;b<a[d].length;b++){if(a[d][b].cellIndex==e.cellIndex&&a[d][b].parentNode.rowIndex==e.parentNode.rowIndex){c=[d,b]}}}return c};FCKTableHandler.DeleteColumns=function(e){if(!e){var c=FCKTableHandler.GetSelectedCells();for(var g=c.length;g>=0;g--){if(c[g]){FCKTableHandler.DeleteColumns(c[g])}}return}if(!e){return}var b=this._CreateTableMap(e.parentNode.parentNode);var f=testgetArrIndex(b,e);var a=[];for(g=0;g<b.length;g++){if(!a[g]){a[g]=[]}j=0;var d=0;while(j<b[g].length){if(j==f[1]){var h=isNaN(e.colSpan)?1:e.colSpan;j+=h}else{a[g][d]=b[g][j];d++;j++}}}this._InstallTableMap(a,e.parentNode.parentNode)};FCKTableHandler.InsertCell=function(a,d){var c=null;var b=this.GetSelectedCells();if(b&&b.length){c=b[d?0:(b.length-1)]}if(!c){return null}var e=FCK.EditorDocument.createElement("TD");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(e)}if(!d&&c.cellIndex==c.parentNode.cells.length-1){c.parentNode.appendChild(e)}else{c.parentNode.insertBefore(e,d?c:c.nextSibling)}return e};FCKTableHandler.DeleteCell=function(a){if(a.parentNode.cells.length==1){FCKTableHandler.DeleteRows(FCKTools.GetElementAscensor(a,"TR"));return}a.parentNode.removeChild(a)};FCKTableHandler.DeleteCells=function(){var a=FCKTableHandler.GetSelectedCells();for(var b=a.length-1;b>=0;b--){FCKTableHandler.DeleteCell(a[b])}};FCKTableHandler._MarkCells=function(b,a){for(var c=0;c<b.length;c++){b[c][a]=true}};FCKTableHandler._UnmarkCells=function(b,a){for(var c=0;c<b.length;c++){if(FCKBrowserInfo.IsIE){b[c].removeAttribute(a)}else{delete b[c][a]}}};FCKTableHandler._ReplaceCellsByMarker=function(e,b,a){for(var d=0;d<e.length;d++){for(var c=0;c<e[d].length;c++){if(e[d][c][b]){e[d][c]=a}}}};FCKTableHandler._GetMarkerGeometry=function(b,a,d,f){var g=0;var k=0;var h=0;var e=0;for(var c=d;b[a][c]&&b[a][c][f];c++){g++}for(var c=d-1;b[a][c]&&b[a][c][f];c--){g++;h++}for(var c=a;b[c]&&b[c][d]&&b[c][d][f];c++){k++}for(var c=a-1;b[c]&&b[c][d]&&b[c][d][f];c--){k++;e++}return{"width":g,"height":k,"x":h,"y":e}};FCKTableHandler.CheckIsSelectionRectangular=function(){var b=FCKTableHandler.GetSelectedCells();if(b.length<1){return false}this._MarkCells(b,"_CellSelected");var i=this._CreateTableMap(b[0].parentNode.parentNode);var d=b[0].parentNode.rowIndex;var h=this._GetCellIndexSpan(i,d,b[0]);var f=this._GetMarkerGeometry(i,d,h,"_CellSelected");var a=h-f.x;var e=d-f.y;if(f.width>=f.height){for(h=a;h<a+f.width;h++){d=e+(h-a)%f.height;if(!i[d]||!i[d][h]){this._UnmarkCells(b,"_CellSelected");return false}var c=this._GetMarkerGeometry(i,d,h,"_CellSelected");if(c.width!=f.width||c.height!=f.height){this._UnmarkCells(b,"_CellSelected");return false}}}else{for(d=e;d<e+f.height;d++){h=a+(d-e)%f.width;if(!i[d]||!i[d][h]){this._UnmarkCells(b,"_CellSelected");return false}var c=this._GetMarkerGeometry(i,d,h,"_CellSelected");if(c.width!=f.width||c.height!=f.height){this._UnmarkCells(b,"_CellSelected");return false}}}this._UnmarkCells(b,"_CellSelected");return true};FCKTableHandler.MergeCells=function(){var o=this.GetSelectedCells();if(o.length<2){return}var c=o[0];var e=this._CreateTableMap(c.parentNode.parentNode);var b=c.parentNode.rowIndex;var l=this._GetCellIndexSpan(e,b,c);this._MarkCells(o,"_SelectedCells");var a=this._GetMarkerGeometry(e,b,l,"_SelectedCells");var p=l-a.x;var m=b-a.y;var h=FCKTools.GetElementDocument(c).createDocumentFragment();for(var k=0;k<a.height;k++){var d=0;for(var g=0;g<a.width;g++){var n=e[m+k][p+g];while(n.childNodes.length>0){var f=n.removeChild(n.firstChild);if(f.nodeType!=1||(f.getAttribute("type",2)!="_moz"&&f.getAttribute("_moz_dirty")!=null)){h.appendChild(f);d++}}}if(d>0){h.appendChild(FCKTools.GetElementDocument(c).createElement("br"))}}this._ReplaceCellsByMarker(e,"_SelectedCells",c);this._UnmarkCells(o,"_SelectedCells");this._InstallTableMap(e,c.parentNode.parentNode);c.appendChild(h);if(FCKBrowserInfo.IsGeckoLike&&(!c.firstChild)){FCKTools.AppendBogusBr(c)}this._MoveCaretToCell(c,false)};FCKTableHandler.MergeRight=function(){var d=this.GetMergeRightTarget();if(d==null){return}var c=d.refCell;var e=d.tableMap;var a=d.nextCell;var b=FCK.EditorDocument.createDocumentFragment();while(a&&a.childNodes&&a.childNodes.length>0){b.appendChild(a.removeChild(a.firstChild))}a.parentNode.removeChild(a);c.appendChild(b);this._MarkCells([a],"_Replace");this._ReplaceCellsByMarker(e,"_Replace",c);this._InstallTableMap(e,c.parentNode.parentNode);this._MoveCaretToCell(c,false)};FCKTableHandler.MergeDown=function(){var d=this.GetMergeDownTarget();if(d==null){return}var c=d.refCell;var e=d.tableMap;var a=d.nextCell;var b=FCKTools.GetElementDocument(c).createDocumentFragment();while(a&&a.childNodes&&a.childNodes.length>0){b.appendChild(a.removeChild(a.firstChild))}if(b.firstChild){b.insertBefore(FCKTools.GetElementDocument(a).createElement("br"),b.firstChild)}c.appendChild(b);this._MarkCells([a],"_Replace");this._ReplaceCellsByMarker(e,"_Replace",c);this._InstallTableMap(e,c.parentNode.parentNode);this._MoveCaretToCell(c,false)};FCKTableHandler.HorizontalSplitCell=function(){var c=FCKTableHandler.GetSelectedCells();if(c.length!=1){return}var q=c[0];var t=q.rowSpan;var m=this._CreateTableMap(q.parentNode.parentNode);var a=q.parentNode.rowIndex;var l=FCKTableHandler._GetCellIndexSpan(m,a,q);var h=isNaN(q.colSpan)?1:q.colSpan;if(h>1){var u=Math.ceil(h/2);var k=FCKTools.GetElementDocument(q).createElement("td");if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(k)}var f=l+u;var v=l+h;var d=isNaN(q.rowSpan)?1:q.rowSpan;for(var n=a;n<a+d;n++){for(var s=f;s<v;s++){m[n][s]=k}}}else{var o=1;var e=[];for(var s=0;s<m.length;s++){var b=m[s].slice(0,l);if(m[s].length<=l){e.push(b);continue}if(m[s][l]==q){b.push(q);var g=FCKTools.GetElementDocument(q).createElement("td");b.push(g);if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(b[b.length-1])}if(t>1){b[b.length-1]._dirowspan=t;b[b.length-1].nTdType=o;o=0}}else{b.push(m[s][l]);b.push(m[s][l])}for(var p=l+1;p<m[s].length;p++){b.push(m[s][p])}e.push(b)}m=e}this._InstallTableMap(m,q.parentNode.parentNode)};FCKTableHandler.VerticalSplitCell=function(){var o=FCKTableHandler.GetSelectedCells();if(o.length!=1){return}var l=o[0];var b=this._CreateTableMap(l.parentNode.parentNode);var k=FCKTableHandler._GetCellIndexSpan(b,l.parentNode.rowIndex,l);var m=l.rowSpan;var e=l.colSpan;var f=l.parentNode.rowIndex;if(isNaN(m)){m=1}if(m>1){l.rowSpan=Math.ceil(m/2);var q=f+Math.ceil(m/2);var a=null;for(var d=k+1;d<b[q].length;d++){if(b[q][d].parentNode.rowIndex==q){a=b[q][d];break}}var c=FCK.EditorDocument.createElement("td");c.rowSpan=Math.floor(m/2);if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(c)}if(e>1){c.colSpan=e}l.parentNode.parentNode.rows[q].insertBefore(c,a)}else{var q=f+1;var n=FCK.EditorDocument.createElement("tr");var p=l.parentNode.parentNode;if(p.rows.length>q){p.insertBefore(n,p.rows[q])}else{p.appendChild(n)}for(var d=0;d<b[f].length;){var g=b[f][d].colSpan;if(isNaN(g)||g<1){g=1}if(d==k){d+=g;continue}var h=b[f][d].rowSpan;if(isNaN(h)){h=1}b[f][d].rowSpan=h+1;d+=g}var c=FCK.EditorDocument.createElement("td");if(e>1){c.colSpan=e}if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(c)}n.appendChild(c)}};FCKTableHandler._GetCellIndexSpan=function(f,e,a){if(f.length<e+1){return null}var b=f[e];for(var d=0;d<b.length;d++){if(b[d]==a){return d}}return null};FCKTableHandler._GetCellLocation=function(e,a){for(var b=0;b<e.length;b++){for(var d=0;d<e[b].length;d++){if(e[b][d]==a){return[b,d]}}}return null};FCKTableHandler._GetColumnCells=function(e,c){var a=new Array();for(var d=0;d<e.length;d++){var b=e[d][c];if(b&&(a.length==0||a[a.length-1]!=b)){a[a.length]=b}}return a};FCKTableHandler._CreateTableMap=function(o){var n=o.rows;var a=-1;var m=[];for(var f=0;f<n.length;f++){a++;if(!m[a]){m[a]=new Array()}var l=-1;for(var e=0;e<n[f].cells.length;e++){var k=n[f].cells[e];l++;while(m[a][l]){l++}var d=isNaN(k.colSpan)?1:k.colSpan;var g=isNaN(k.rowSpan)?1:k.rowSpan;for(var b=0;b<g;b++){if(!m[a+b]){m[a+b]=new Array()}for(var h=0;h<d;h++){m[a+b][l+h]=n[f].cells[e]}}l+=d-1}}return m};FCKTableHandler._InstallTableMap=function(a,g){var d=FCKBrowserInfo.IsIE?"_fckrowspan":"rowSpan";while(g.rows.length>0){var k=g.rows[0];k.parentNode.removeChild(k)}for(var c=0;c<a.length;c++){for(var b=0;b<a[c].length;b++){var f=a[c][b];if(f.parentNode){f.parentNode.removeChild(f)}f.colSpan=f[d]=1;if(!isNaN(f["_dirowspan"])){f[d]=f["_dirowspan"];f.colSpan=1}}}var h=0;for(var c=0;c<a.length;c++){for(var b=0;b<a[c].length;b++){var f=a[c][b];if(!f){continue}if(b>h){h=b}if(f._colScanned===true){continue}if(a[c][b-1]==f){f.colSpan++}if(a[c][b+1]!=f){f._colScanned=true}}}for(var c=0;c<=h;c++){for(var b=0;b<a.length;b++){if(!a[b]){continue}var f=a[b][c];if(!f||f._rowScanned===true){continue}if(a[b-1]&&a[b-1][c]==f){f[d]++}if(!a[b+1]||a[b+1][c]!=f){f._rowScanned=true}}}for(var c=0;c<a.length;c++){for(var b=0;b<a[c].length;b++){var f=a[c][b];FCKDomTools.RemoveAttr(f,"_colScanned");FCKDomTools.RemoveAttr(f,"_rowScanned")}}for(var c=0;c<a.length;c++){var e=FCKTools.GetElementDocument(g).createElement("tr");for(var b=0;b<a[c].length;){var f=a[c][b];if(a[c-1]&&a[c-1][b]==f){b+=f.colSpan;continue}if(f["nTdType"]!=0){e.appendChild(f)}if(d!="rowSpan"){if(!isNaN(f[d])){f.rowSpan=f[d];f["_dirowspan"]=1;FCKDomTools.RemoveAttr(f,"_dirowspan");FCKDomTools.RemoveAttr(f,d)}}b+=f.colSpan;if(f.colSpan==1){FCKDomTools.RemoveAttr(f,"colspan")}if(f.rowSpan==1){FCKDomTools.RemoveAttr(f,"rowspan")}}if(a[c].length!=0){g.appendChild(e)}}FCK.ReDrawTable(g)};FCKTableHandler._MoveCaretToCell=function(c,b){var a=new FCKDomRange(FCK.EditorWindow);a.MoveToNodeContents(c);a.Collapse(b);a.Select()};FCKTableHandler.ClearRow=function(c){var a=c.cells;for(var b=0;b<a.length;b++){a[b].innerHTML="";if(FCKBrowserInfo.IsGeckoLike){FCKTools.AppendBogusBr(a[b])}}};FCKTableHandler.GetMergeRightTarget=function(){var i=this.GetSelectedCells();if(i.length!=1){return null}var c=i[0];var d=this._CreateTableMap(c.parentNode.parentNode);var b=c.parentNode.rowIndex;var f=this._GetCellIndexSpan(d,b,c);var g=f+(isNaN(c.colSpan)?1:c.colSpan);var h=d[b][g];if(!h){return null}this._MarkCells([c,h],"_SizeTest");var e=this._GetMarkerGeometry(d,b,f,"_SizeTest");var a=this._GetMarkerGeometry(d,b,g,"_SizeTest");this._UnmarkCells([c,h],"_SizeTest");if(e.height!=a.height||e.y!=a.y){return null}return{"refCell":c,"nextCell":h,"tableMap":d}};FCKTableHandler.GetMergeDownTarget=function(){var i=this.GetSelectedCells();if(i.length!=1){return null}var c=i[0];var d=this._CreateTableMap(c.parentNode.parentNode);var b=c.parentNode.rowIndex;var g=this._GetCellIndexSpan(d,b,c);var e=b+(isNaN(c.rowSpan)?1:c.rowSpan);if(!d[e]){return null}var h=d[e][g];if(!h){return null}this._MarkCells([c,h],"_SizeTest");var f=this._GetMarkerGeometry(d,b,g,"_SizeTest");var a=this._GetMarkerGeometry(d,e,g,"_SizeTest");this._UnmarkCells([c,h],"_SizeTest");if(f.width!=a.width||f.x!=a.x){return null}return{"refCell":c,"nextCell":h,"tableMap":d}};FCKTableHandler.GetSelectedCells=function(){var a=[];if(window.getSelection){var e=FCKSelection.GetSelection();if(e.rangeCount==1&&e.anchorNode.nodeType==3){var f=FCKTools.GetElementAscensor(e.anchorNode,"TD,TH");if(f){a[0]=f}return a}for(var c=0;c<e.rangeCount;c++){var g=e.getRangeAt(c);var b;if(g.startContainer.tagName.Equals("TD","TH")){b=g.startContainer}else{b=g.startContainer.childNodes[g.startOffset]}if(b.tagName.Equals("TD","TH")){a[a.length]=b}}return a}else{if(FCKSelection.GetType()=="Control"){var h=FCKSelection.MoveToAncestorNode("TD");return h?[h]:[]}var g=FCKSelection.GetSelectionRange();var f=FCKSelection.GetParentElement();if(f&&f.tagName.Equals("TD","TH")){a[0]=f}else{f=FCKSelection.MoveToAncestorNode("TABLE");if(f){for(var c=0;c<f.cells.length;c++){var d=FCK.EditorDocument.body.createTextRange();d.moveToElementText(f.cells[c]);if(g.inRange(d)||(g.compareEndPoints("StartToStart",d)>=0&&g.compareEndPoints("StartToEnd",d)<=0)||(g.compareEndPoints("EndToStart",d)>=0&&g.compareEndPoints("EndToEnd",d)<=0)){a[a.length]=f.cells[c]}}}}return a}};
//version 2.6.4 code start
var FCKXml=function(){this.Error=false};FCKXml.GetAttribute=function(c,d,b){var a=c.attributes.getNamedItem(d);return a?a.value:b};FCKXml.TransformToObject=function(e){if(!e){return null}var d={};var c=e.attributes;for(var f=0;f<c.length;f++){var g=c[f];d[g.name]=g.value}var j=e.childNodes;for(f=0;f<j.length;f++){var a=j[f];if(a.nodeType==1){var h="$"+a.nodeName;var b=d[h];if(!b){b=d[h]=[]}b.push(this.TransformToObject(a))}}return d},FCKXml.prototype={LoadUrl:function(c){this.Error=false;if(FCKBrowserInfo.IsGecko){this.Error=false;var a;var d=FCKTools.CreateXmlObject("XmlHttp");d.open("GET",c,false);d.send(null);if(d.status==200||d.status==304||(d.status==0&&d.readyState==4)){a=d.responseXML;if(!a){a=(new DOMParser()).parseFromString(d.responseText,"text/xml")}}else{a=null}if(a){try{a.firstChild}catch(b){a=(new DOMParser()).parseFromString(d.responseText,"text/xml")}}if(!a||!a.firstChild){this.Error=true;if(window.confirm('Error loading "'+c+'" (HTTP Status: '+d.status+").\r\nDo you want to see the server response dump?")){alert(d.responseText)}}this.DOMDocument=a}else{var d=FCKTools.CreateXmlObject("XmlHttp");if(!d){this.Error=true;return}d.open("GET",c,false);if(FCKBrowserInfo.IsIE10){try{d.responseType="msxml-document"}catch(b){}}d.send(null);if(d.status==200||d.status==304||(d.status==0&&d.readyState==4)){this.DOMDocument=d.responseXML;if(!this.DOMDocument||this.DOMDocument.firstChild==null){this.DOMDocument=FCKTools.CreateXmlObject("DOMDocument");this.DOMDocument.async=false;this.DOMDocument.resolveExternals=false;this.DOMDocument.loadXML(d.responseText)}}else{this.DOMDocument=null}if(this.DOMDocument==null||this.DOMDocument.firstChild==null){this.Error=true;if(window.confirm('Error loading "'+c+'"\r\nDo you want to see more info?')){alert('URL requested: "'+c+'"\r\n'+"Server response:\r\nStatus: "+d.status+"\r\n"+"Response text:\r\n"+d.responseText)}}}},SelectNodes:function(b,a){if(this.Error){return new Array()}if(FCKBrowserInfo.IsGecko){var d=new Array();var c=this.DOMDocument.evaluate(b,a?a:this.DOMDocument,this.DOMDocument.createNSResolver(this.DOMDocument.documentElement),XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(c){var e=c.iterateNext();while(e){d[d.length]=e;e=c.iterateNext()}}return d}else{if(a){return a.selectNodes(b)}else{return this.DOMDocument.selectNodes(b)}}},SelectSingleNode:function(b,a){if(this.Error){return null}if(FCKBrowserInfo.IsIE11){if(a){return a.querySelector(b)}else{return this.DOMDocument.querySelector(b)}}else{if(FCKBrowserInfo.IsGecko){var c;if(this.DOMDocument.querySelector){c=this.DOMDocument.querySelector(b)}else{c=this.DOMDocument.evaluate(b,a?a:this.DOMDocument,this.DOMDocument.createNSResolver(this.DOMDocument.documentElement),9,null)}if(c&&c.singleNodeValue){return c.singleNodeValue}else{return null}}else{if(a){return a.selectSingleNode(b)}else{return this.DOMDocument.selectSingleNode(b)}}}}};
var FCKNamedCommand=function(A){this.Name=A;};FCKNamedCommand.prototype.Execute=function(){FCK.ExecuteNamedCommand(this.Name);};FCKNamedCommand.prototype.GetState=function(){if (FCK.EditMode!=0) return -1;return FCK.GetNamedCommandState(this.Name);};
var FCKStyleCommand=function(){};FCKStyleCommand.prototype={Name:'Style',Execute:function(A,B){FCKUndo.SaveUndoStep();if (B.Selected) FCK.Styles.RemoveStyle(B.Style);else FCK.Styles.ApplyStyle(B.Style);FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent('OnSelectionChange');},GetState:function(){if (FCK.EditMode!=0||!FCK.EditorDocument) return -1;if (FCKSelection.GetType()=='Control'){var A=FCKSelection.GetSelectedElement();if (!A||!FCKStyles.CheckHasObjectStyle(A.nodeName.toLowerCase())) return -1;};return 0;}};
//version 2.6.4 code end
var FCKDialogCommand=function(d,h,c,e,a,b,g,f){this.Name=d;this.Title=h;this.Url=c;this.Width=e;this.Height=a;this.CustomValue=f;this.GetStateFunction=b;this.GetStateParam=g;this.Resizable=false};FCKDialogCommand.prototype.Execute=function(){FCKDialog.OpenDialog("FCKDialog_"+this.Name,this.Title,this.Url,this.Width,this.Height,this.CustomValue,null,this.Resizable)};FCKDialogCommand.prototype.GetState=function(){if(this.GetStateFunction){return this.GetStateFunction(this.GetStateParam)}else{return FCK.EditMode==FCK_EDITMODE_WYSIWYG?FCK_TRISTATE_OFF:FCK_TRISTATE_DISABLED}};var FCKUndefinedCommand=function(){this.Name="Undefined"};FCKUndefinedCommand.prototype.Execute=function(){alert(FCKLang.NotImplemented)};FCKUndefinedCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF};var FCKFormatBlockCommand=function(){};FCKFormatBlockCommand.prototype={Name:"FormatBlock",Execute:FCKStyleCommand.prototype.Execute,GetState:function(){return FCK.EditorDocument?FCK_TRISTATE_OFF:FCK_TRISTATE_DISABLED}};var FCKFontNameCommand=function(){};FCKFontNameCommand.prototype={Name:"FontName",Execute:FCKStyleCommand.prototype.Execute,GetState:FCKFormatBlockCommand.prototype.GetState};var FCKFontSizeCommand=function(){};FCKFontSizeCommand.prototype={Name:"FontSize",Execute:FCKStyleCommand.prototype.Execute,GetState:FCKFormatBlockCommand.prototype.GetState};var FCKPreviewCommand=function(){this.Name="Preview"};FCKPreviewCommand.prototype.Execute=function(){FCK.Preview()};FCKPreviewCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF};var FCKSaveCommand=function(){this.Name="Save"};FCKSaveCommand.prototype.Execute=function(){var b=FCK.GetParentForm();if(typeof(b.onsubmit)=="function"){var a=b.onsubmit();if(a!=null&&a===false){return}}if(typeof(b.submit)=="function"){b.submit()}else{b.submit.click()}};FCKSaveCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF};var FCKNewPageCommand=function(){this.Name="NewPage"};FCKNewPageCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();FCK.SetData("");FCKUndo.Typing=true;FCK.Focus()};FCKNewPageCommand.prototype.GetState=function(){return FCK_TRISTATE_OFF};var FCKSourceCommand=function(){this.Name="Source"};FCKSourceCommand.prototype.Execute=function(){if(FCK.EditMode==0){var a=["ok","save","preview"];for(var b=0;b<a.length;b++){var f=window.parent.document.getElementsByName(a[b]);for(var c=0;c<f.length;c++){f[c].disabled="disabled"}}}else{var a=["ok","save","preview"];for(var b=0;b<a.length;b++){var f=window.parent.document.getElementsByName(a[b]);for(var c=0;c<f.length;c++){f[c].removeAttribute("disabled")}}}if(FCKConfig.SourcePopup){var d=FCKConfig.ScreenWidth*0.65;var e=FCKConfig.ScreenHeight*0.65;FCKDialog.OpenDialog("FCKDialog_Source",FCKLang.Source,"dialog/fck_source.html",d,e,null,null,true)}else{FCK.SwitchEditMode()}};FCKSourceCommand.prototype.GetState=function(){return(FCK.EditMode==FCK_EDITMODE_WYSIWYG?FCK_TRISTATE_OFF:FCK_TRISTATE_ON)};var FCKUndoCommand=function(){this.Name="Undo"};FCKUndoCommand.prototype.Execute=function(){FCKUndo.Undo()};FCKUndoCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return(FCKUndo.CheckUndoState()?FCK_TRISTATE_OFF:FCK_TRISTATE_DISABLED)};var FCKRedoCommand=function(){this.Name="Redo"};FCKRedoCommand.prototype.Execute=function(){FCKUndo.Redo()};FCKRedoCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return(FCKUndo.CheckRedoState()?FCK_TRISTATE_OFF:FCK_TRISTATE_DISABLED)};var FCKPageBreakCommand=function(){this.Name="PageBreak"};FCKPageBreakCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();var c=FCK.EditorDocument.createElement("DIV");c.style.pageBreakAfter="always";c.innerHTML='<span style="DISPLAY:none">&nbsp;</span>';var b=FCKDocumentProcessor_CreateFakeImage("FCK__PageBreak",c);var d=new FCKDomRange(FCK.EditorWindow);d.MoveToSelection();var a=d.SplitBlock();d.InsertNode(b);FCK.Events.FireEvent("OnSelectionChange")};FCKPageBreakCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return 0};var FCKUnlinkCommand=function(){this.Name="Unlink"};FCKUnlinkCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();if(FCKBrowserInfo.IsGeckoLike){var a=FCK.Selection.MoveToAncestorNode("A");if(a){FCKTools.RemoveOuterTags(a)}return}FCK.ExecuteNamedCommand(this.Name)};FCKUnlinkCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}var b=FCK.GetNamedCommandState(this.Name);if(b==FCK_TRISTATE_OFF&&FCK.EditMode==FCK_EDITMODE_WYSIWYG){var c=FCKSelection.MoveToAncestorNode("A");var a=(c&&c.name.length>0&&c.href.length==0);if(a){b=FCK_TRISTATE_DISABLED}}return b};var FCKSelectAllCommand=function(){this.Name="SelectAll"};FCKSelectAllCommand.prototype.Execute=function(){if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){FCK.ExecuteNamedCommand("SelectAll")}else{var a=FCK.EditingArea.Textarea;if(FCKBrowserInfo.IsIE){a.createTextRange().execCommand("SelectAll")}else{a.selectionStart=0;a.selectionEnd=a.value.length}a.focus()}};FCKSelectAllCommand.prototype.GetState=function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return FCK_TRISTATE_OFF};var FCKPasteCommand=function(){this.Name="Paste"};FCKPasteCommand.prototype={Execute:function(){if(FCKBrowserInfo.IsIE){FCK.Paste()}else{FCK.ExecuteNamedCommand("Paste")}},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return FCK.GetNamedCommandState("Paste")}};var FCKRuleCommand=function(){this.Name="Rule"};FCKRuleCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();FCK.InsertElement("hr")},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return FCK.GetNamedCommandState("InsertHorizontalRule")}};var FCKCutCopyCommand=function(a){this.Name=a?"Cut":"Copy"};FCKCutCopyCommand.prototype={Execute:function(){var b=false;if(FCKBrowserInfo.IsIE){var d=function(){b=true};var a="on"+this.Name.toLowerCase();FCK.EditorDocument.body.attachEvent(a,d);FCK.ExecuteNamedCommand(this.Name);FCK.EditorDocument.body.detachEvent(a,d)}else{try{FCK.ExecuteNamedCommand(this.Name);b=true}catch(c){}}if(!b){alert(FCKLang["PasteError"+this.Name])}},GetState:function(){return FCK.EditMode!=FCK_EDITMODE_WYSIWYG?FCK_TRISTATE_DISABLED:FCK.GetNamedCommandState("Cut")}};var FCKAnchorDeleteCommand=function(){this.Name="AnchorDelete"};FCKAnchorDeleteCommand.prototype={Execute:function(){if(FCK.Selection.GetType()=="Control"){FCK.Selection.Delete()}else{var a=FCK.Selection.GetSelectedElement();if(a){if(a.tagName=="IMG"&&a.getAttribute("_fckanchor")){oAnchor=FCK.GetRealElement(a)}else{a=null}}if(!a){oAnchor=FCK.Selection.MoveToAncestorNode("A");if(oAnchor){FCK.Selection.SelectNode(oAnchor)}}if(oAnchor.href.length!=0){oAnchor.removeAttribute("name");if(FCKBrowserInfo.IsIE){oAnchor.className=oAnchor.className.replace(FCKRegexLib.FCK_Class,"")}return}if(a){a.parentNode.removeChild(a);return}if(oAnchor.innerHTML.length==0){oAnchor.parentNode.removeChild(oAnchor);return}FCKTools.RemoveOuterTags(oAnchor)}if(FCKBrowserInfo.IsGecko){FCK.Selection.Collapse(true)}},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return FCK.GetNamedCommandState("Unlink")}};var FCKUpdateAttachCommand=function(){this.Name="UpdateAttach"};FCKUpdateAttachCommand.prototype.Execute=function(){FCKDialog.OpenDialog("UpdateAttach",FCKLang.UpdateAttach,"dialog/UpdateAttach.jsp",600,260)};FCKUpdateAttachCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1}var a=-1;var c=FCKSelection.MoveToAncestorNode("A");if(c){if(c.getAttribute("href",2)){var b=c.getAttribute("href",2);if(b.indexOf("attach/")!=-1){a=0}}}return a};var TableRedrawCommand=function(){this.Name="TableRedraw"};TableRedrawCommand.prototype.Execute=function(){FCKDialog.OpenDialog("TableRedraw",FCKLang.TableRedraw,"dialog/fck_tableredraw.html",715,300)};TableRedrawCommand.prototype.GetState=function(){if(FCK.EditMode!=0){return -1}var a=-1;B=FCKSelection.HasAncestorNode("TABLE");if(B){a=0}return a};
//version 2.6.4 code start
var FCKShowBlockCommand=function(A,B){this.Name=A;if (B!=undefined) this._SavedState=B;else this._SavedState=null;};FCKShowBlockCommand.prototype.Execute=function(){var A=this.GetState();if (A==-1) return;var B=FCK.EditorDocument.body;if (A==1) B.className=B.className.replace(/(^| )FCK__ShowBlocks/g,'');else B.className+=' FCK__ShowBlocks';if (FCKBrowserInfo.IsIE){try{FCK.EditorDocument.selection.createRange().select();}catch (e){}}else{var C=FCK.EditorWindow.getSelection().focusNode;if (C){if (C.nodeType!=1) C=C.parentNode;FCKDomTools.ScrollIntoView(C,false);}};FCK.Events.FireEvent('OnSelectionChange');};FCKShowBlockCommand.prototype.GetState=function(){if (FCK.EditMode!=0) return -1;if (!FCK.EditorDocument) return 0;if (/FCK__ShowBlocks(?:\s|$)/.test(FCK.EditorDocument.body.className)) return 1;return 0;};FCKShowBlockCommand.prototype.SaveState=function(){this._SavedState=this.GetState();};FCKShowBlockCommand.prototype.RestoreState=function(){if (this._SavedState!=null&&this.GetState()!=this._SavedState) this.Execute();};
var FCKSpellCheckCommand=function(){this.Name='SpellCheck';this.IsEnabled=true;};FCKSpellCheckCommand.prototype.Execute=function(){switch (FCKConfig.SpellChecker){case 'ieSpell':this._RunIeSpell();break;case 'SpellerPages':FCKDialog.OpenDialog('FCKDialog_SpellCheck','Spell Check','dialog/fck_spellerpages.html',440,480);break;case 'WSC':FCKDialog.OpenDialog('FCKDialog_SpellCheck','Spell Check','wsc/w.html',530,480);}};FCKSpellCheckCommand.prototype._RunIeSpell=function(){try{var A=new ActiveXObject("ieSpell.ieSpellExtension");A.CheckAllLinkedDocuments(FCK.EditorDocument);}catch(e){if(e.number==-2146827859){if (confirm(FCKLang.IeSpellDownload)) window.open(FCKConfig.IeSpellDownloadUrl,'IeSpellDownload');}else alert('Error Loading ieSpell: '+e.message+' ('+e.number+')');}};FCKSpellCheckCommand.prototype.GetState=function(){if (FCK.EditMode!=0) return -1;return this.IsEnabled?0:-1;};
var FCKTextColorCommand=function(A){this.Name=A=='ForeColor'?'TextColor':'BGColor';this.Type=A;var B;if (FCKBrowserInfo.IsIE) B=window;else if (FCK.ToolbarSet._IFrame) B=FCKTools.GetElementWindow(FCK.ToolbarSet._IFrame);else B=window.parent;this._Panel=new FCKPanel(B);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._Panel.MainNode.className='FCK_Panel';this._CreatePanelBody(this._Panel.Document,this._Panel.MainNode);FCK.ToolbarSet.ToolbarItems.GetItem(this.Name).RegisterPanel(this._Panel);FCKTools.DisableSelection(this._Panel.Document.body);};FCKTextColorCommand.prototype.Execute=function(A,B,C){this._Panel.Show(A,B,C);};FCKTextColorCommand.prototype.SetColor=function(A){FCKUndo.SaveUndoStep();var B=FCKStyles.GetStyle('_FCK_'+(this.Type=='ForeColor'?'Color':'BackColor'));if (!A||A.length==0) FCK.Styles.RemoveStyle(B);else{B.SetVariable('Color',A);FCKStyles.ApplyStyle(B);};FCKUndo.SaveUndoStep();FCK.Focus();FCK.Events.FireEvent('OnSelectionChange');};FCKTextColorCommand.prototype.GetState=function(){if (FCK.EditMode!=0) return -1;return 0;};function FCKTextColorCommand_OnMouseOver(){this.className='ColorSelected';};function FCKTextColorCommand_OnMouseOut(){this.className='ColorDeselected';};function FCKTextColorCommand_OnClick(A,B,C){this.className='ColorDeselected';B.SetColor(C);B._Panel.Hide();};function FCKTextColorCommand_AutoOnClick(A,B){this.className='ColorDeselected';B.SetColor('');B._Panel.Hide();};function FCKTextColorCommand_MoreOnClick(A,B){this.className='ColorDeselected';B._Panel.Hide();FCKDialog.OpenDialog('FCKDialog_Color',FCKLang.DlgColorTitle,'dialog/fck_colorselector.html',410,320,FCKTools.Bind(B,B.SetColor));};FCKTextColorCommand.prototype._CreatePanelBody=function(A,B){function CreateSelectionDiv(){var C=A.createElement("DIV");C.className='ColorDeselected';FCKTools.AddEventListenerEx(C,'mouseover',FCKTextColorCommand_OnMouseOver);FCKTools.AddEventListenerEx(C,'mouseout',FCKTextColorCommand_OnMouseOut);return C;};var D=B.appendChild(A.createElement("TABLE"));D.className='ForceBaseFont';D.style.tableLayout='fixed';D.cellPadding=0;D.cellSpacing=0;D.border=0;D.width=150;var E=D.insertRow(-1).insertCell(-1);E.colSpan=8;var C=E.appendChild(CreateSelectionDiv());C.innerHTML='<table cellspacing="0" cellpadding="0" width="100%" border="0">\n			<tr>\n				<td><div class="ColorBoxBorder"><div class="ColorBox" style="background-color: #000000"></div></div></td>\n				<td nowrap width="100%" align="center">'+FCKLang.ColorAutomatic+'</td>\n			</tr>\n		</table>';FCKTools.AddEventListenerEx(C,'click',FCKTextColorCommand_AutoOnClick,this);if (!FCKBrowserInfo.IsIE) C.style.width='96%';var G=FCKConfig.FontColors.toString().split(',');var H=0;while (H<G.length){var I=D.insertRow(-1);for (var i=0;i<8;i++,H++){if (H<G.length){var J=G[H].split('/');var K='#'+J[0];var L=J[1]||K;};C=I.insertCell(-1).appendChild(CreateSelectionDiv());C.innerHTML='<div class="ColorBoxBorder"><div class="ColorBox" style="background-color: '+K+'"></div></div>';if (H>=G.length) C.style.visibility='hidden';else FCKTools.AddEventListenerEx(C,'click',FCKTextColorCommand_OnClick,[this,L]);}};if (FCKConfig.EnableMoreFontColors){E=D.insertRow(-1).insertCell(-1);E.colSpan=8;C=E.appendChild(CreateSelectionDiv());C.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td nowrap align="center">'+FCKLang.ColorMoreColors+'</td></tr></table>';FCKTools.AddEventListenerEx(C,'click',FCKTextColorCommand_MoreOnClick,this);};if (!FCKBrowserInfo.IsIE) C.style.width='96%';};
var FCKPastePlainTextCommand=function(){this.Name='PasteText';};FCKPastePlainTextCommand.prototype.Execute=function(){FCK.PasteAsPlainText();};FCKPastePlainTextCommand.prototype.GetState=function(){if (FCK.EditMode!=0) return -1;return FCK.GetNamedCommandState('Paste');};
var FCKPasteWordCommand=function(){this.Name='PasteWord';};FCKPasteWordCommand.prototype.Execute=function(){FCK.PasteFromWord();};FCKPasteWordCommand.prototype.GetState=function(){if (FCK.EditMode!=0||FCKConfig.ForcePasteAsPlainText) return -1;else return FCK.GetNamedCommandState('Paste');};
var FCKTableCommand=function(A){this.Name=A;};FCKTableCommand.prototype.Execute=function(){FCKUndo.SaveUndoStep();if (!FCKBrowserInfo.IsGecko){switch (this.Name){case 'TableMergeRight':return FCKTableHandler.MergeRight();case 'TableMergeDown':return FCKTableHandler.MergeDown();}};switch (this.Name){case 'TableInsertRowAfter':return FCKTableHandler.InsertRow(false);case 'TableInsertRowBefore':return FCKTableHandler.InsertRow(true);case 'TableDeleteRows':return FCKTableHandler.DeleteRows();case 'TableInsertColumnAfter':return FCKTableHandler.InsertColumn(false);case 'TableInsertColumnBefore':return FCKTableHandler.InsertColumn(true);case 'TableDeleteColumns':return FCKTableHandler.DeleteColumns();case 'TableInsertCellAfter':return FCKTableHandler.InsertCell(null,false);case 'TableInsertCellBefore':return FCKTableHandler.InsertCell(null,true);case 'TableDeleteCells':return FCKTableHandler.DeleteCells();case 'TableMergeCells':return FCKTableHandler.MergeCells();case 'TableHorizontalSplitCell':return FCKTableHandler.HorizontalSplitCell();case 'TableVerticalSplitCell':return FCKTableHandler.VerticalSplitCell();case 'TableDelete':return FCKTableHandler.DeleteTable();default:return alert(FCKLang.UnknownCommand.replace(/%1/g,this.Name));}};FCKTableCommand.prototype.GetState=function(){if (FCK.EditorDocument!=null&&FCKSelection.HasAncestorNode('TABLE')){switch (this.Name){case 'TableHorizontalSplitCell':case 'TableVerticalSplitCell':if (FCKTableHandler.GetSelectedCells().length==1) return 0;else return -1;case 'TableMergeCells':if (FCKTableHandler.CheckIsSelectionRectangular()&&FCKTableHandler.GetSelectedCells().length>1) return 0;else return -1;case 'TableMergeRight':return FCKTableHandler.GetMergeRightTarget()?0:-1;case 'TableMergeDown':return FCKTableHandler.GetMergeDownTarget()?0:-1;default:return 0;}}else return -1;};
var FCKFitWindow=function(){this.Name='FitWindow';};FCKFitWindow.prototype.Execute=function(){var A=window.frameElement;var B=A.style;var C=parent;var D=C.document.documentElement;var E=C.document.body;var F=E.style;var G;var H,oEditorScrollPos;if (FCK.EditMode==0){H=new FCKDomRange(FCK.EditorWindow);H.MoveToSelection();oEditorScrollPos=FCKTools.GetScrollPosition(FCK.EditorWindow);}else{var I=FCK.EditingArea.Textarea;H=!FCKBrowserInfo.IsIE&&[I.selectionStart,I.selectionEnd];oEditorScrollPos=[I.scrollLeft,I.scrollTop];};if (!this.IsMaximized){if(FCKBrowserInfo.IsIE) C.attachEvent('onresize',FCKFitWindow_Resize);else C.addEventListener('resize',FCKFitWindow_Resize,true);this._ScrollPos=FCKTools.GetScrollPosition(C);G=A;while((G=G.parentNode)){if (G.nodeType==1){G._fckSavedStyles=FCKTools.SaveStyles(G);G.style.zIndex=FCKConfig.FloatingPanelsZIndex-1;}};if (FCKBrowserInfo.IsIE){this.documentElementOverflow=D.style.overflow;D.style.overflow='hidden';F.overflow='hidden';}else{F.overflow='hidden';F.width='0px';F.height='0px';};this._EditorFrameStyles=FCKTools.SaveStyles(A);var J=FCKTools.GetViewPaneSize(C);B.position="absolute";A.offsetLeft;B.zIndex=FCKConfig.FloatingPanelsZIndex-1;B.left="0px";B.top="0px";B.width=J.Width+"px";B.height=J.Height+"px";if (!FCKBrowserInfo.IsIE){B.borderRight=B.borderBottom="9999px solid white";B.backgroundColor="white";};C.scrollTo(0,0);var K=FCKTools.GetWindowPosition(C,A);if (K.x!=0) B.left=(-1*K.x)+"px";if (K.y!=0) B.top=(-1*K.y)+"px";this.IsMaximized=true;}else{if(FCKBrowserInfo.IsIE) C.detachEvent("onresize",FCKFitWindow_Resize);else C.removeEventListener("resize",FCKFitWindow_Resize,true);G=A;while((G=G.parentNode)){if (G._fckSavedStyles){FCKTools.RestoreStyles(G,G._fckSavedStyles);G._fckSavedStyles=null;}};if (FCKBrowserInfo.IsIE) D.style.overflow=this.documentElementOverflow;FCKTools.RestoreStyles(A,this._EditorFrameStyles);C.scrollTo(this._ScrollPos.X,this._ScrollPos.Y);this.IsMaximized=false;};FCKToolbarItems.GetItem('FitWindow').RefreshState();if (FCK.EditMode==0) FCK.EditingArea.MakeEditable();FCK.Focus();if (FCK.EditMode==0){H.Select();FCK.EditorWindow.scrollTo(oEditorScrollPos.X,oEditorScrollPos.Y);}else{if (!FCKBrowserInfo.IsIE){I.selectionStart=H[0];I.selectionEnd=H[1];};I.scrollLeft=oEditorScrollPos[0];I.scrollTop=oEditorScrollPos[1];}};FCKFitWindow.prototype.GetState=function(){if (FCKConfig.ToolbarLocation!='In') return -1;else return (this.IsMaximized?1:0);};function FCKFitWindow_Resize(){var A=FCKTools.GetViewPaneSize(parent);var B=window.frameElement.style;B.width=A.Width+'px';B.height=A.Height+'px';};
var FCKListCommand=function(a,b){this.Name=a;this.TagName=b};FCKListCommand.prototype={GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG||!FCK.EditorWindow){return FCK_TRISTATE_DISABLED}var b=FCKSelection.GetBoundaryParentElement(true);var a=b;while(a){if(a.nodeName.IEquals(["ul","ol"])){break}a=a.parentNode}if(a&&a.nodeName.IEquals(this.TagName)){return FCK_TRISTATE_ON}else{return FCK_TRISTATE_OFF}},Execute:function(){FCKUndo.SaveUndoStep();var y=FCK.EditorDocument;var m=new FCKDomRange(FCK.EditorWindow);m.MoveToSelection();var c=this.GetState();if(c==FCK_TRISTATE_OFF){FCKDomTools.TrimNode(y.body);if(!y.body.firstChild){var x=y.createElement("p");y.body.appendChild(x);m.MoveToNodeContents(x)}}var j=m.CreateBookmark();var w=[];var t={};var p=new FCKDomRangeIterator(m);var l;p.ForceBrBreak=(c==FCK_TRISTATE_OFF);var v=true;var k=null;while(v){while((l=p.GetNextParagraph())){var o=new FCKElementPath(l);var d=null;var h=false;var e=o.BlockLimit;for(var u=o.Elements.length-1;u>=0;u--){var a=o.Elements[u];if(a.nodeName.IEquals(["ol","ul"])){if(e._FCK_ListGroupObject){e._FCK_ListGroupObject=null}var g=a._FCK_ListGroupObject;if(g){g.contents.push(l)}else{g={"root":a,"contents":[l]};w.push(g);FCKDomTools.SetElementMarker(t,a,"_FCK_ListGroupObject",g)}h=true;break}}if(h){continue}var r=e;if(r._FCK_ListGroupObject){r._FCK_ListGroupObject.contents.push(l)}else{var g={"root":r,"contents":[l]};FCKDomTools.SetElementMarker(t,r,"_FCK_ListGroupObject",g);w.push(g)}}if(FCKBrowserInfo.IsIE){v=false}else{if(k==null){k=[];var s=FCKSelection.GetSelection();if(s&&w.length==0){k.push(s.getRangeAt(0))}for(var u=1;s&&u<s.rangeCount;u++){k.push(s.getRangeAt(u))}}if(k.length<1){v=false}else{var n=FCKW3CRange.CreateFromRange(y,k.shift());m._Range=n;m._UpdateElementInfo();if(m.StartNode.nodeName.IEquals("td")){m.SetStart(m.StartNode,1)}if(m.EndNode.nodeName.IEquals("td")){m.SetEnd(m.EndNode,2)}p=new FCKDomRangeIterator(m);p.ForceBrBreak=(c==FCK_TRISTATE_OFF)}}}var f=[];while(w.length>0){var g=w.shift();if(c==FCK_TRISTATE_OFF){if(g.root.nodeName.IEquals(["ul","ol"])){this._ChangeListType(g,t,f)}else{this._CreateList(g,f)}}else{if(c==FCK_TRISTATE_ON&&g.root.nodeName.IEquals(["ul","ol"])){this._RemoveList(g,t)}}}for(var u=0;u<f.length;u++){var d=f[u];var q=false;var b=d;while(!q){b=b.nextSibling;if(b&&b.nodeType==3&&b.nodeValue.search(/^[\n\r\t ]*$/)==0){continue}q=true}if(b&&b.nodeName.IEquals(this.TagName)){b.parentNode.removeChild(b);while(b.firstChild){d.appendChild(b.removeChild(b.firstChild))}}q=false;b=d;while(!q){b=b.previousSibling;if(b&&b.nodeType==3&&b.nodeValue.search(/^[\n\r\t ]*$/)==0){continue}q=true}if(b&&b.nodeName.IEquals(this.TagName)){b.parentNode.removeChild(b);while(b.lastChild){d.insertBefore(b.removeChild(b.lastChild),d.firstChild)}}}FCKDomTools.ClearAllMarkers(t);m.MoveToBookmark(j);m.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange")},_ChangeListType:function(h,e,k){var d=FCKDomTools.ListToArray(h.root,e);var j=[];for(var g=0;g<h.contents.length;g++){var b=h.contents[g];b=FCKTools.GetElementAscensor(b,"li");if(!b||b._FCK_ListItem_Processed){continue}j.push(b);FCKDomTools.SetElementMarker(e,b,"_FCK_ListItem_Processed",true)}var f=FCKTools.GetElementDocument(h.root).createElement(this.TagName);for(var g=0;g<j.length;g++){var c=j[g]._FCK_ListArray_Index;d[c].parent=f}var a=FCKDomTools.ArrayToList(d,e);for(var g=0;g<a.listNode.childNodes.length;g++){if(a.listNode.childNodes[g].nodeName.IEquals(this.TagName)){k.push(a.listNode.childNodes[g])}}h.root.parentNode.replaceChild(a.listNode,h.root)},_CreateList:function(k,o){var d=k.contents;var m=FCKTools.GetElementDocument(k.root);var l=[];if(d.length==1&&d[0]==k.root){var h=m.createElement("div");while(d[0].firstChild){h.appendChild(d[0].removeChild(d[0].firstChild))}d[0].appendChild(h);d[0]=h}var f=k.contents[0].parentNode;for(var j=0;j<d.length;j++){f=FCKDomTools.GetCommonParents(f,d[j].parentNode).pop()}for(var j=0;j<d.length;j++){var g=d[j];while(g.parentNode){if(g.parentNode==f){l.push(g);break}g=g.parentNode}}if(l.length<1){return}var b=l[l.length-1].nextSibling;var e=m.createElement(this.TagName);o.push(e);while(l.length){var c=l.shift();var n=m.createDocumentFragment();while(c.firstChild){n.appendChild(c.removeChild(c.firstChild))}c.parentNode.removeChild(c);var a=m.createElement("li");a=FCKDomTools.CopyAttributes(c,a);a.appendChild(n);e.appendChild(a)}f.insertBefore(e,b)},_RemoveList:function(h,f){var e=FCKDomTools.ListToArray(h.root,f);var l=[];for(var g=0;g<h.contents.length;g++){var b=h.contents[g];b=FCKTools.GetElementAscensor(b,"li");if(!b||b._FCK_ListItem_Processed){continue}l.push(b);FCKDomTools.SetElementMarker(f,b,"_FCK_ListItem_Processed",true)}var j=null;for(var g=0;g<l.length;g++){var d=l[g]._FCK_ListArray_Index;e[d].indent=-1;j=d}for(var g=j+1;g<e.length;g++){if(e[g].indent>e[g-1].indent+1){var k=e[g-1].indent+1-e[g].indent;var c=e[g].indent;while(e[g]&&e[g].indent>=c){e[g].indent+=k;g++}g--}}var a=FCKDomTools.ArrayToList(e,f);if(h.root.nextSibling==null||h.root.nextSibling.nodeName.IEquals("br")){if(a.listNode.lastChild.nodeName.IEquals("br")){a.listNode.removeChild(a.listNode.lastChild)}}h.root.parentNode.replaceChild(a.listNode,h.root)}};


var FCKJustifyCommand=function(A){this.AlignValue=A;var B=FCKConfig.ContentLangDirection.toLowerCase();this.IsDefaultAlign=(A=='left'&&B=='ltr')||(A=='right'&&B=='rtl');var C=this._CssClassName=(function(){var D=FCKConfig.JustifyClasses;if (D){switch (A){case 'left':return D[0]||null;case 'center':return D[1]||null;case 'right':return D[2]||null;case 'justify':return D[3]||null;}};return null;})();if (C&&C.length>0) this._CssClassRegex=new RegExp('(?:^|\\s+)'+C+'(?=$|\\s)');};FCKJustifyCommand._GetClassNameRegex=function(){var A=FCKJustifyCommand._ClassRegex;if (A!=undefined) return A;var B=[];var C=FCKConfig.JustifyClasses;if (C){for (var i=0;i<4;i++){var D=C[i];if (D&&D.length>0) B.push(D);}};if (B.length>0) A=new RegExp('(?:^|\\s+)(?:'+B.join('|')+')(?=$|\\s)');else A=null;return FCKJustifyCommand._ClassRegex=A;};FCKJustifyCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var A=new FCKDomRange(FCK.EditorWindow);A.MoveToSelection();var B=this.GetState();if (B==-1) return;var C=A.CreateBookmark();var D=this._CssClassName;var E=new FCKDomRangeIterator(A);var F;while ((F=E.GetNextParagraph())){F.removeAttribute('align');if (D){var G=F.className.replace(FCKJustifyCommand._GetClassNameRegex(),'');if (B==0){if (G.length>0) G+=' ';F.className=G+D;}else if (G.length==0) FCKDomTools.RemoveAttribute(F,'class');}else{var H=F.style;if (B==0) H.textAlign=this.AlignValue;else{H.textAlign='';if (H.cssText.length==0) F.removeAttribute('style');}}};A.MoveToBookmark(C);A.Select();FCK.Focus();FCK.Events.FireEvent('OnSelectionChange');},GetState:function(){if (FCK.EditMode!=0||!FCK.EditorWindow) return -1;var A=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var B=A.Block||A.BlockLimit;if (!B||B.nodeName.toLowerCase()=='body') return 0;var C;if (FCKBrowserInfo.IsIE) C=B.currentStyle.textAlign;else C=FCK.EditorWindow.getComputedStyle(B,'').getPropertyValue('text-align');C=C.replace(/(-moz-|-webkit-|start|auto)/i,'');if ((!C&&this.IsDefaultAlign)||C==this.AlignValue) return 1;return 0;}};
//version 2.6.4 code end
var FCKIndentCommand=function(a,b){this.Name=a;this.Offset=b;this.IndentCSSProperty=FCKConfig.ContentLangDirection.IEquals("ltr")?"marginLeft":"marginRight"};FCKIndentCommand._InitIndentModeParameters=function(){if(FCKConfig.IndentClasses&&FCKConfig.IndentClasses.length>0){this._UseIndentClasses=true;this._IndentClassMap={};for(var a=0;a<FCKConfig.IndentClasses.length;a++){this._IndentClassMap[FCKConfig.IndentClasses[a]]=a+1}this._ClassNameRegex=new RegExp("(?:^|\\s+)("+FCKConfig.IndentClasses.join("|")+")(?=$|\\s)")}else{this._UseIndentClasses=false}};FCKIndentCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var c=new FCKDomRange(FCK.EditorWindow);c.MoveToSelection();var e=FCKDomTools.GetCommonParentNode(c.StartNode||c.StartContainer,c.EndNode||c.EndContainer,["ul","ol"]);if(e==null){var a=new FCKDomRangeIterator(c);while((diP=a.GetNextParagraph())){if(diP.parentNode.tagName.toLowerCase()=="ul"){alert("");return}else{if(diP.parentNode.tagName.toLowerCase()=="ol"){alert("");return}}}}var d=c.CreateBookmark();var b=FCKDomTools.GetCommonParentNode(c.StartNode||c.StartContainer,c.EndNode||c.EndContainer,["ul","ol"]);if(b){this._IndentList(c,b)}else{this._IndentBlock(c)}c.MoveToBookmark(d);c.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange")},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG||!FCK.EditorWindow){return FCK_TRISTATE_DISABLED}if(FCKIndentCommand._UseIndentClasses==undefined){FCKIndentCommand._InitIndentModeParameters()}var c=FCKSelection.GetBoundaryParentElement(true);var i=FCKSelection.GetBoundaryParentElement(false);var d=FCKDomTools.GetCommonParentNode(c,i,["ul","ol"]);if(d){if(this.Name.IEquals("outdent")){return FCK_TRISTATE_OFF}var e=FCKTools.GetElementAscensor(c,"li");if(!e||!e.previousSibling){return FCK_TRISTATE_DISABLED}return FCK_TRISTATE_OFF}if(!FCKIndentCommand._UseIndentClasses&&this.Name.IEquals("indent")){return FCK_TRISTATE_OFF}var h=new FCKElementPath(c);var f=h.Block||h.BlockLimit;if(!f){return FCK_TRISTATE_DISABLED}if(FCKIndentCommand._UseIndentClasses){var a=f.className.match(FCKIndentCommand._ClassNameRegex);var g=0;if(a!=null){a=a[1];g=FCKIndentCommand._IndentClassMap[a]}if((this.Name=="outdent"&&g==0)||(this.Name=="indent"&&g==FCKConfig.IndentClasses.length)){return FCK_TRISTATE_DISABLED}return FCK_TRISTATE_OFF}else{var b=parseInt(f.style[this.IndentCSSProperty],10);if(isNaN(b)){b=0}if(b<=0){return FCK_TRISTATE_DISABLED}return FCK_TRISTATE_OFF}},_IndentBlock:function(f){var e=new FCKDomRangeIterator(f);e.EnforceRealBlocks=true;f.Expand("block_contents");var b=FCKDomTools.GetCommonParents(f.StartContainer,f.EndContainer);var d=b[b.length-1];var c;while((c=e.GetNextParagraph())){if(!(c==d||c.parentNode==d)){continue}if(FCKIndentCommand._UseIndentClasses){var a=c.className.match(FCKIndentCommand._ClassNameRegex);var i=0;if(a!=null){a=a[1];i=FCKIndentCommand._IndentClassMap[a]}if(this.Name.IEquals("outdent")){i--}else{if(this.Name.IEquals("indent")){i++}}i=Math.min(i,FCKConfig.IndentClasses.length);i=Math.max(i,0);var g=c.className.replace(FCKIndentCommand._ClassNameRegex,"");if(i<1){c.className=g}else{c.className=(g.length>0?g+" ":"")+FCKConfig.IndentClasses[i-1]}}else{var h=parseInt(c.style[this.IndentCSSProperty],10);if(isNaN(h)){h=0}h+=this.Offset;h=Math.max(h,0);h=Math.ceil(h/this.Offset)*this.Offset;c.style[this.IndentCSSProperty]=h?h+FCKConfig.IndentUnit:"";if(c.getAttribute("style")==""){c.removeAttribute("style")}}}},_IndentList:function(k,h){var d=k.StartContainer;var q=k.EndContainer;while(d&&d.parentNode!=h){d=d.parentNode}while(q&&q.parentNode!=h){q=q.parentNode}if(!d||!q){return}var f=d;var g=[];var l=false;while(l==false){if(f==q){l=true}g.push(f);f=f.nextSibling}if(g.length<1){return}var b=FCKDomTools.GetParents(h);for(var j=0;j<b.length;j++){if(b[j].nodeName.IEquals(["ul","ol"])){h=b[j];break}}var m=this.Name.IEquals("indent")?1:-1;var p=g[0];var o=g[g.length-1];var e={};var c=FCKDomTools.ListToArray(h,e);var n=c[o._FCK_ListArray_Index].indent;for(var j=p._FCK_ListArray_Index;j<=o._FCK_ListArray_Index;j++){c[j].indent+=m}for(var j=o._FCK_ListArray_Index+1;j<c.length&&c[j].indent>n;j++){c[j].indent+=m}var a=FCKDomTools.ArrayToList(c);if(a){h.parentNode.replaceChild(a.listNode,h)}FCKDomTools.ClearAllMarkers(e)}};
//version code 2.6.4 start
var FCKBlockQuoteCommand=function(){};FCKBlockQuoteCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var g=this.GetState();var q=new FCKDomRange(FCK.EditorWindow);q.MoveToSelection();var l=q.CreateBookmark();if(FCKBrowserInfo.IsIE){var o=q.GetBookmarkNode(l,true);var c=q.GetBookmarkNode(l,false);var f;if(o&&o.parentNode.nodeName.IEquals("blockquote")&&!o.previousSibling){f=o;while((f=f.nextSibling)){if(FCKListsLib.BlockElements[f.nodeName.toLowerCase()]){FCKDomTools.MoveNode(o,f,true)}}}if(c&&c.parentNode.nodeName.IEquals("blockquote")&&!c.previousSibling){f=c;while((f=f.nextSibling)){if(FCKListsLib.BlockElements[f.nodeName.toLowerCase()]){if(f.firstChild==o){FCKDomTools.InsertAfterNode(o,c)}else{FCKDomTools.MoveNode(c,f,true)}}}}}var t=new FCKDomRangeIterator(q);var m;if(g==FCK_TRISTATE_OFF){t.EnforceRealBlocks=true;var n=[];while((m=t.GetNextParagraph())){n.push(m)}if(n.length<1){para=q.Window.document.createElement(FCKConfig.EnterMode.IEquals("p")?"p":"div");q.InsertNode(para);para.appendChild(q.Window.document.createTextNode("\ufeff"));q.MoveToBookmark(l);q.MoveToNodeContents(para);q.Collapse(true);l=q.CreateBookmark();n.push(para)}var p=n[0].parentNode;var z=[];for(var x=0;x<n.length;x++){m=n[x];p=FCKDomTools.GetCommonParents(m.parentNode,p).pop()}while(p.nodeName.IEquals("table","tbody","tr","ol","ul")){p=p.parentNode}var y=null;while(n.length>0){m=n.shift();while(m.parentNode!=p){m=m.parentNode}if(m!=y){z.push(m)}y=m}while(z.length>0){m=z.shift();if(m.nodeName.IEquals("blockquote")){var b=FCKTools.GetElementDocument(m).createDocumentFragment();while(m.firstChild){b.appendChild(m.removeChild(m.firstChild));n.push(b.lastChild)}m.parentNode.replaceChild(b,m)}else{n.push(m)}}var u=q.Window.document.createElement("blockquote");p.insertBefore(u,n[0]);while(n.length>0){m=n.shift();u.appendChild(m)}}else{if(g==FCK_TRISTATE_ON){var A=[];var w={};while((m=t.GetNextParagraph())){var B=null;var r=null;while(m.parentNode){if(m.parentNode.nodeName.IEquals("blockquote")){B=m.parentNode;r=m;break}m=m.parentNode}if(B&&r&&!r._fckblockquotemoveout){A.push(r);FCKDomTools.SetElementMarker(w,r,"_fckblockquotemoveout",true)}}FCKDomTools.ClearAllMarkers(w);var a=[];var e=[],w={};var d=function(D){for(var C=0;C<D.childNodes.length;C++){if(FCKListsLib.BlockElements[D.childNodes[C].nodeName.toLowerCase()]){return false}}return true};while(A.length>0){var v=A.shift();var u=v.parentNode;if(v==v.parentNode.firstChild){u.parentNode.insertBefore(u.removeChild(v),u)}else{if(v==v.parentNode.lastChild){u.parentNode.insertBefore(u.removeChild(v),u.nextSibling)}else{FCKDomTools.BreakParent(v,v.parentNode,q)}}if(!u._fckbqprocessed){e.push(u);FCKDomTools.SetElementMarker(w,u,"_fckbqprocessed",true)}a.push(v)}for(var x=e.length-1;x>=0;x--){var h=e[x];if(d(h)){FCKDomTools.RemoveNode(h)}}FCKDomTools.ClearAllMarkers(w);if(FCKConfig.EnterMode.IEquals("br")){while(a.length){var v=a.shift();var k=true;if(v.nodeName.IEquals("div")){var b=FCKTools.GetElementDocument(v).createDocumentFragment();var s=k&&v.previousSibling&&!FCKListsLib.BlockBoundaries[v.previousSibling.nodeName.toLowerCase()];if(k&&s){b.appendChild(FCKTools.GetElementDocument(v).createElement("br"))}var j=v.nextSibling&&!FCKListsLib.BlockBoundaries[v.nextSibling.nodeName.toLowerCase()];while(v.firstChild){b.appendChild(v.removeChild(v.firstChild))}if(j){b.appendChild(FCKTools.GetElementDocument(v).createElement("br"))}v.parentNode.replaceChild(b,v);k=false}}}}}q.MoveToBookmark(l);q.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange")},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG||!FCK.EditorWindow){return FCK_TRISTATE_DISABLED}var c=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var b=c.Block||c.BlockLimit;if(!b||b.nodeName.toLowerCase()=="body"){return FCK_TRISTATE_OFF}for(var a=0;a<c.Elements.length;a++){if(c.Elements[a].nodeName.IEquals("blockquote")){return FCK_TRISTATE_ON}}return FCK_TRISTATE_OFF}};
var FCKCoreStyleCommand=function(a){this.Name="CoreStyle";this.StyleName="_FCK_"+a;this.IsActive=false;FCKStyles.AttachStyleStateChange(this.StyleName,this._OnStyleStateChange,this)};FCKCoreStyleCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();if(this.IsActive){FCKStyles.RemoveStyle(this.StyleName)}else{FCKStyles.ApplyStyle(this.StyleName)}FCK.Focus();FCK.Events.FireEvent("OnSelectionChange")},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG){return FCK_TRISTATE_DISABLED}return this.IsActive?FCK_TRISTATE_ON:FCK_TRISTATE_OFF},_OnStyleStateChange:function(a,b){this.IsActive=b}};var FCKRemoveFormatCommand=function(){this.Name='RemoveFormat';};FCKRemoveFormatCommand.prototype={Execute:function(){FCKStyles.RemoveAll();FCK.Focus();FCK.Events.FireEvent('OnSelectionChange');},GetState:function(){return FCK.EditorWindow?0:-1;}};
//version code 2.6.4 end
var FCKsectionCommand=function(){};FCKsectionCommand.prototype={Execute:function(){FCKUndo.SaveUndoStep();var g=this.GetState();var q=new FCKDomRange(FCK.EditorWindow);q.MoveToSelection();var l=q.CreateBookmark();if(FCKBrowserInfo.IsIE){var o=q.GetBookmarkNode(l,true);var c=q.GetBookmarkNode(l,false);var f;if(o&&o.parentNode.nodeName.IEquals("blockquote")&&!o.previousSibling){f=o;while((f=f.nextSibling)){if(FCKListsLib.BlockElements[f.nodeName.toLowerCase()]){FCKDomTools.MoveNode(o,f,true)}}}if(c&&c.parentNode.nodeName.IEquals("blockquote")&&!c.previousSibling){f=c;while((f=f.nextSibling)){if(FCKListsLib.BlockElements[f.nodeName.toLowerCase()]){if(f.firstChild==o){FCKDomTools.InsertAfterNode(o,c)}else{FCKDomTools.MoveNode(c,f,true)}}}}}var t=new FCKDomRangeIterator(q);var m;if(g==FCK_TRISTATE_OFF){var n=[];while((m=t.GetNextParagraph())){n.push(m)}if(n.length<1){para=q.Window.document.createElement(FCKConfig.EnterMode.IEquals("p")?"p":"div");q.InsertNode(para);para.appendChild(q.Window.document.createTextNode("\ufeff"));q.MoveToBookmark(l);q.MoveToNodeContents(para);q.Collapse(true);l=q.CreateBookmark();n.push(para)}var p=n[0].parentNode;var z=[];for(var x=0;x<n.length;x++){m=n[x];p=FCKDomTools.GetCommonParents(m.parentNode,p).pop()}while(p.nodeName.IEquals("table","tbody","tr","ol","ul")){p=p.parentNode}var y=null;while(n.length>0){m=n.shift();while(m.parentNode!=p){m=m.parentNode}if(m!=y){z.push(m)}y=m}while(z.length>0){m=z.shift();if(m.nodeName.IEquals("div")&&(m.className).toUpperCase()=="SECTION"){var b=FCKTools.GetElementDocument(m).createDocumentFragment();while(m.firstChild){b.appendChild(m.removeChild(m.firstChild));n.push(b.lastChild)}m.parentNode.replaceChild(b,m)}else{n.push(m)}}var u=q.Window.document.createElement("div");u.className="section";p.insertBefore(u,n[0]);while(n.length>0){m=n.shift();u.appendChild(m)}}else{if(g==FCK_TRISTATE_ON){var A=[];var w={};while((m=t.GetNextParagraph())){var B=null;var r=null;while(m.parentNode){if(m.parentNode.nodeName.IEquals("div")&&(m.parentNode.className).toUpperCase()=="SECTION"){B=m.parentNode;r=m;break}m=m.parentNode}if(B&&r&&!r._fckblockquotemoveout){A.push(r);FCKDomTools.SetElementMarker(w,r,"_fckblockquotemoveout",true)}}FCKDomTools.ClearAllMarkers(w);var a=[];var e=[],w={};var d=function(D){for(var C=0;C<D.childNodes.length;C++){if(FCKListsLib.BlockElements[D.childNodes[C].nodeName.toLowerCase()]){return false}}return true};while(A.length>0){var v=A.shift();var u=v.parentNode;if(v==v.parentNode.firstChild){u.parentNode.insertBefore(u.removeChild(v),u)}else{if(v==v.parentNode.lastChild){u.parentNode.insertBefore(u.removeChild(v),u.nextSibling)}else{FCKDomTools.BreakParent(v,v.parentNode,q)}}if(!u._fckbqprocessed){e.push(u);FCKDomTools.SetElementMarker(w,u,"_fckbqprocessed",true)}a.push(v)}for(var x=e.length-1;x>=0;x--){var h=e[x];if(d(h)){FCKDomTools.RemoveNode(h)}}FCKDomTools.ClearAllMarkers(w);if(FCKConfig.EnterMode.IEquals("br")){while(a.length){var v=a.shift();var k=true;if(v.nodeName.IEquals("div")){var b=FCKTools.GetElementDocument(v).createDocumentFragment();var s=k&&v.previousSibling&&!FCKListsLib.BlockBoundaries[v.previousSibling.nodeName.toLowerCase()];if(k&&s){b.appendChild(FCKTools.GetElementDocument(v).createElement("br"))}var j=v.nextSibling&&!FCKListsLib.BlockBoundaries[v.nextSibling.nodeName.toLowerCase()];while(v.firstChild){b.appendChild(v.removeChild(v.firstChild))}if(j){b.appendChild(FCKTools.GetElementDocument(v).createElement("br"))}v.parentNode.replaceChild(b,v);k=false}}}}}q.MoveToBookmark(l);q.Select();FCK.Focus();FCK.Events.FireEvent("OnSelectionChange")},GetState:function(){if(FCK.EditMode!=FCK_EDITMODE_WYSIWYG||!FCK.EditorWindow){return FCK_TRISTATE_DISABLED}var c=new FCKElementPath(FCKSelection.GetBoundaryParentElement(true));var b=c.Block||c.BlockLimit;if(!b||b.nodeName.toLowerCase()=="body"){return FCK_TRISTATE_OFF}for(var a=0;a<c.Elements.length;a++){if(c.Elements[a].nodeName.IEquals("div")&&(c.Elements[a].className).toUpperCase()=="SECTION"){return FCK_TRISTATE_ON}}return FCK_TRISTATE_OFF}};
var FCKCommands=FCK.Commands={};FCKCommands.LoadedCommands={};FCKCommands.RegisterCommand=function(a,b){this.LoadedCommands[a]=b};FCKCommands.GetCommand=function(a){var b=FCKCommands.LoadedCommands[a];if(b){return b}if(a.substr(0,2)=="E2"){return FCKCommands.GetE2Command(a)}switch(a){case"Bold":case"Italic":case"Underline":case"StrikeThrough":case"Subscript":case"Superscript":case"h1":b=new FCKCoreStyleCommand(a);break;case"RemoveFormat":b=new FCKRemoveFormatCommand();break;case"DocProps":b=new FCKDialogCommand("DocProps",FCKLang.DocProps,"dialog/fck_docprops.html",400,380,FCKCommands.GetFullPageState);break;case"Templates":b=new FCKDialogCommand("Templates",FCKLang.DlgTemplatesTitle,"dialog/fck_template.html",380,450);break;case"DMLPlugin":b=new FCKDialogCommand("DMLPlugin",FCKLang.DMLPlugin,"dialog/fck_dmlplugin_form.html",450,450);break;case"DMLSection":b=new FCKsectionCommand();break;case"TableRedraw":b=new TableRedrawCommand();break;case"Link":b=new FCKDialogCommand("Link",FCKLang.DlgLnkWindowTitle,"dialog/fck_DucklingLink.jsp",450,350);break;case"Unlink":b=new FCKUnlinkCommand();break;case"Anchor":b=new FCKDialogCommand("Anchor",FCKLang.DlgAnchorTitle,"dialog/fck_anchor.html",370,160);break;case"AnchorDelete":b=new FCKAnchorDeleteCommand();break;case"BulletedList":b=new FCKDialogCommand("BulletedList",FCKLang.BulletedListProp,"dialog/fck_listprop.html?UL",370,160);break;case"NumberedList":b=new FCKDialogCommand("NumberedList",FCKLang.NumberedListProp,"dialog/fck_listprop.html?OL",370,160);break;case"About":b=new FCKDialogCommand("About",FCKLang.About,"dialog/fck_about.html",420,330,function(){return FCK_TRISTATE_OFF});break;case"Find":b=new FCKDialogCommand("Find",FCKLang.DlgFindAndReplaceTitle,"dialog/fck_replace.html",340,230,null,null,"Find");break;case"Replace":b=new FCKDialogCommand("Replace",FCKLang.DlgFindAndReplaceTitle,"dialog/fck_replace.html",340,230,null,null,"Replace");break;case"Image":b=new FCKDialogCommand("Image",FCKLang.DlgImgTitle,"dialog/fck_image.html",450,200);break;case"Flash":b=new FCKDialogCommand("Flash",FCKLang.DlgFlashTitle,"dialog/fck_flash.html",450,390);break;case"SpecialChar":b=new FCKDialogCommand("SpecialChar",FCKLang.DlgSpecialCharTitle,"dialog/fck_specialchar.html",400,290);break;case"Smiley":b=new FCKDialogCommand("Smiley",FCKLang.DlgSmileyTitle,"dialog/fck_smiley.html",FCKConfig.SmileyWindowWidth,FCKConfig.SmileyWindowHeight);break;case"Table":b=new FCKDialogCommand("Table",FCKLang.DlgTableTitle,"dialog/fck_table.html",480,250);break;case"TableProp":b=new FCKDialogCommand("Table",FCKLang.DlgTableTitle,"dialog/fck_table.html?Parent",480,250);break;case"TableCellProp":b=new FCKDialogCommand("TableCell",FCKLang.DlgCellTitle,"dialog/fck_tablecell.html",550,240);break;case"Style":b=new FCKStyleCommand();break;case"FontName":b=new FCKFontNameCommand();break;case"FontSize":b=new FCKFontSizeCommand();break;case"FontFormat":b=new FCKFormatBlockCommand();break;case"Source":b=new FCKSourceCommand();break;case"Preview":b=new FCKPreviewCommand();break;case"Save":b=new FCKSaveCommand();break;case"NewPage":b=new FCKNewPageCommand();break;case"PageBreak":b=new FCKPageBreakCommand();break;case"Rule":b=new FCKRuleCommand();break;case"TextColor":b=new FCKTextColorCommand("ForeColor");break;case"BGColor":b=new FCKTextColorCommand("BackColor");break;case"Paste":b=new FCKPasteCommand();break;case"PasteText":b=new FCKPastePlainTextCommand();break;case"PasteWord":b=new FCKPasteWordCommand();break;case"JustifyLeft":b=new FCKJustifyCommand("left");break;case"JustifyCenter":b=new FCKJustifyCommand("center");break;case"JustifyRight":b=new FCKJustifyCommand("right");break;case"JustifyFull":b=new FCKJustifyCommand("justify");break;case"Indent":b=new FCKIndentCommand("indent",FCKConfig.IndentLength);break;case"Outdent":b=new FCKIndentCommand("outdent",FCKConfig.IndentLength*-1);break;case"Blockquote":b=new FCKBlockQuoteCommand();break;case"TableInsertRowAfter":b=new FCKTableCommand("TableInsertRowAfter");break;case"TableInsertRowBefore":b=new FCKTableCommand("TableInsertRowBefore");break;case"TableDeleteRows":b=new FCKTableCommand("TableDeleteRows");break;case"TableInsertColumnAfter":b=new FCKTableCommand("TableInsertColumnAfter");break;case"TableInsertColumnBefore":b=new FCKTableCommand("TableInsertColumnBefore");break;case"TableDeleteColumns":b=new FCKTableCommand("TableDeleteColumns");break;case"TableInsertCellAfter":b=new FCKTableCommand("TableInsertCellAfter");break;case"TableInsertCellBefore":b=new FCKTableCommand("TableInsertCellBefore");break;case"TableDeleteCells":b=new FCKTableCommand("TableDeleteCells");break;case"TableMergeCells":b=new FCKTableCommand("TableMergeCells");break;case"TableMergeRight":b=new FCKTableCommand("TableMergeRight");break;case"TableMergeDown":b=new FCKTableCommand("TableMergeDown");break;case"TableHorizontalSplitCell":b=new FCKTableCommand("TableHorizontalSplitCell");break;case"TableVerticalSplitCell":b=new FCKTableCommand("TableVerticalSplitCell");break;case"TableDelete":b=new FCKTableCommand("TableDelete");break;case"Form":b=new FCKDialogCommand("Form",FCKLang.Form,FCKConfig.DucklingBaseHref+"DmlFormAction.do?type=new",380,210);break;case"Checkbox":b=new FCKDialogCommand("Checkbox",FCKLang.Checkbox,"dialog/fck_checkbox.html",380,200);break;case"Radio":b=new FCKDialogCommand("Radio",FCKLang.RadioButton,"dialog/fck_radiobutton.html",380,200);break;case"TextField":b=new FCKDialogCommand("TextField",FCKLang.TextField,"dialog/fck_textfield.html",380,210);break;case"Textarea":b=new FCKDialogCommand("Textarea",FCKLang.Textarea,"dialog/fck_textarea.html",380,210);break;case"HiddenField":b=new FCKDialogCommand("HiddenField",FCKLang.HiddenField,"dialog/fck_hiddenfield.html",380,190);break;case"DMLButton":b=new FCKDialogCommand("DMLButton",FCKLang.DMLButton,"dialog/dml_button.html",380,170);break;case"DMLSelect":b=new FCKDialogCommand("DMLSelect",FCKLang.DMLSelect,"dialog/dml_select.html",380,400);break;case"DMLResultSet":b=new FCKDialogCommand("DMLResultSet",FCKLang.DMLResultSet,FCKConfig.DucklingBaseHref+"DmlResultSetAction.do",380,250);break;case"DMLField":b=new FCKDialogCommand("DMLField",FCKLang.DMLField,FCKConfig.DucklingBaseHref+"DmlFieldAction.do",380,250);break;case"ImageScroll":b=new FCKDialogCommand("ImageScroll",FCKLang.ImageScroll,FCKConfig.DucklingBaseHref+"ImgScrService.do?type=open",420,300);break;case"DEMap":b=new FCKDialogCommand("DEMap",FCKLang.DEMap,"dialog/fck_demap.jsp",900,600);break;case"Button":b=new FCKDialogCommand("Button",FCKLang.Button,"dialog/fck_button.html",380,210);break;case"Select":b=new FCKDialogCommand("Select",FCKLang.SelectionField,"dialog/fck_select.jsp",510,257);break;case"ImageButton":b=new FCKDialogCommand("ImageButton",FCKLang.ImageButton,"dialog/fck_image.html?ImageButton",450,390);break;case"SpellCheck":b=new FCKSpellCheckCommand();break;case"FitWindow":b=new FCKFitWindow();break;case"Undo":b=new FCKUndoCommand();break;case"Redo":b=new FCKRedoCommand();break;case"Copy":b=new FCKCutCopyCommand(false);break;case"Cut":b=new FCKCutCopyCommand(true);break;case"SelectAll":b=new FCKSelectAllCommand();break;case"InsertOrderedList":b=new FCKListCommand("insertorderedlist","ol");break;case"InsertUnorderedList":b=new FCKListCommand("insertunorderedlist","ul");break;case"ShowBlocks":b=new FCKShowBlockCommand("ShowBlocks",FCKConfig.StartupShowBlocks?FCK_TRISTATE_ON:FCK_TRISTATE_OFF);break;case"Undefined":b=new FCKUndefinedCommand();break;case"UpdateAttach":b=new FCKUpdateAttachCommand();break;default:if(FCKRegexLib.NamedCommands.test(a)){b=new FCKNamedCommand(a)}else{alert(FCKLang.UnknownCommand.replace(/%1/g,a));return null}}FCKCommands.LoadedCommands[a]=b;return b};FCKCommands.GetFullPageState=function(){return FCKConfig.FullPage?FCK_TRISTATE_OFF:FCK_TRISTATE_DISABLED};FCKCommands.GetBooleanState=function(a){return a?FCK_TRISTATE_DISABLED:FCK_TRISTATE_OFF};
//version code 2.6.4 start
var FCKPanel=function(f){this.IsRTL=(FCKLang.Dir=="rtl");this.IsContextMenu=false;this._LockCounter=0;this._Window=f||window;var c;if(this._Window.createPopup){this._Popup=this._Window.createPopup();var e=this._Window.document;if(FCK_IS_CUSTOM_DOMAIN&&!FCKBrowserInfo.IsIE7){e.domain=FCK_ORIGINAL_DOMAIN;document.domain=FCK_ORIGINAL_DOMAIN}c=this.Document=this._Popup.document;if(FCK_IS_CUSTOM_DOMAIN){c.domain=FCK_RUNTIME_DOMAIN;e.domain=FCK_RUNTIME_DOMAIN;document.domain=FCK_RUNTIME_DOMAIN}FCK.IECleanup.AddItem(this,FCKPanel_Cleanup)}else{var b=this._IFrame=this._Window.document.createElement("iframe");FCKTools.ResetStyles(b);b.src="javascript:void(0)";b.allowTransparency=true;b.frameBorder="0";b.scrolling="no";b.style.width=b.style.height="0px";FCKDomTools.SetElementStyles(b,{position:"absolute",zIndex:FCKConfig.FloatingPanelsZIndex});if(this._Window.document.body){this._Window.document.body.appendChild(b)}else{this._Window.document.documentElement.appendChild(b)}var d=b.contentWindow;c=this.Document=d.document;var a="";if(FCKBrowserInfo.IsSafari){a='<base href="'+window.document.location+'">'}c.open();c.write("<html><head>"+a+'</head><body style="margin:0px;padding:0px;"></body></html>');c.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.Panel_Contructor(c,window.document.location)}FCKTools.AddEventListenerEx(d,"focus",FCKPanel_Window_OnFocus,this);FCKTools.AddEventListenerEx(d,"blur",FCKPanel_Window_OnBlur,this)}c.dir=FCKLang.Dir;FCKTools.AddEventListener(c,"contextmenu",FCKTools.CancelEvent);this.MainNode=c.body.appendChild(c.createElement("DIV"));this.MainNode.style.cssFloat=this.IsRTL?"right":"left"};FCKPanel.prototype.AppendStyleSheet=function(a){FCKTools.AppendStyleSheet(this.Document,a)};FCKPanel.prototype.Preload=function(a,c,b){if(this._Popup){this._Popup.show(a,c,0,0,b)}};FCKPanel.prototype.ResizeForSubpanel=function(g,f,b){if(!this._ShouldResize()){return false}if(!this._Popup.isOpen){this.Subpanel=null;return false}if(f==0&&b==0){if(this.Subpanel!==g){return false}this.Subpanel=null;this.IncreasedX=0}else{this.Subpanel=g;if((this.IncreasedX>=f)&&(this.IncreasedY>=b)){return false}this.IncreasedX=Math.max(this.IncreasedX,f);this.IncreasedY=Math.max(this.IncreasedY,b)}var a=this.ShowRect.x;var d=this.IncreasedX;if(this.IsRTL){a=a-d}var e=this.ShowRect.w+d;var c=Math.max(this.ShowRect.h,this.IncreasedY);if(this.ParentPanel){this.ParentPanel.ResizeForSubpanel(this,e,c)}this._Popup.show(a,this.ShowRect.y,e,c,this.RelativeElement);return this.IsRTL};FCKPanel.prototype._ShouldResize=function(){return(FCKBrowserInfo.IsIE7||FCKBrowserInfo.IsIE9||FCKBrowserInfo.IsIE10)};FCKPanel.prototype.Show=function(k,i,e,c,o){var j;var m=this.MainNode;if(this._Popup){this._Popup.show(k,i,0,0,e);FCKDomTools.SetElementStyles(m,{width:c?c+"px":"",height:o?o+"px":""});j=m.offsetWidth;if(this._ShouldResize()){if(this.ParentPanel&&this.ParentPanel.ResizeForSubpanel(this,j,m.offsetHeight)){FCKTools.RunFunction(this.Show,this,[k,i,e]);return}}if(this.IsRTL){if(this.IsContextMenu){k=k-j+1}else{if(e){k=(k*-1)+e.offsetWidth-j}}}if(this._ShouldResize()){this.ShowRect={x:k,y:i,w:j,h:m.offsetHeight};this.IncreasedX=0;this.IncreasedY=0;this.RelativeElement=e}this._Popup.show(k,i,j,m.offsetHeight,e);if(this.OnHide){if(this._Timer){CheckPopupOnHide.call(this,true)}this._Timer=FCKTools.SetInterval(CheckPopupOnHide,100,this)}}else{if(typeof(FCK.ToolbarSet.CurrentInstance.FocusManager)!="undefined"){FCK.ToolbarSet.CurrentInstance.FocusManager.Lock()}if(this.ParentPanel){this.ParentPanel.Lock();FCKPanel_Window_OnBlur(null,this.ParentPanel)}if(FCKBrowserInfo.IsGecko&&FCKBrowserInfo.IsMac){this._IFrame.scrolling="";FCKTools.RunFunction(function(){this._IFrame.scrolling="no"},this)}if(FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel&&FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel!=this){FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel.Hide(false,true)}FCKDomTools.SetElementStyles(m,{width:c?c+"px":"",height:o?o+"px":""});j=m.offsetWidth;if(!c){this._IFrame.width=1}if(!o){this._IFrame.height=1}j=m.offsetWidth||m.firstChild.offsetWidth;var l=FCKTools.GetDocumentPosition(this._Window,e.nodeType==9?(FCKTools.IsStrictMode(e)?e.documentElement:e.body):e);var d=FCKDomTools.GetPositionedAncestor(this._IFrame.parentNode);if(d){var a=FCKTools.GetDocumentPosition(FCKTools.GetElementWindow(d),d);l.x-=a.x;l.y-=a.y}if(this.IsRTL&&!this.IsContextMenu){k=(k*-1)}k+=l.x;i+=l.y;if(this.IsRTL){if(this.IsContextMenu){k=k-j+1}else{if(e){k=k+e.offsetWidth-j}}}else{var f=FCKTools.GetViewPaneSize(this._Window);var g=FCKTools.GetScrollPosition(this._Window);var b=f.Height+g.Y;var n=f.Width+g.X;if((k+j)>n){k-=k+j-n}if((i+m.offsetHeight)>b){i-=i+m.offsetHeight-b}}FCKDomTools.SetElementStyles(this._IFrame,{left:k+"px",top:i+"px"});this._IFrame.contentWindow.focus();this._IsOpened=true;var h=this;this._resizeTimer=setTimeout(function(){var p=m.offsetWidth||m.firstChild.offsetWidth;var q=m.offsetHeight;h._IFrame.style.width=p+"px";h._IFrame.style.height=q+"px"},0);FCK.ToolbarSet.CurrentInstance.GetInstanceObject("FCKPanel")._OpenedPanel=this}FCKTools.RunFunction(this.OnShow,this)};FCKPanel.prototype.Hide=function(a,b){if(this._Popup){this._Popup.hide();if(this.ParentPanel){this.ParentPanel.ResizeForSubpanel(this,0,0)}}else{if(!this._IsOpened||this._LockCounter>0){return}if(typeof(FCKFocusManager)!="undefined"&&!b){FCKFocusManager.Unlock()}this._IFrame.style.width=this._IFrame.style.height="0px";this._IsOpened=false;if(this._resizeTimer){clearTimeout(this._resizeTimer);this._resizeTimer=null}if(this.ParentPanel){this.ParentPanel.Unlock()}if(!a){FCKTools.RunFunction(this.OnHide,this)}if(this.childPanel){this.childPanel.todo=true;this.childPanel.Hide()}}};FCKPanel.prototype.CheckIsOpened=function(){if(this._Popup){return this._Popup.isOpen}else{return this._IsOpened}};FCKPanel.prototype.CreateChildPanel=function(){var a=this._Popup?FCKTools.GetDocumentWindow(this.Document):this._Window;var b=new FCKPanel(a);b.ParentPanel=this;return b};FCKPanel.prototype.Lock=function(){this._LockCounter++};FCKPanel.prototype.Unlock=function(){if(--this._LockCounter==0&&!this.HasFocus){this.Hide()}};function FCKPanel_Window_OnFocus(b,a){a.HasFocus=true}function FCKPanel_Window_OnBlur(b,a){a.HasFocus=false;if(a._LockCounter==0){FCKTools.RunFunction(a.Hide,a)}}function CheckPopupOnHide(a){if(a||!this._Popup.isOpen){window.clearInterval(this._Timer);this._Timer=null;FCKTools.RunFunction(this.OnHide,this)}}function FCKPanel_Cleanup(){this._Popup=null;this._Window=null;this.Document=null;this.MainNode=null};

var FCKIcon=function(A){var B=A?typeof(A):'undefined';switch (B){case 'number':this.Path=FCKConfig.SkinPath+'fck_strip.gif';this.Size=16;this.Position=A;break;case 'undefined':this.Path=FCK_SPACER_PATH;break;case 'string':this.Path=A;break;default:this.Path=A[0];this.Size=A[1];this.Position=A[2];}};FCKIcon.prototype.CreateIconElement=function(A){var B,eIconImage;if (this.Position){var C='-'+((this.Position-1)*this.Size)+'px';if (FCKBrowserInfo.IsIE){B=A.createElement('DIV');eIconImage=B.appendChild(A.createElement('IMG'));eIconImage.src=this.Path;eIconImage.style.top=C;}else{B=A.createElement('IMG');B.src=FCK_SPACER_PATH;B.style.backgroundPosition='0px '+C;B.style.backgroundImage='url("'+this.Path+'")';}}else{if (FCKBrowserInfo.IsIE){B=A.createElement('DIV');eIconImage=B.appendChild(A.createElement('IMG'));eIconImage.src=this.Path?this.Path:FCK_SPACER_PATH;}else{B=A.createElement('IMG');B.src=this.Path?this.Path:FCK_SPACER_PATH;}};B.className='TB_Button_Image';return B;};
//edit by diyanliang this.Label=B||A change to this.Label=B 09-8-28
var FCKToolbarButtonUI=function(b,a,f,e,c,d){this.Name=b;this.Label=a||b;this.Tooltip=f||this.Label;this.Style=c||FCK_TOOLBARITEM_ONLYICON;this.State=d||FCK_TRISTATE_OFF;this.Icon=new FCKIcon(e);if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarButtonUI_Cleanup)}};FCKToolbarButtonUI.prototype._CreatePaddingElement=function(a){var b=a.createElement("IMG");b.className="TB_Button_Padding";b.src=FCK_SPACER_PATH;return b};FCKToolbarButtonUI.prototype.Create=function(b){var a=FCKTools.GetElementDocument(b);var g=this.MainElement=a.createElement("DIV");g.title=this.Tooltip;if(FCKBrowserInfo.IsGecko){g.onmousedown=FCKTools.CancelEvent}FCKTools.AddEventListenerEx(g,"mouseover",FCKToolbarButtonUI_OnMouseOver,this);FCKTools.AddEventListenerEx(g,"mouseout",FCKToolbarButtonUI_OnMouseOut,this);FCKTools.AddEventListenerEx(g,"click",FCKToolbarButtonUI_OnClick,this);this.ChangeState(this.State,true);if(this.Style==FCK_TOOLBARITEM_ONLYICON&&!this.ShowArrow){g.appendChild(this.Icon.CreateIconElement(a))}else{var d=g.appendChild(a.createElement("TABLE"));d.cellPadding=0;d.cellSpacing=0;var c=d.insertRow(-1);var f=c.insertCell(-1);if(this.Style==FCK_TOOLBARITEM_ONLYICON||this.Style==FCK_TOOLBARITEM_ICONTEXT){f.appendChild(this.Icon.CreateIconElement(a))}else{f.appendChild(this._CreatePaddingElement(a))}if(this.Style==FCK_TOOLBARITEM_ONLYTEXT||this.Style==FCK_TOOLBARITEM_ICONTEXT){f=c.insertCell(-1);f.className="TB_Button_Text";f.noWrap=true;f.appendChild(a.createTextNode(this.Label))}if(this.ShowArrow){if(this.Style!=FCK_TOOLBARITEM_ONLYICON){c.insertCell(-1).appendChild(this._CreatePaddingElement(a))}f=c.insertCell(-1);var e=f.appendChild(a.createElement("IMG"));e.src=FCKConfig.SkinPath+"images/toolbar.buttonarrow.gif";e.width=5;e.height=3}f=c.insertCell(-1);f.appendChild(this._CreatePaddingElement(a))}b.appendChild(g)};FCKToolbarButtonUI.prototype.ChangeState=function(c,a){if(!a&&this.State==c){return}var b=this.MainElement;if(!b){return}switch(parseInt(c,10)){case FCK_TRISTATE_OFF:b.className="TB_Button_Off";break;case FCK_TRISTATE_ON:b.className="TB_Button_On";break;case FCK_TRISTATE_DISABLED:b.className="TB_Button_Disabled";break}this.State=c};function FCKToolbarButtonUI_OnMouseOver(b,a){if(a.State==FCK_TRISTATE_OFF){this.className="TB_Button_Off_Over"}else{if(a.State==FCK_TRISTATE_ON){this.className="TB_Button_On_Over"}}}function FCKToolbarButtonUI_OnMouseOut(b,a){if(a.State==FCK_TRISTATE_OFF){this.className="TB_Button_Off"}else{if(a.State==FCK_TRISTATE_ON){this.className="TB_Button_On"}}}function FCKToolbarButtonUI_OnClick(b,a){if(a.OnClick&&a.State!=FCK_TRISTATE_DISABLED){a.OnClick(a)}}function FCKToolbarButtonUI_Cleanup(){this.MainElement=null};
var FCKToolbarButton=function(d,b,g,f,a,c,e){this.CommandName=d;this.Label=b;this.Tooltip=g;this.Style=f;this.SourceView=a?true:false;this.ContextSensitive=c?true:false;if(e==null){this.IconPath=FCKConfig.SkinPath+"toolbar/"+d.toLowerCase()+".gif"}else{if(typeof(e)=="number"){this.IconPath=[FCKConfig.SkinPath+"fck_strip.gif",16,e]}else{this.IconPath=e}}};FCKToolbarButton.prototype.Create=function(a){this._UIButton=new FCKToolbarButtonUI(this.CommandName,this.Label,this.Tooltip,this.IconPath,this.Style);this._UIButton.OnClick=this.Click;this._UIButton._ToolbarButton=this;this._UIButton.Create(a)};FCKToolbarButton.prototype.RefreshState=function(){var b=this._UIButton;if(!b){return}var a=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if(a==b.State){return}b.ChangeState(a)};FCKToolbarButton.prototype.Click=function(){var a=this._ToolbarButton||this;FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(a.CommandName).Execute()};FCKToolbarButton.prototype.Enable=function(){this.RefreshState()};FCKToolbarButton.prototype.Disable=function(){this._UIButton.ChangeState(FCK_TRISTATE_DISABLED)};
var FCKSpecialCombo=function(A,B,C,D,E){this.FieldWidth=B||70;this.PanelWidth=C||150;this.PanelMaxHeight=D||150;this.Label='&nbsp;';this.Caption=A;this.Tooltip=A;this.Style=2;this.Enabled=true;this.Items={};this._Panel=new FCKPanel(E||window);this._Panel.AppendStyleSheet(FCKConfig.SkinEditorCSS);this._PanelBox=this._Panel.MainNode.appendChild(this._Panel.Document.createElement('DIV'));this._PanelBox.className='SC_Panel';this._PanelBox.style.width=this.PanelWidth+'px';this._PanelBox.innerHTML='<table cellpadding="0" cellspacing="0" width="100%" style="TABLE-LAYOUT: fixed"><tr><td nowrap></td></tr></table>';this._ItemsHolderEl=this._PanelBox.getElementsByTagName('TD')[0];if (FCK.IECleanup) FCK.IECleanup.AddItem(this,FCKSpecialCombo_Cleanup);};function FCKSpecialCombo_ItemOnMouseOver(){this.className+=' SC_ItemOver';};function FCKSpecialCombo_ItemOnMouseOut(){this.className=this.originalClass;};function FCKSpecialCombo_ItemOnClick(A,B,C){this.className=this.originalClass;B._Panel.Hide();B.SetLabel(this.FCKItemLabel);if (typeof(B.OnSelect)=='function') B.OnSelect(C,this);};FCKSpecialCombo.prototype.ClearItems=function (){if (this.Items) this.Items={};var A=this._ItemsHolderEl;while (A.firstChild) A.removeChild(A.firstChild);};FCKSpecialCombo.prototype.AddItem=function(A,B,C,D){var E=this._ItemsHolderEl.appendChild(this._Panel.Document.createElement('DIV'));E.className=E.originalClass='SC_Item';E.innerHTML=B;E.FCKItemLabel=C||A;E.Selected=false;if (FCKBrowserInfo.IsIE) E.style.width='100%';if (D) E.style.backgroundColor=D;FCKTools.AddEventListenerEx(E,'mouseover',FCKSpecialCombo_ItemOnMouseOver);FCKTools.AddEventListenerEx(E,'mouseout',FCKSpecialCombo_ItemOnMouseOut);FCKTools.AddEventListenerEx(E,'click',FCKSpecialCombo_ItemOnClick,[this,A]);this.Items[A.toString().toLowerCase()]=E;return E;};FCKSpecialCombo.prototype.SelectItem=function(A){if (typeof A=='string') A=this.Items[A.toString().toLowerCase()];if (A){A.className=A.originalClass='SC_ItemSelected';A.Selected=true;}};FCKSpecialCombo.prototype.SelectItemByLabel=function(A,B){for (var C in this.Items){var D=this.Items[C];if (D.FCKItemLabel==A){D.className=D.originalClass='SC_ItemSelected';D.Selected=true;if (B) this.SetLabel(A);}}};FCKSpecialCombo.prototype.DeselectAll=function(A){for (var i in this.Items){if (!this.Items[i]) continue;this.Items[i].className=this.Items[i].originalClass='SC_Item';this.Items[i].Selected=false;};if (A) this.SetLabel('');};FCKSpecialCombo.prototype.SetLabelById=function(A){A=A?A.toString().toLowerCase():'';var B=this.Items[A];this.SetLabel(B?B.FCKItemLabel:'');};FCKSpecialCombo.prototype.SetLabel=function(A){A=(!A||A.length==0)?'&nbsp;':A;if (A==this.Label) return;this.Label=A;var B=this._LabelEl;if (B){B.innerHTML=A;FCKTools.DisableSelection(B);}};FCKSpecialCombo.prototype.SetEnabled=function(A){this.Enabled=A;if (this._OuterTable) this._OuterTable.className=A?'':'SC_FieldDisabled';};FCKSpecialCombo.prototype.Create=function(A){var B=FCKTools.GetElementDocument(A);var C=this._OuterTable=A.appendChild(B.createElement('TABLE'));C.cellPadding=0;C.cellSpacing=0;C.insertRow(-1);var D;var E;switch (this.Style){case 0:D='TB_ButtonType_Icon';E=false;break;case 1:D='TB_ButtonType_Text';E=false;break;case 2:E=true;break;};if (this.Caption&&this.Caption.length>0&&E){var F=C.rows[0].insertCell(-1);/*delete by  diyanliang 09-11-3 F.innerHTML=this.Caption;*/F.innerHTML="";F.className='SC_FieldCaption';};var G=FCKTools.AppendElement(C.rows[0].insertCell(-1),'div');if (E){G.className='SC_Field';G.style.width=this.FieldWidth+'px';G.innerHTML='<table width="100%" cellpadding="0" cellspacing="0" style="TABLE-LAYOUT: fixed;"><tbody><tr><td class="SC_FieldLabel"><label>&nbsp;</label></td><td class="SC_FieldButton">&nbsp;</td></tr></tbody></table>';this._LabelEl=G.getElementsByTagName('label')[0];this._LabelEl.innerHTML=this.Label;}else{G.className='TB_Button_Off';G.innerHTML='<table title="'+this.Tooltip+'" class="'+D+'" cellspacing="0" cellpadding="0" border="0"><tr><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td><td class="TB_Text">'+this.Caption+'</td><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td><td class="TB_ButtonArrow"><img src="'+FCKConfig.SkinPath+'images/toolbar.buttonarrow.gif" width="5" height="3"></td><td><img class="TB_Button_Padding" src="'+FCK_SPACER_PATH+'" /></td></tr></table>';};FCKTools.AddEventListenerEx(G,'mouseover',FCKSpecialCombo_OnMouseOver,this);FCKTools.AddEventListenerEx(G,'mouseout',FCKSpecialCombo_OnMouseOut,this);FCKTools.AddEventListenerEx(G,'click',FCKSpecialCombo_OnClick,this);FCKTools.DisableSelection(this._Panel.Document.body);};function FCKSpecialCombo_Cleanup(){this._LabelEl=null;this._OuterTable=null;this._ItemsHolderEl=null;this._PanelBox=null;if (this.Items){for (var A in this.Items) this.Items[A]=null;}};function FCKSpecialCombo_OnMouseOver(A,B){if (B.Enabled){switch (B.Style){case 0:this.className='TB_Button_On_Over';break;case 1:this.className='TB_Button_On_Over';break;case 2:this.className='SC_Field SC_FieldOver';break;}}};function FCKSpecialCombo_OnMouseOut(A,B){switch (B.Style){case 0:this.className='TB_Button_Off';break;case 1:this.className='TB_Button_Off';break;case 2:this.className='SC_Field';break;}};function FCKSpecialCombo_OnClick(e,A){if (A.Enabled){var B=A._Panel;var C=A._PanelBox;var D=A._ItemsHolderEl;var E=A.PanelMaxHeight;if (A.OnBeforeClick) A.OnBeforeClick(A);if (FCKBrowserInfo.IsIE) B.Preload(0,this.offsetHeight,this);if (D.offsetHeight>E) C.style.height=E+'px';else C.style.height='';B.Show(0,this.offsetHeight,this);}};
var FCKToolbarSpecialCombo=function(){this.SourceView=false;this.ContextSensitive=true;this.FieldWidth=null;this.PanelWidth=null;this.PanelMaxHeight=null;};FCKToolbarSpecialCombo.prototype.DefaultLabel='';function FCKToolbarSpecialCombo_OnSelect(A,B){FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).Execute(A,B);};FCKToolbarSpecialCombo.prototype.Create=function(A){this._Combo=new FCKSpecialCombo(this.GetLabel(),this.FieldWidth,this.PanelWidth,this.PanelMaxHeight,FCKBrowserInfo.IsIE?window:FCKTools.GetElementWindow(A).parent);this._Combo.Tooltip=this.Tooltip;this._Combo.Style=this.Style;this.CreateItems(this._Combo);this._Combo.Create(A);this._Combo.CommandName=this.CommandName;this._Combo.OnSelect=FCKToolbarSpecialCombo_OnSelect;};function FCKToolbarSpecialCombo_RefreshActiveItems(A,B){A.DeselectAll();A.SelectItem(B);A.SetLabelById(B);};FCKToolbarSpecialCombo.prototype.RefreshState=function(){var A;var B=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName).GetState();if (B!=-1){A=1;if (this.RefreshActiveItems) this.RefreshActiveItems(this._Combo,B);else{if (this._LastValue!==B){this._LastValue=B;if (!B||B.length==0){this._Combo.DeselectAll();this._Combo.SetLabel(this.DefaultLabel);}else FCKToolbarSpecialCombo_RefreshActiveItems(this._Combo,B);}}}else A=-1;if (A==this.State) return;if (A==-1){this._Combo.DeselectAll();this._Combo.SetLabel('');};this.State=A;this._Combo.SetEnabled(A!=-1);};FCKToolbarSpecialCombo.prototype.Enable=function(){this.RefreshState();};FCKToolbarSpecialCombo.prototype.Disable=function(){this.State=-1;this._Combo.DeselectAll();this._Combo.SetLabel('');this._Combo.SetEnabled(false);};
var FCKToolbarStyleCombo=function(A,B){if (A===false) return;this.CommandName='Style';this.Label=this.GetLabel();this.Tooltip=A?A:this.Label;this.Style=B?B:2;this.DefaultLabel=FCKConfig.DefaultStyleLabel||'';};FCKToolbarStyleCombo.prototype=new FCKToolbarSpecialCombo;FCKToolbarStyleCombo.prototype.GetLabel=function(){return FCKLang.Style;};FCKToolbarStyleCombo.prototype.GetStyles=function(){var A={};var B=FCK.ToolbarSet.CurrentInstance.Styles.GetStyles();for (var C in B){var D=B[C];if (!D.IsCore) A[C]=D;};return A;};FCKToolbarStyleCombo.prototype.CreateItems=function(A){var B=A._Panel.Document;FCKTools.AppendStyleSheet(B,FCKConfig.ToolbarComboPreviewCSS);FCKTools.AppendStyleString(B,FCKConfig.EditorAreaStyles);B.body.className+=' ForceBaseFont';FCKConfig.ApplyBodyAttributes(B.body);var C=this.GetStyles();for (var D in C){var E=C[D];var F=E.GetType()==2?D:FCKToolbarStyleCombo_BuildPreview(E,E.Label||D);var G=A.AddItem(D,F);G.Style=E;};A.OnBeforeClick=this.StyleCombo_OnBeforeClick;};FCKToolbarStyleCombo.prototype.RefreshActiveItems=function(A){var B=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if (B){var C=new FCKElementPath(B);var D=C.Elements;for (var e=0;e<D.length;e++){for (var i in A.Items){var E=A.Items[i];var F=E.Style;if (F.CheckElementRemovable(D[e],true)){A.SetLabel(F.Label||F.Name);return;}}}};A.SetLabel(this.DefaultLabel);};FCKToolbarStyleCombo.prototype.StyleCombo_OnBeforeClick=function(A){A.DeselectAll();var B;var C;var D;var E=FCK.ToolbarSet.CurrentInstance.Selection;if (E.GetType()=='Control'){B=E.GetSelectedElement();D=B.nodeName.toLowerCase();}else{B=E.GetBoundaryParentElement(true);C=new FCKElementPath(B);};for (var i in A.Items){var F=A.Items[i];var G=F.Style;if ((D&&G.Element==D)||(!D&&G.GetType()!=2)){F.style.display='';if ((C&&G.CheckActive(C))||(!C&&G.CheckElementRemovable(B,true))) A.SelectItem(G.Name);}else F.style.display='none';}};function FCKToolbarStyleCombo_BuildPreview(A,B){var C=A.GetType();var D=[];if (C==0) D.push('<div class="BaseFont">');var E=A.Element;if (E=='bdo') E='span';D=['<',E];var F=A._StyleDesc.Attributes;if (F){for (var G in F){D.push(' ',G,'="',A.GetFinalAttributeValue(G),'"');}};if (A._GetStyleText().length>0) D.push(' style="',A.GetFinalStyleValue(),'"');D.push('>',B,'</',E,'>');if (C==0) D.push('</div>');return D.join('');};
var FCKToolbarFontFormatCombo=function(A,B){if (A===false) return;this.CommandName='FontFormat';this.Label=this.GetLabel();this.Tooltip=A?A:this.Label;this.Style=B?B:2;this.NormalLabel='Normal';this.PanelWidth=190;this.DefaultLabel=FCKLang.FontFormat||FCKConfig.DefaultFontFormatLabel||'';};FCKToolbarFontFormatCombo.prototype=new FCKToolbarStyleCombo(false);FCKToolbarFontFormatCombo.prototype.GetLabel=function(){return FCKLang.FontFormat;};FCKToolbarFontFormatCombo.prototype.GetStyles=function(){var A={};var B=FCKLang['FontFormats'].split(';');var C={p:B[0],pre:B[1],address:B[2],h1:B[3],h2:B[4],h3:B[5],h4:B[6],h5:B[7],h6:B[8],div:B[9]||(B[0]+' (DIV)')};var D=FCKConfig.FontFormats.split(';');for (var i=0;i<D.length;i++){var E=D[i];var F=FCKStyles.GetStyle('_FCK_'+E);if (F){F.Label=C[E];A['_FCK_'+E]=F;}else alert("The FCKConfig.CoreStyles['"+E+"'] setting was not found. Please check the fckconfig.js file");};return A;};FCKToolbarFontFormatCombo.prototype.RefreshActiveItems=function(A){var B=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if (B){var C=new FCKElementPath(B);var D=C.Block;if (D){for (var i in A.Items){var E=A.Items[i];var F=E.Style;if (F.CheckElementRemovable(D)){A.SetLabel(F.Label);return;}}}};A.SetLabel(this.DefaultLabel);};FCKToolbarFontFormatCombo.prototype.StyleCombo_OnBeforeClick=function(A){A.DeselectAll();var B=FCK.ToolbarSet.CurrentInstance.Selection.GetBoundaryParentElement(true);if (B){var C=new FCKElementPath(B);var D=C.Block;for (var i in A.Items){var E=A.Items[i];var F=E.Style;if (F.CheckElementRemovable(D)){A.SelectItem(E);return;}}}};
var FCKToolbarFontsCombo=function(A,B){this.CommandName='FontName';this.Label=this.GetLabel();this.Tooltip=A?A:this.Label;this.Style=B?B:2;this.DefaultLabel=FCKLang.Font||FCKConfig.DefaultFontLabel||'';};FCKToolbarFontsCombo.prototype=new FCKToolbarFontFormatCombo(false);FCKToolbarFontsCombo.prototype.GetLabel=function(){return FCKLang.Font;};FCKToolbarFontsCombo.prototype.GetStyles=function(){var A=FCKStyles.GetStyle('_FCK_FontFace');if (!A){alert("The FCKConfig.CoreStyles['Size'] setting was not found. Please check the fckconfig.js file");return {};};var B={};var C=FCKConfig.FontNames.split(';');for (var i=0;i<C.length;i++){var D=C[i].split('/');var E=D[0];var F=D[1]||E;var G=FCKTools.CloneObject(A);G.SetVariable('Font',E);G.Label=F;B[F]=G;};return B;};FCKToolbarFontsCombo.prototype.RefreshActiveItems=FCKToolbarStyleCombo.prototype.RefreshActiveItems;FCKToolbarFontsCombo.prototype.StyleCombo_OnBeforeClick=function(A){A.DeselectAll();var B=FCKSelection.GetBoundaryParentElement(true);if (B){var C=new FCKElementPath(B);for (var i in A.Items){var D=A.Items[i];var E=D.Style;if (E.CheckActive(C)){A.SelectItem(D);return;}}}};
var FCKToolbarFontSizeCombo=function(A,B){this.CommandName='FontSize';this.Label=this.GetLabel();this.Tooltip=A?A:this.Label;this.Style=B?B:2;this.DefaultLabel=FCKLang.FontSize||FCKConfig.DefaultFontSizeLabel||'';this.FieldWidth=70;};FCKToolbarFontSizeCombo.prototype=new FCKToolbarFontFormatCombo(false);FCKToolbarFontSizeCombo.prototype.GetLabel=function(){return FCKLang.FontSize;};FCKToolbarFontSizeCombo.prototype.GetStyles=function(){var A=FCKStyles.GetStyle('_FCK_Size');if (!A){alert("The FCKConfig.CoreStyles['FontFace'] setting was not found. Please check the fckconfig.js file");return {};};var B={};var C=FCKConfig.FontSizes.split(';');for (var i=0;i<C.length;i++){var D=C[i].split('/');var E=D[0];var F=D[1]||E;var G=FCKTools.CloneObject(A);G.SetVariable('Size',E);G.Label=F;B[F]=G;};return B;};FCKToolbarFontSizeCombo.prototype.RefreshActiveItems=FCKToolbarStyleCombo.prototype.RefreshActiveItems;FCKToolbarFontSizeCombo.prototype.StyleCombo_OnBeforeClick=FCKToolbarFontsCombo.prototype.StyleCombo_OnBeforeClick;
var FCKToolbarPanelButton=function(A,B,C,D,E){this.CommandName=A;var F;if (E==null) F=FCKConfig.SkinPath+'toolbar/'+A.toLowerCase()+'.gif';else if (typeof(E)=='number') F=[FCKConfig.SkinPath+'fck_strip.gif',16,E];var G=this._UIButton=new FCKToolbarButtonUI(A,B,C,F,D);G._FCKToolbarPanelButton=this;G.ShowArrow=true;G.OnClick=FCKToolbarPanelButton_OnButtonClick;};FCKToolbarPanelButton.prototype.TypeName='FCKToolbarPanelButton';FCKToolbarPanelButton.prototype.Create=function(A){A.className+='Menu';this._UIButton.Create(A);var B=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(this.CommandName)._Panel;this.RegisterPanel(B);};FCKToolbarPanelButton.prototype.RegisterPanel=function(A){if (A._FCKToolbarPanelButton) return;A._FCKToolbarPanelButton=this;var B=A.Document.body.appendChild(A.Document.createElement('div'));B.style.position='absolute';B.style.top='0px';var C=A._FCKToolbarPanelButtonLineDiv=B.appendChild(A.Document.createElement('IMG'));C.className='TB_ConnectionLine';C.style.position='absolute';C.src=FCK_SPACER_PATH;A.OnHide=FCKToolbarPanelButton_OnPanelHide;};function FCKToolbarPanelButton_OnButtonClick(A){var B=this._FCKToolbarPanelButton;var e=B._UIButton.MainElement;B._UIButton.ChangeState(1);var C=FCK.ToolbarSet.CurrentInstance.Commands.GetCommand(B.CommandName);var D=C._Panel;D._FCKToolbarPanelButtonLineDiv.style.width=(e.offsetWidth-2)+'px';C.Execute(0,e.offsetHeight-1,e);};function FCKToolbarPanelButton_OnPanelHide(){var A=this._FCKToolbarPanelButton;A._UIButton.ChangeState(0);};FCKToolbarPanelButton.prototype.RefreshState=FCKToolbarButton.prototype.RefreshState;FCKToolbarPanelButton.prototype.Enable=FCKToolbarButton.prototype.Enable;FCKToolbarPanelButton.prototype.Disable=FCKToolbarButton.prototype.Disable;
var FCKToolbarItems=new Object();FCKToolbarItems.LoadedItems=new Object();FCKToolbarItems.RegisterItem=function(b,a){this.LoadedItems[b]=a};FCKToolbarItems.GetItem=function(a){var b=FCKToolbarItems.LoadedItems[a];if(b){return b}if(a.substr(0,2)=="E2"){return FCKToolbarItems.GetE2Item(a)}switch(a){case"Source":b=new FCKToolbarButton("Source",FCKLang.Source,null,FCK_TOOLBARITEM_ICONTEXT,true,true,1);break;case"DocProps":b=new FCKToolbarButton("DocProps",FCKLang.DocProps,null,null,null,null,2);break;case"Save":b=new FCKToolbarButton("Save",FCKLang.Save,null,null,true,null,3);break;case"NewPage":b=new FCKToolbarButton("NewPage",FCKLang.NewPage,FCKLang.NewPageLbl,2,true,null,19);break;case"Preview":b=new FCKToolbarButton("Preview",FCKLang.Preview,null,null,true,null,5);break;case"Templates":b=new FCKToolbarButton("Templates",FCKLang.Templates,FCKLang.TemplatesLbl,2,true,true,6);break;case"DMLPlugin":b=new FCKToolbarButton("DMLPlugin",FCKLang.DMLPlugin,FCKLang.DMLPluginLbl,2,true,true,52);break;case"DMLSection":b=new FCKToolbarButton("DMLSection",FCKLang.DMLSection,FCKLang.DMLSectionLbl,2,true,true,43);break;case"TableRedraw":b=new FCKToolbarButton("TableRedraw",FCKLang.TableRedraw,null,null,false,true,61);break;case"About":b=new FCKToolbarButton("About",FCKLang.About,null,null,true,null,47);break;case"Cut":b=new FCKToolbarButton("Cut",FCKLang.Cut,null,null,false,true,7);break;case"Copy":b=new FCKToolbarButton("Copy",FCKLang.Copy,null,null,false,true,8);break;case"Paste":b=new FCKToolbarButton("Paste",FCKLang.Paste,null,null,false,true,9);break;case"PasteText":b=new FCKToolbarButton("PasteText",FCKLang.PasteText,null,null,false,true,10);break;case"PasteWord":b=new FCKToolbarButton("PasteWord",FCKLang.PasteWord,null,null,false,true,11);break;case"Print":b=new FCKToolbarButton("Print",FCKLang.Print,null,null,false,true,12);break;case"SpellCheck":b=new FCKToolbarButton("SpellCheck",FCKLang.SpellCheck,null,null,null,null,13);break;case"Undo":b=new FCKToolbarButton("Undo",FCKLang.Undo,null,null,false,true,14);break;case"Redo":b=new FCKToolbarButton("Redo",FCKLang.Redo,null,null,false,true,15);break;case"SelectAll":b=new FCKToolbarButton("SelectAll",FCKLang.SelectAll,FCKLang.SelectAllLbl,2,true,null,18);break;case"RemoveFormat":b=new FCKToolbarButton("RemoveFormat",FCKLang.RemoveFormat,FCKLang.RemoveFormatLbl,2,false,true,4);break;case"FitWindow":b=new FCKToolbarButton("FitWindow",FCKLang.FitWindow,null,null,true,true,66);break;case"Bold":b=new FCKToolbarButton("Bold",FCKLang.Bold,null,null,false,true,20);break;case"h1":b=new FCKToolbarButton("h1",FCKLang.DlgGenTitle1,FCKLang.DlgGenTitle1,1,false,true,20);break;case"Italic":b=new FCKToolbarButton("Italic",FCKLang.Italic,null,null,false,true,21);break;case"Underline":b=new FCKToolbarButton("Underline",FCKLang.Underline,null,null,false,true,22);break;case"StrikeThrough":b=new FCKToolbarButton("StrikeThrough",FCKLang.StrikeThrough,null,null,false,true,23);break;case"Subscript":b=new FCKToolbarButton("Subscript",FCKLang.Subscript,null,null,false,true,24);break;case"Superscript":b=new FCKToolbarButton("Superscript",FCKLang.Superscript,null,null,false,true,25);break;case"OrderedList":b=new FCKToolbarButton("InsertOrderedList",FCKLang.NumberedListLbl,FCKLang.NumberedList,null,false,true,26);break;case"UnorderedList":b=new FCKToolbarButton("InsertUnorderedList",FCKLang.BulletedListLbl,FCKLang.BulletedList,null,false,true,27);break;case"Outdent":b=new FCKToolbarButton("Outdent",FCKLang.DecreaseIndent,null,null,false,true,28);break;case"Indent":b=new FCKToolbarButton("Indent",FCKLang.IncreaseIndent,null,null,false,true,29);break;case"Blockquote":b=new FCKToolbarButton("Blockquote",FCKLang.Blockquote,null,null,false,true,73);break;case"Link":b=new FCKToolbarButton("Link",FCKLang.InsertLinkLbl,FCKLang.InsertLink,null,false,true,34);break;case"Unlink":b=new FCKToolbarButton("Unlink",FCKLang.RemoveLink,null,null,false,true,35);break;case"Anchor":b=new FCKToolbarButton("Anchor",FCKLang.Anchor,null,null,null,null,36);break;case"Image":b=new FCKToolbarButton("Image",FCKLang.InsertImageLbl,FCKLang.InsertImage,null,false,true,37);break;case"Flash":b=new FCKToolbarButton("Flash",FCKLang.InsertFlashLbl,FCKLang.InsertFlash,null,false,true,38);break;case"Table":b=new FCKToolbarButton("Table",FCKLang.InsertTableLbl,FCKLang.InsertTable,null,false,true,39);break;case"SpecialChar":b=new FCKToolbarButton("SpecialChar",FCKLang.InsertSpecialCharLbl,FCKLang.InsertSpecialChar,null,false,true,42);break;case"Smiley":b=new FCKToolbarButton("Smiley",FCKLang.InsertSmileyLbl,FCKLang.InsertSmiley,null,false,true,41);break;case"PageBreak":b=new FCKToolbarButton("PageBreak",FCKLang.PageBreakLbl,FCKLang.PageBreak,null,false,true,43);break;case"Rule":b=new FCKToolbarButton("Rule",FCKLang.InsertLineLbl,FCKLang.InsertLine,null,false,true,40);break;case"JustifyLeft":b=new FCKToolbarButton("JustifyLeft",FCKLang.LeftJustify,null,null,false,true,30);break;case"JustifyCenter":b=new FCKToolbarButton("JustifyCenter",FCKLang.CenterJustify,null,null,false,true,31);break;case"JustifyRight":b=new FCKToolbarButton("JustifyRight",FCKLang.RightJustify,null,null,false,true,32);break;case"JustifyFull":b=new FCKToolbarButton("JustifyFull",FCKLang.BlockJustify,null,null,false,true,33);break;case"Style":b=new FCKToolbarStyleCombo();break;case"FontName":b=new FCKToolbarFontsCombo();break;case"FontSize":b=new FCKToolbarFontSizeCombo();break;case"FontFormat":b=new FCKToolbarFontFormatCombo();break;case"TextColor":b=new FCKToolbarPanelButton("TextColor",FCKLang.TextColor,null,null,45);break;case"BGColor":b=new FCKToolbarPanelButton("BGColor",FCKLang.BGColor,null,null,46);break;case"Find":b=new FCKToolbarButton("Find",FCKLang.Find,null,null,null,null,16);break;case"Replace":b=new FCKToolbarButton("Replace",FCKLang.Replace,null,null,null,null,17);break;case"Form":b=new FCKToolbarButton("Form",FCKLang.Form,null,null,null,null,48);break;case"Checkbox":b=new FCKToolbarButton("Checkbox",FCKLang.Checkbox,null,null,null,null,49);break;case"Radio":b=new FCKToolbarButton("Radio",FCKLang.RadioButton,null,null,null,null,50);break;case"TextField":b=new FCKToolbarButton("TextField",FCKLang.TextField,null,null,null,null,51);break;case"Textarea":b=new FCKToolbarButton("Textarea",FCKLang.Textarea,null,null,false,true,69);break;case"HiddenField":b=new FCKToolbarButton("HiddenField",FCKLang.HiddenField,null,null,null,null,56);break;case"DMLButton":b=new FCKToolbarButton("DMLButton",FCKLang.DMLButton,null,null,false,true,68);break;case"DMLSelect":b=new FCKToolbarButton("DMLSelect",FCKLang.DMLSelect,null,null,false,true,67);break;case"DMLResultSet":b=new FCKToolbarButton("DMLResultSet",FCKLang.DMLResultSet,null,null,false,true,70);break;case"DMLField":b=new FCKToolbarButton("DMLField",FCKLang.DMLField,null,null,false,true,71);break;case"ImageScroll":b=new FCKToolbarButton("ImageScroll",FCKLang.ImageScroll,null,null,false,true,73);break;case"DEMap":b=new FCKToolbarButton("DEMap",FCKLang.DEMap,null,null,false,true,74);break;case"Button":b=new FCKToolbarButton("Button",FCKLang.Button,null,null,null,null,54);break;case"Select":b=new FCKToolbarButton("Select",FCKLang.SelectionField,null,null,null,null,53);break;case"ImageButton":b=new FCKToolbarButton("ImageButton",FCKLang.ImageButton,null,null,null,null,55);break;case"ShowBlocks":b=new FCKToolbarButton("ShowBlocks",FCKLang.ShowBlocks,null,null,null,true,72);break;case"UpdateAttach":b=new FCKToolbarButton("UpdateAttach",FCKLang.UpdateAttach,null,null,false,true,59);break;default:alert(FCKLang.UnknownToolbarItem.replace(/%1/g,a));return null}FCKToolbarItems.LoadedItems[a]=b;return b};
//version code 2.6.4 end
var FCKToolbar=function(){this.Items=new Array()};FCKToolbar.prototype.AddItem=function(a){return this.Items[this.Items.length]=a};FCKToolbar.prototype.AddButton=function(b,a,f,g,c,e){if(typeof(g)=="number"){g=[this.DefaultIconsStrip,this.DefaultIconSize,g]}var d=new FCKToolbarButtonUI(b,a,f,g,c,e);d._FCKToolbar=this;d.OnClick=FCKToolbar_OnItemClick;return this.AddItem(d)};function FCKToolbar_OnItemClick(b){var a=b._FCKToolbar;if(a.OnItemClick){a.OnItemClick(a,b)}}FCKToolbar.prototype.AddSeparator=function(){this.AddItem(new FCKToolbarSeparator())};FCKToolbar.prototype.Create=function(b){var a=FCKTools.GetElementDocument(b);var f=a.createElement("table");f.className="TB_Toolbar";f.style.styleFloat=f.style.cssFloat=(FCKLang.Dir=="ltr"?"left":"right");f.dir=FCKLang.Dir;f.cellPadding=0;f.cellSpacing=0;var d=f.insertRow(-1);var g;if(!this.HideStart){g=d.insertCell(-1);g.appendChild(a.createElement("div")).className="TB_Start"}for(var c=0;c<this.Items.length;c++){this.Items[c].Create(d.insertCell(-1))}if(!this.HideEnd){g=d.insertCell(-1);g.appendChild(a.createElement("div")).className="TB_End"}b.appendChild(f)};FCKToolbar.prototype.DucklingCreate=function(c){var b=FCKTools.GetElementDocument(c);var g=b.createElement("table");g.className="TB_Toolbar";g.style.styleFloat=g.style.cssFloat=(FCKLang.Dir=="ltr"?"left":"right");g.dir=FCKLang.Dir;g.cellPadding=0;g.cellSpacing=0;g.border=1;var f=g.insertRow(-1);var h;for(var d=0;d<this.Items.length;d++){if(this.Items[d]=="-"){var a=c.ownerDocument.createElement("div");a.innerHTML="";a.style.clear=a.style.cssFloat=FCKLang.Dir=="rtl"?"right":"left";c.appendChild(a);g=b.createElement("table");g.className="TB_Toolbar";g.style.styleFloat=g.style.cssFloat=(FCKLang.Dir=="ltr"?"left":"right");g.dir=FCKLang.Dir;g.cellPadding=0;g.cellSpacing=0;f=g.insertRow(-1);if(!this.HideEnd){h=f.insertCell(-1);h.appendChild(b.createElement("div")).className="TB_End1111111111"}c.appendChild(g)}else{this.Items[d].Create(f.insertCell(-1))}}if(!this.HideEnd){h=f.insertCell(-1);h.appendChild(b.createElement("div")).className="TB_End222"}c.appendChild(g)};var FCKToolbarSeparator=function(){};FCKToolbarSeparator.prototype.Create=function(a){FCKTools.AppendElement(a,"div").className="TB_Separator"};
//version code 2.6.4 end
var FCKToolbarBreak=function(){};FCKToolbarBreak.prototype.Create=function(A){var B=FCKTools.GetElementDocument(A).createElement('div');B.className='TB_Break';B.style.clear=FCKLang.Dir=='rtl'?'left':'right';A.appendChild(B);};
//version code 2.6.4 end
function FCKToolbarSet_Create(overhideLocation){var oToolbarSet;var sLocation;if(overhideLocation){sLocation=overhideLocation}else{sLocation=FCKConfig.ToolbarLocation}switch(sLocation){case"In":document.getElementById("xToolbarRow").style.display="";oToolbarSet=new FCKToolbarSet(document);break;case"None":oToolbarSet=new FCKToolbarSet(document);break;default:FCK.Events.AttachEvent("OnBlur",FCK_OnBlur);FCK.Events.AttachEvent("OnFocus",FCK_OnFocus);var eToolbarTarget=null;var oOutMatch=sLocation.match(/^Out:(.+)\((\w+)\)$/);if(oOutMatch){if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_GetOutElement(window,oOutMatch)}else{eToolbarTarget=eval("parent."+oOutMatch[1]).document.getElementById(oOutMatch[2])}}else{oOutMatch=sLocation.match(/^Out:(\w+)$/);if(oOutMatch){eToolbarTarget=parent.document.getElementById(oOutMatch[1])}}if(!eToolbarTarget){alert('Invalid value for "ToolbarLocation"');return arguments.callee("In")}oToolbarSet=eToolbarTarget.__FCKToolbarSet;if(oToolbarSet){break}var eToolbarIFrame=FCKTools.GetElementDocument(eToolbarTarget).createElement("iframe");eToolbarIFrame.src="javascript:void(0)";eToolbarIFrame.frameBorder=0;eToolbarIFrame.width="100%";eToolbarIFrame.height="10";eToolbarTarget.appendChild(eToolbarIFrame);eToolbarIFrame.unselectable="on";var eTargetDocument=eToolbarIFrame.contentWindow.document;var sBase="";if(FCKBrowserInfo.IsSafari){sBase='<base href="'+window.document.location+'">'}eTargetDocument.open();eTargetDocument.write("<html><head>"+sBase+'<script type="text/javascript"> var adjust = function() { window.frameElement.height = document.body.scrollHeight ; }; window.onresize = window.onload = function(){var timer = null;var lastHeight = -1;var lastChange = 0;var poller = function(){var currentHeight = document.body.scrollHeight || 0;var currentTime = (new Date()).getTime();if (currentHeight != lastHeight){lastChange = currentTime;adjust();lastHeight = document.body.scrollHeight;}if (lastChange < currentTime - 1000) clearInterval(timer);};timer = setInterval(poller, 100);}<\/script></head><body style="overflow: hidden">'+document.getElementById("xToolbarSpace").innerHTML+"</body></html>");eTargetDocument.close();if(FCKBrowserInfo.IsAIR){FCKAdobeAIR.ToolbarSet_InitOutFrame(eTargetDocument)}FCKTools.AddEventListener(eTargetDocument,"contextmenu",FCKTools.CancelEvent);FCKTools.AppendStyleSheet(eTargetDocument,FCKConfig.SkinEditorCSS);oToolbarSet=eToolbarTarget.__FCKToolbarSet=new FCKToolbarSet(eTargetDocument);oToolbarSet._IFrame=eToolbarIFrame;if(FCK.IECleanup){FCK.IECleanup.AddItem(eToolbarTarget,FCKToolbarSet_Target_Cleanup)}}oToolbarSet.CurrentInstance=FCK;if(!oToolbarSet.ToolbarItems){oToolbarSet.ToolbarItems=FCKToolbarItems}FCK.AttachToOnSelectionChange(oToolbarSet.RefreshItemsState);return oToolbarSet}function FCK_OnBlur(a){var b=a.ToolbarSet;if(b.CurrentInstance==a){b.Disable()}}function FCK_OnFocus(b){var c=b.ToolbarSet;var a=b||FCK;c.CurrentInstance.FocusManager.RemoveWindow(c._IFrame.contentWindow);c.CurrentInstance=a;a.FocusManager.AddWindow(c._IFrame.contentWindow,true);c.Enable()}function FCKToolbarSet_Cleanup(){this._TargetElement=null;this._IFrame=null}function FCKToolbarSet_Target_Cleanup(){this.__FCKToolbarSet=null}var FCKToolbarSet=function(b){this._Document=b;this._TargetElement=b.getElementById("xToolbar");var a=b.getElementById("xExpandHandle");var c=b.getElementById("xCollapseHandle");a.title=FCKLang.ToolbarExpand;FCKTools.AddEventListener(a,"click",FCKToolbarSet_Expand_OnClick);c.title=FCKLang.ToolbarCollapse;FCKTools.AddEventListener(c,"click",FCKToolbarSet_Collapse_OnClick);if(!FCKConfig.ToolbarCanCollapse||FCKConfig.ToolbarStartExpanded){this.Expand()}else{this.Collapse()}c.style.display=FCKConfig.ToolbarCanCollapse?"":"none";if(FCKConfig.ToolbarCanCollapse){c.style.display=""}else{b.getElementById("xTBLeftBorder").style.display=""}this.Toolbars=new Array();this.IsLoaded=false;if(FCK.IECleanup){FCK.IECleanup.AddItem(this,FCKToolbarSet_Cleanup)}};function FCKToolbarSet_Expand_OnClick(){FCK.ToolbarSet.Expand()}function FCKToolbarSet_Collapse_OnClick(){FCK.ToolbarSet.Collapse()}FCKToolbarSet.prototype.Expand=function(){this._ChangeVisibility(false)};FCKToolbarSet.prototype.Collapse=function(){this._ChangeVisibility(true)};FCKToolbarSet.prototype._ChangeVisibility=function(a){this._Document.getElementById("xCollapsed").style.display=a?"":"none";this._Document.getElementById("xExpanded").style.display=a?"none":"";if(FCKBrowserInfo.IsGecko){FCKTools.RunFunction(window.onresize)}};FCKToolbarSet.prototype.Load=function(toolbarSetName){if(toolbarSetName){if(FCKConfig.ToolbarType){eval("this."+FCKConfig.ToolbarType+"ToolBar(toolbarSetName)")}else{this.ducklingToolBar(toolbarSetName)}}else{this.Name=toolbarSetName;this.Items=new Array();this.ItemsWysiwygOnly=new Array();this.ItemsContextSensitive=new Array();this._TargetElement.innerHTML="";var ToolbarSet=FCKConfig.ToolbarSets[toolbarSetName];if(!ToolbarSet){alert(FCKLang.UnknownToolbarSet.replace(/%1/g,toolbarSetName));return}this.Toolbars=new Array();for(var x=0;x<ToolbarSet.length;x++){var oToolbarItems=ToolbarSet[x];if(!oToolbarItems){continue}var oToolbar=null;if(typeof(oToolbarItems)=="string"){if(oToolbarItems=="/"){oToolbar=new FCKToolbarBreak()}}else{oToolbar=new FCKToolbar();for(var j=0;j<oToolbarItems.length;j++){var sItem=oToolbarItems[j];if(sItem=="-"){oToolbar.AddSeparator()}else{var oItem=FCKToolbarItems.GetItem(sItem);if(oItem){oToolbar.AddItem(oItem);this.Items.push(oItem);if(!oItem.SourceView){this.ItemsWysiwygOnly.push(oItem)}if(oItem.ContextSensitive){this.ItemsContextSensitive.push(oItem)}}}}}oToolbar.Create(this._TargetElement);this.Toolbars[this.Toolbars.length]=oToolbar}FCKTools.DisableSelection(this._Document.getElementById("xCollapseHandle").parentNode);if(FCK.Status!=FCK_STATUS_COMPLETE){FCK.Events.AttachEvent("OnStatusChange",this.RefreshModeState)}else{this.RefreshModeState()}this.IsLoaded=true;this.IsEnabled=true;FCKTools.RunFunction(this.OnLoad)}};FCKToolbarSet.prototype.Enable=function(){if(this.IsEnabled){return}this.IsEnabled=true;var a=this.Items;for(var b=0;b<a.length;b++){a[b].RefreshState()}};FCKToolbarSet.prototype.Disable=function(){if(!this.IsEnabled){return}this.IsEnabled=false;var a=this.Items;for(var b=0;b<a.length;b++){a[b].Disable()}};FCKToolbarSet.prototype.RefreshModeState=function(d){if(FCK.Status!=FCK_STATUS_COMPLETE){return}var e=d?d.ToolbarSet:this;var a=e.ItemsWysiwygOnly;if(FCK.EditMode==FCK_EDITMODE_WYSIWYG){for(var c=0;c<a.length;c++){a[c].Enable()}e.RefreshItemsState(d)}else{e.RefreshItemsState(d);for(var b=0;b<a.length;b++){a[b].Disable()}}};FCKToolbarSet.prototype.RefreshItemsState=function(c){var a=(c?c.ToolbarSet:this).ItemsContextSensitive;for(var b=0;b<a.length;b++){a[b].RefreshState()}hiddenBarForTable();hiddenBarForOrderedList();try{HiddenButton()}catch(d){}};FCKToolbarSet.prototype.ducklingToolBar=function(p){this.Name=p;this.Items=[];this.ItemsWysiwygOnly=[];this.ItemsContextSensitive=[];this._TargetElement.innerHTML="";var e=FCKConfig.ToolbarSets[p];if(!e){alert(FCKLang.UnknownToolbarSet.replace(/%1/g,p));return}this.Toolbars=[];var f=this._TargetElement;var i=document.createElement("div");i.id="DE_ToolBarDiv";i.style.overflow="hidden";i.style.height="88px";f.appendChild(i);var l=document.createElement("table");l.className="TB_DucklingToolbar";var n=l.insertRow(-1);ToolBarBox=n.insertCell(-1);i.appendChild(l);for(var o=0;o<e.length;o++){var b=e[o];if(!b){continue}var a;a=new FCKToolbar();for(var k=0;k<b.length;k++){var r=b[k];if(r=="-"){a.AddItem(r)}else{var q=FCKToolbarItems.GetItem(r);if(q){a.AddItem(q);this.Items.push(q);if(!q.SourceView){this.ItemsWysiwygOnly.push(q)}if(q.ContextSensitive){this.ItemsContextSensitive.push(q)}}}}var m=document.createElement("table");m.className="TB_DucklingToolbarBox";m.style.styleFloat=m.style.cssFloat=(FCKLang.Dir=="ltr"?"left":"right");m.dir=FCKLang.Dir;m.cellPadding=0;m.cellSpacing=0;var d=m.insertRow(-1);boxcell=d.insertCell(-1);chtable=document.createElement("table");chtable.cellPadding=0;chtable.cellSpacing=0;chtable.border=0;var h=chtable.insertRow(-1);chcell11=h.insertCell(-1);chcell12=h.insertCell(-1);chcell13=h.insertCell(-1);var g=chtable.insertRow(-1);chcell21=g.insertCell(-1);chcell22=g.insertCell(-1);chcell23=g.insertCell(-1);var c=chtable.insertRow(-1);chcell31=c.insertCell(-1);chcell32=c.insertCell(-1);chcell33=c.insertCell(-1);chcell11.className="top_left";chcell12.className="top_center";chcell13.className="top_right";chcell21.className="center_left";chcell23.className="center_right";chcell31.className="bottom_left";chcell32.className="bottom_center";chcell33.className="bottom_right";boxcell.appendChild(chtable);ToolBarBox.appendChild(m);a.DucklingCreate(chcell22);this.Toolbars[this.Toolbars.length]=a}FCKTools.DisableSelection(this._Document.getElementById("xCollapseHandle").parentNode);if(FCK.Status!=2){FCK.Events.AttachEvent("OnStatusChange",this.RefreshModeState)}else{this.RefreshModeState()}this.IsLoaded=true;this.IsEnabled=true;FCKTools.RunFunction(this.OnLoad)};function hiddenBarForTable(){}function hiddenBarForOrderedList(){};

//v2.6.4 s
var FCKDialog=(function(){var i;var a;var h;var b=window.parent;while(b.parent&&b.parent!=b){try{if(b.parent.document.domain!=document.domain){break}if(b.parent.document.getElementsByTagName("frameset").length>0){break}}catch(g){break}b=b.parent}var d=b.document;var f=function(){if(!a){a=FCKConfig.FloatingPanelsZIndex+999}return ++a};var c=function(){if(!h){return}var e=FCKTools.IsStrictMode(d)?d.documentElement:d.body;FCKDomTools.SetElementStyles(h,{"width":Math.max(e.scrollWidth,e.clientWidth,d.scrollWidth||0)-1+"px","height":Math.max(e.scrollHeight,e.clientHeight,d.scrollHeight||0)-1+"px"})};return{OpenDialog:function(m,e,u,k,w,p,l,j){if(!i){this.DisplayMainCover()}var o={Title:e,Page:u,Editor:window,CustomValue:p,TopWindow:b};FCK.ToolbarSet.CurrentInstance.Selection.Save();var s=FCKTools.GetViewPaneSize(b);var t={"X":0,"Y":0};var v=FCKBrowserInfo.IsIE&&(!FCKBrowserInfo.IsIE7||!FCKTools.IsStrictMode(b.document));if(v){t=FCKTools.GetScrollPosition(b)}var n=Math.max(t.Y+(s.Height-w-20)/2,0);var q=Math.max(t.X+(s.Width-k-20)/2,0);var r=d.createElement("iframe");FCKTools.ResetStyles(r);r.src=FCKConfig.BasePath+"fckdialog.html";r.frameBorder=0;r.allowTransparency=true;FCKDomTools.SetElementStyles(r,{"position":(v)?"absolute":"fixed","top":n+"px","left":q+"px","width":k+"px","height":w+"px","zIndex":f()});r._DialogArguments=o;d.body.appendChild(r);r._ParentDialog=i;i=r},OnDialogClose:function(j){var e=j.frameElement;FCKDomTools.RemoveNode(e);if(e._ParentDialog){i=e._ParentDialog;e._ParentDialog.contentWindow.SetEnabled(true)}else{if(!FCKBrowserInfo.IsIE||FCKBrowserInfo.IsIE11){FCK.Focus()}this.HideMainCover();setTimeout(function(){i=null},0);FCK.ToolbarSet.CurrentInstance.Selection.Release()}},DisplayMainCover:function(){h=d.createElement("div");FCKTools.ResetStyles(h);FCKDomTools.SetElementStyles(h,{"position":"absolute","zIndex":f(),"top":"0px","left":"0px","backgroundColor":FCKConfig.BackgroundBlockerColor});FCKDomTools.SetOpacity(h,FCKConfig.BackgroundBlockerOpacity);if(FCKBrowserInfo.IsIE&&!FCKBrowserInfo.IsIE7){var j=d.createElement("iframe");FCKTools.ResetStyles(j);j.hideFocus=true;j.frameBorder=0;j.src=FCKTools.GetVoidUrl();FCKDomTools.SetElementStyles(j,{"width":"100%","height":"100%","position":"absolute","left":"0px","top":"0px","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});h.appendChild(j)}FCKTools.AddEventListener(b,"resize",c);c();d.body.appendChild(h);FCKFocusManager.Lock();var e=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");e._fck_originalTabIndex=e.tabIndex;e.tabIndex=-1},HideMainCover:function(){FCKDomTools.RemoveNode(h);FCKFocusManager.Unlock();var e=FCK.ToolbarSet.CurrentInstance.GetInstanceObject("frameElement");e.tabIndex=e._fck_originalTabIndex;FCKDomTools.ClearElementJSProperty(e,"_fck_originalTabIndex")},GetCover:function(){return h}}})();
var FCKMenuItem=function(A,B,C,D,E,F){this.Name=B;this.Label=C||B;this.IsDisabled=E;this.Icon=new FCKIcon(D);this.SubMenu=new FCKMenuBlockPanel();this.SubMenu.Parent=A;this.SubMenu.OnClick=FCKTools.CreateEventListener(FCKMenuItem_SubMenu_OnClick,this);this.CustomData=F;if (FCK.IECleanup) FCK.IECleanup.AddItem(this,FCKMenuItem_Cleanup);};FCKMenuItem.prototype.AddItem=function(A,B,C,D,E){this.HasSubMenu=true;return this.SubMenu.AddItem(A,B,C,D,E);};FCKMenuItem.prototype.AddSeparator=function(){this.SubMenu.AddSeparator();};FCKMenuItem.prototype.Create=function(A){var B=this.HasSubMenu;var C=FCKTools.GetElementDocument(A);var r=this.MainElement=A.insertRow(-1);r.className=this.IsDisabled?'MN_Item_Disabled':'MN_Item';if (!this.IsDisabled){FCKTools.AddEventListenerEx(r,'mouseover',FCKMenuItem_OnMouseOver,[this]);FCKTools.AddEventListenerEx(r,'click',FCKMenuItem_OnClick,[this]);if (!B) FCKTools.AddEventListenerEx(r,'mouseout',FCKMenuItem_OnMouseOut,[this]);};var D=r.insertCell(-1);D.className='MN_Icon';D.appendChild(this.Icon.CreateIconElement(C));D=r.insertCell(-1);D.className='MN_Label';D.noWrap=true;D.appendChild(C.createTextNode(this.Label));D=r.insertCell(-1);if (B){D.className='MN_Arrow';var E=D.appendChild(C.createElement('IMG'));E.src=FCK_IMAGES_PATH+'arrow_'+FCKLang.Dir+'.gif';E.width=4;E.height=7;this.SubMenu.Create();this.SubMenu.Panel.OnHide=FCKTools.CreateEventListener(FCKMenuItem_SubMenu_OnHide,this);}};FCKMenuItem.prototype.Activate=function(){this.MainElement.className='MN_Item_Over';if (this.HasSubMenu){this.SubMenu.Show(this.MainElement.offsetWidth+2,-2,this.MainElement);};FCKTools.RunFunction(this.OnActivate,this);};FCKMenuItem.prototype.Deactivate=function(){this.MainElement.className='MN_Item';if (this.HasSubMenu) this.SubMenu.Hide();};function FCKMenuItem_SubMenu_OnClick(A,B){FCKTools.RunFunction(B.OnClick,B,[A]);};function FCKMenuItem_SubMenu_OnHide(A){A.Deactivate();};function FCKMenuItem_OnClick(A,B){if (B.HasSubMenu) B.Activate();else{B.Deactivate();FCKTools.RunFunction(B.OnClick,B,[B]);}};function FCKMenuItem_OnMouseOver(A,B){B.Activate();};function FCKMenuItem_OnMouseOut(A,B){B.Deactivate();};function FCKMenuItem_Cleanup(){this.MainElement=null;};
var FCKMenuBlock=function(){this._Items=[];};FCKMenuBlock.prototype.Count=function(){return this._Items.length;};FCKMenuBlock.prototype.AddItem=function(A,B,C,D,E){var F=new FCKMenuItem(this,A,B,C,D,E);F.OnClick=FCKTools.CreateEventListener(FCKMenuBlock_Item_OnClick,this);F.OnActivate=FCKTools.CreateEventListener(FCKMenuBlock_Item_OnActivate,this);this._Items.push(F);return F;};FCKMenuBlock.prototype.AddSeparator=function(){this._Items.push(new FCKMenuSeparator());};FCKMenuBlock.prototype.RemoveAllItems=function(){this._Items=[];var A=this._ItemsTable;if (A){while (A.rows.length>0) A.deleteRow(0);}};FCKMenuBlock.prototype.Create=function(A){if (!this._ItemsTable){if (FCK.IECleanup) FCK.IECleanup.AddItem(this,FCKMenuBlock_Cleanup);this._Window=FCKTools.GetElementWindow(A);var B=FCKTools.GetElementDocument(A);var C=A.appendChild(B.createElement('table'));C.cellPadding=0;C.cellSpacing=0;FCKTools.DisableSelection(C);var D=C.insertRow(-1).insertCell(-1);D.className='MN_Menu';var E=this._ItemsTable=D.appendChild(B.createElement('table'));E.cellPadding=0;E.cellSpacing=0;};for (var i=0;i<this._Items.length;i++) this._Items[i].Create(this._ItemsTable);};function FCKMenuBlock_Item_OnClick(A,B){if (B.Hide) B.Hide();FCKTools.RunFunction(B.OnClick,B,[A]);};function FCKMenuBlock_Item_OnActivate(A){var B=A._ActiveItem;if (B&&B!=this){if (!FCKBrowserInfo.IsIE&&B.HasSubMenu&&!this.HasSubMenu){A._Window.focus();A.Panel.HasFocus=true;};B.Deactivate();};A._ActiveItem=this;};function FCKMenuBlock_Cleanup(){this._Window=null;this._ItemsTable=null;};var FCKMenuSeparator=function(){};FCKMenuSeparator.prototype.Create=function(A){var B=FCKTools.GetElementDocument(A);var r=A.insertRow(-1);var C=r.insertCell(-1);C.className='MN_Separator MN_Icon';C=r.insertCell(-1);C.className='MN_Separator';C.appendChild(B.createElement('DIV')).className='MN_Separator_Line';C=r.insertCell(-1);C.className='MN_Separator';C.appendChild(B.createElement('DIV')).className='MN_Separator_Line';};
var FCKMenuBlockPanel=function(){FCKMenuBlock.call(this);};FCKMenuBlockPanel.prototype=new FCKMenuBlock();FCKMenuBlockPanel.prototype.Create=function(){var A=this.Panel=(this.Parent&&this.Parent.Panel?this.Parent.Panel.CreateChildPanel():new FCKPanel());A.AppendStyleSheet(FCKConfig.SkinEditorCSS);FCKMenuBlock.prototype.Create.call(this,A.MainNode);};FCKMenuBlockPanel.prototype.Show=function(x,y,A){if (!this.Panel.CheckIsOpened()) this.Panel.Show(x,y,A);};FCKMenuBlockPanel.prototype.Hide=function(){if (this.Panel.CheckIsOpened()) this.Panel.Hide();};
//v 2.6.4 e

var FCKContextMenu=function(d,c){this.CtrlDisable=false;var b=this._Panel=new FCKPanel(d);b.AppendStyleSheet(FCKConfig.SkinEditorCSS);b.IsContextMenu=true;if(FCKBrowserInfo.IsGecko){b.Document.addEventListener("draggesture",function(f){f.preventDefault();return false},true)}var a=this._MenuBlock=new FCKMenuBlock();a.Panel=b;a.OnClick=FCKTools.CreateEventListener(FCKContextMenu_MenuBlock_OnClick,this);this._Redraw=true};FCKContextMenu.prototype.SetMouseClickWindow=function(a){if(FCKBrowserInfo.IsGeckoLike){this._Document=a.document;if(FCKBrowserInfo.IsOpera&&!("oncontextmenu" in document.createElement("foo"))){this._Document.addEventListener("mousedown",FCKContextMenu_Document_OnMouseDown,false);this._Document.addEventListener("mouseup",FCKContextMenu_Document_OnMouseUp,false)}this._Document.addEventListener("contextmenu",FCKContextMenu_Document_OnContextMenu,false)}};FCKContextMenu.prototype.AddItem=function(c,b,e,a,f){var d=this._MenuBlock.AddItem(c,b,e,a,f);this._Redraw=true;return d};FCKContextMenu.prototype.AddSeparator=function(){this._MenuBlock.AddSeparator();this._Redraw=true};FCKContextMenu.prototype.RemoveAllItems=function(){this._MenuBlock.RemoveAllItems();this._Redraw=true};FCKContextMenu.prototype.AttachToElement=function(a){if(FCKBrowserInfo.IsIE){FCKTools.AddEventListenerEx(a,"contextmenu",FCKContextMenu_AttachedElement_OnContextMenu,this)}else{a._FCKContextMenu=this}};function FCKContextMenu_Document_OnContextMenu(b){var a=b.target;while(a){if(a._FCKContextMenu){if(a._FCKContextMenu.CtrlDisable&&(b.ctrlKey||b.metaKey)){return true}FCKTools.CancelEvent(b);FCKContextMenu_AttachedElement_OnContextMenu(b,a._FCKContextMenu,a);return false}a=a.parentNode}return true}var FCKContextMenu_OverrideButton;function FCKContextMenu_Document_OnMouseDown(f){if(!f||f.button!=2){return false}var c=f.target;while(c){if(c._FCKContextMenu){if(c._FCKContextMenu.CtrlDisable&&(f.ctrlKey||f.metaKey)){return true}var b=FCKContextMenu_OverrideButton;if(!b){var d=FCKTools.GetElementDocument(f.target);b=FCKContextMenu_OverrideButton=d.createElement("input");b.type="button";var a=d.createElement("p");d.body.appendChild(a);a.appendChild(b)}b.style.cssText="position:absolute;top:"+(f.clientY-2)+"px;left:"+(f.clientX-2)+"px;width:5px;height:5px;opacity:0.01"}c=c.parentNode}return false}function FCKContextMenu_Document_OnMouseUp(c){var a=FCKContextMenu_OverrideButton;if(a){var b=a.parentNode;b.parentNode.removeChild(b);FCKContextMenu_OverrideButton=undefined;if(c&&c.button==2){FCKContextMenu_Document_OnContextMenu(c);return false}}return true}function FCKContextMenu_AttachedElement_OnContextMenu(d,a,c){if(a.CtrlDisable&&(d.ctrlKey||d.metaKey)){return true}var b=c||this;if(a.OnBeforeOpen){a.OnBeforeOpen.call(a,b)}if(a._MenuBlock.Count()==0){return false}if(a._Redraw){a._MenuBlock.Create(a._Panel.MainNode);a._Redraw=false}FCKTools.DisableSelection(a._Panel.Document.body);var e=FCKContextMenu_EventPos(d);a._Panel.Show(e.x,e.y,d.currentTarget||null);return false}function FCKContextMenu_EventPos(a){if(FCKBrowserInfo.IsSafari&&!FCKBrowserInfo.IsChrome){return{x:a.clientX,y:a.clientY}}if(FCKBrowserInfo.IsGeckoLike){return{x:a.pageX,y:a.pageY}}if(FCKBrowserInfo.IsIE){return{x:a.screenX,y:a.screenY}}return{x:a.pageX,y:a.pageY}}function FCKContextMenu_MenuBlock_OnClick(b,a){a._Panel.Hide();FCKTools.RunFunction(a.OnItemClick,a,b)};
FCK.ContextMenu={};FCK.ContextMenu.Listeners=[];FCK.ContextMenu.RegisterListener=function(a){if(a){this.Listeners.push(a)}};function FCK_ContextMenu_Init(){var b=FCK.ContextMenu._InnerContextMenu=new FCKContextMenu(FCKBrowserInfo.IsIE?window:window.parent,FCKLang.Dir);b.CtrlDisable=FCKConfig.BrowserContextMenuOnCtrl;b.OnBeforeOpen=FCK_ContextMenu_OnBeforeOpen;b.OnItemClick=FCK_ContextMenu_OnItemClick;var a=FCK.ContextMenu;for(var c=0;c<FCKConfig.ContextMenu.length;c++){a.RegisterListener(FCK_ContextMenu_GetListener(FCKConfig.ContextMenu[c]))}}function FCK_ContextMenu_GetListener(a){try{return E2ContextMenu(a)}catch(b){}switch(a){case"Generic":return{AddItems:function(e,c,d){e.AddItem("Cut",FCKLang.Cut,7,FCKCommands.GetCommand("Cut").GetState()==FCK_TRISTATE_DISABLED);e.AddItem("Copy",FCKLang.Copy,8,FCKCommands.GetCommand("Copy").GetState()==FCK_TRISTATE_DISABLED);e.AddItem("Paste",FCKLang.Paste,9,FCKCommands.GetCommand("Paste").GetState()==FCK_TRISTATE_DISABLED)}};case"Table":return{AddItems:function(h,c,f){var e=(f=="TABLE");var d=(!e&&FCKSelection.HasAncestorNode("TABLE"));if(d){h.AddSeparator();var g=h.AddItem("Cell",FCKLang.CellCM);if(FCKBrowserInfo.IsGecko){g.AddItem("TableMergeCells",FCKLang.MergeCells,60,FCKCommands.GetCommand("TableMergeCells").GetState()==FCK_TRISTATE_DISABLED)}else{g.AddItem("TableMergeRight",FCKLang.MergeRight,60,FCKCommands.GetCommand("TableMergeRight").GetState()==FCK_TRISTATE_DISABLED);g.AddItem("TableMergeDown",FCKLang.MergeDown,60,FCKCommands.GetCommand("TableMergeDown").GetState()==FCK_TRISTATE_DISABLED)}g.AddItem("TableHorizontalSplitCell",FCKLang.HorizontalSplitCell,61,FCKCommands.GetCommand("TableHorizontalSplitCell").GetState()==FCK_TRISTATE_DISABLED);g.AddItem("TableVerticalSplitCell",FCKLang.VerticalSplitCell,61,FCKCommands.GetCommand("TableVerticalSplitCell").GetState()==FCK_TRISTATE_DISABLED);g.AddSeparator();g.AddItem("TableCellProp",FCKLang.CellProperties,57,FCKCommands.GetCommand("TableCellProp").GetState()==FCK_TRISTATE_DISABLED);h.AddSeparator();g=h.AddItem("Row",FCKLang.RowCM);g.AddItem("TableInsertRowBefore",FCKLang.InsertRowBefore,70);g.AddItem("TableInsertRowAfter",FCKLang.InsertRowAfter,62);g.AddItem("TableDeleteRows",FCKLang.DeleteRows,63);h.AddSeparator();g=h.AddItem("Column",FCKLang.ColumnCM);g.AddItem("TableInsertColumnBefore",FCKLang.InsertColumnBefore,64);g.AddItem("TableInsertColumnAfter",FCKLang.InsertColumnAfter,64);g.AddItem("TableDeleteColumns",FCKLang.DeleteColumns,65)}if(e||d){h.AddSeparator();h.AddItem("TableDelete",FCKLang.TableDelete);h.AddItem("TableProp",FCKLang.TableProperties,39)}}};case"Link":return{AddItems:function(h,c,e){var f=(e=="A"||FCKSelection.HasAncestorNode("A"));if(f||FCK.GetNamedCommandState("Unlink")!=FCK_TRISTATE_DISABLED){var g=FCKSelection.MoveToAncestorNode("A");var d=(g&&g.name.length>0&&g.href.length==0);if(d){return}h.AddSeparator();if(f){h.AddItem("Link",FCKLang.EditLink,34)}h.AddItem("Unlink",FCKLang.RemoveLink,35)}}};case"DMLPlugin":return{AddItems:function(f,c,d){if(d=="IMG"&&(c.className).toUpperCase()=="PLUGIN"){var e=c.title;if(e.indexOf("DEMapPlugin")!=-1){f.AddSeparator();f.AddItem("DEMap",FCKLang.DEMap,74)}else{if(e.indexOf("ImageScrollPlugin")!=-1){f.AddSeparator();f.AddItem("ImageScroll",FCKLang.ImageScroll,73)}else{if(e.indexOf("DmlResultsetPlugin")!=-1||e.indexOf("DmlFieldPlugin")!=-1){}else{f.AddSeparator();f.AddItem("DMLPlugin",FCKLang.DMLPluginMsg,52)}}}}}};case"Image":return{AddItems:function(e,c,d){if(d=="IMG"&&!c.getAttribute("_fckfakelement")){e.AddSeparator();e.AddItem("Image",FCKLang.ImageProperties,37)}}};case"Anchor":return{AddItems:function(g,c,e){var f=FCKSelection.MoveToAncestorNode("A");var d=(f&&f.name.length>0);if(d||(e=="IMG"&&c.getAttribute("_fckanchor"))){g.AddSeparator();g.AddItem("Anchor",FCKLang.AnchorProp,36);g.AddItem("AnchorDelete",FCKLang.AnchorDelete)}}};case"Flash":return{AddItems:function(e,c,d){if(d=="IMG"&&c.getAttribute("_fckflash")){e.AddSeparator();e.AddItem("Flash",FCKLang.FlashProperties,38)}}};case"Form":return{AddItems:function(e,c,d){if(FCKSelection.HasAncestorNode("FORM")){e.AddSeparator();e.AddItem("Form",FCKLang.FormProp,48)}}};case"Checkbox":return{AddItems:function(e,c,d){if(d=="INPUT"&&c.type=="checkbox"){e.AddSeparator();e.AddItem("Checkbox",FCKLang.CheckboxProp,49)}}};case"Radio":return{AddItems:function(e,c,d){if(d=="INPUT"&&c.type=="radio"){e.AddSeparator();e.AddItem("Radio",FCKLang.RadioButtonProp,50)}}};case"TextField":return{AddItems:function(e,c,d){if(d=="INPUT"&&(c.type=="text"||c.type=="password")){e.AddSeparator();e.AddItem("TextField",FCKLang.TextFieldProp,51)}}};case"HiddenField":return{AddItems:function(e,c,d){if(d=="IMG"&&c.getAttribute("_fckinputhidden")){e.AddSeparator();e.AddItem("HiddenField",FCKLang.HiddenFieldProp,56)}}};case"ImageButton":return{AddItems:function(e,c,d){if(d=="INPUT"&&c.type=="image"){e.AddSeparator();e.AddItem("ImageButton",FCKLang.ImageButtonProp,55)}}};case"Button":return{AddItems:function(e,c,d){if(d=="INPUT"&&(c.type=="button"||c.type=="submit"||c.type=="reset")){e.AddSeparator();e.AddItem("DMLButton",FCKLang.ButtonProp,54)}}};case"Select":return{AddItems:function(e,c,d){if(d=="SELECT"){e.AddSeparator();e.AddItem("DMLSelect",FCKLang.SelectionFieldProp,53)}}};case"Textarea":return{AddItems:function(e,c,d){if(d=="TEXTAREA"){e.AddSeparator();e.AddItem("Textarea",FCKLang.TextareaProp,52)}}};case"BulletedList":return{AddItems:function(e,c,d){if(FCKSelection.HasAncestorNode("UL")){e.AddSeparator();e.AddItem("BulletedList",FCKLang.BulletedListProp,27)}}};case"UpdateAttach":return{AddItems:function(h,d,f){var c=(f=="A"||FCKSelection.HasAncestorNode("A"));if(c){var g=FCKSelection.MoveToAncestorNode("A");if(g.getAttribute("href",2)){var e=g.getAttribute("href",2);if(e.indexOf("attach/")!=-1){h.AddSeparator();h.AddItem("UpdateAttach",FCKLang.UpdateAttach,59)}}}}};case"NumberedList":return{AddItems:function(e,c,d){if(FCKSelection.HasAncestorNode("OL")){e.AddSeparator();e.AddItem("NumberedList",FCKLang.NumberedListProp,26)}}}}return null}function FCK_ContextMenu_OnBeforeOpen(){FCK.Events.FireEvent("OnSelectionChange");var d,b=null;if((d=FCKSelection.GetSelectedElement())){b=d.tagName}var a=FCK.ContextMenu._InnerContextMenu;a.RemoveAllItems();var e=FCK.ContextMenu.Listeners;for(var c=0;c<e.length;c++){e[c].AddItems(a,d,b)}}function FCK_ContextMenu_OnItemClick(a){FCK.Focus();FCKCommands.GetCommand(a.Name).Execute(a.CustomData)};

var FCKHtmlIterator=function(A){this._sourceHtml=A;};FCKHtmlIterator.prototype={Next:function(){var A=this._sourceHtml;if (A==null) return null;var B=FCKRegexLib.HtmlTag.exec(A);var C=false;var D="";if (B){if (B.index>0){D=A.substr(0,B.index);this._sourceHtml=A.substr(B.index);}else{C=true;D=B[0];this._sourceHtml=A.substr(B[0].length);}}else{D=A;this._sourceHtml=null;};return { 'isTag':C,'value':D };},Each:function(A){var B;while ((B=this.Next())) A(B.isTag,B.value);}};var FCKHtmlIterator=function(A){this._sourceHtml=A;};FCKHtmlIterator.prototype={Next:function(){var A=this._sourceHtml;if (A==null) return null;var B=FCKRegexLib.HtmlTag.exec(A);var C=false;var D="";if (B){if (B.index>0){D=A.substr(0,B.index);this._sourceHtml=A.substr(B.index);}else{C=true;D=B[0];this._sourceHtml=A.substr(B[0].length);}}else{D=A;this._sourceHtml=null;};return { 'isTag':C,'value':D };},Each:function(A){var B;while ((B=this.Next())) A(B.isTag,B.value);}};
var FCKPlugin=function(A,B,C){this.Name=A;this.BasePath=C?C:FCKConfig.PluginsPath;this.Path=this.BasePath+A+'/';if (!B||B.length==0) this.AvailableLangs=[];else this.AvailableLangs=B.split(',');};FCKPlugin.prototype.Load=function(){if (this.AvailableLangs.length>0){var A;if (this.AvailableLangs.IndexOf(FCKLanguageManager.ActiveLanguage.Code)>=0) A=FCKLanguageManager.ActiveLanguage.Code;else A=this.AvailableLangs[0];LoadScript(this.Path+'lang/'+A+'.js');};LoadScript(this.Path+'fckplugin.js');};
var FCKPlugins=FCK.Plugins={};FCKPlugins.ItemsCount=0;FCKPlugins.Items={};FCKPlugins.Load=function(){var A=FCKPlugins.Items;for (var i=0;i<FCKConfig.Plugins.Items.length;i++){var B=FCKConfig.Plugins.Items[i];var C=A[B[0]]=new FCKPlugin(B[0],B[1],B[2]);FCKPlugins.ItemsCount++;};for (var s in A) A[s].Load();FCKPlugins.Load=null;};
